#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"
#include "inc/music.h"
#include "inc/efx.h"

//----------------------------------------------------------------------------//
//                                                                            //
// 	    			                                              //
//                                                                            //
//----------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
// 初期化スクリプト
///////////////////////////////////////////////////////////////////////////////
//-------------------------------------------

function "init"
{
	
	CallFunc("rng:setOctoBossLevels")
	// イベント制御
	EventAreaEnable( "SubEV_S_Boss_Battle00", 0 )		// 小ボス①登場
	EventAreaEnable( "SubEV_S_Boss_Battle01", 0 )		// 小ボス②登場
	EventAreaEnable( "SubEV_S_Boss_Battle02", 0 )		// 小ボス③登場

	if (FLAG[SF_EVENT_ON])
	{
	
		if( FLAG[SF_BOSS_BATTLE] &&
			!FLAG[GF_MP630x_SMALLBOSS_00] )
		{
			//リトライからのイベント戦闘
			//SetWork( WK_BGM , BGM_Nothing )
			EventCue("mp6302:Retry_S_Boss00")
		}
		else if( !FLAG[GF_MP630x_SMALLBOSS_00] )
		{
			EventAreaEnable( "SubEV_S_Boss_Battle00", 1 )	// 小ボス①登場
		}
	
		if( FLAG[SF_BOSS_BATTLE] &&
			FLAG[GF_MP630x_SMALLBOSS_00] &&
			!FLAG[GF_MP630x_SMALLBOSS_01] )
		{
			//リトライからのイベント戦闘
			//SetWork( WK_BGM , BGM_Nothing )
			EventCue("mp6302:Retry_S_Boss01")
		}
		else if( !FLAG[GF_MP630x_SMALLBOSS_01] )
		{
			EventAreaEnable( "SubEV_S_Boss_Battle01", 1 )	// 小ボス②登場
		}
	
		if( FLAG[SF_BOSS_BATTLE] &&
			FLAG[GF_MP630x_SMALLBOSS_01] &&
			!FLAG[GF_MP630x_SMALLBOSS_02] )
		{
			//リトライからのイベント戦闘
			//SetWork( WK_BGM , BGM_Nothing )
			EventCue("mp6302:Retry_S_Boss02")
		}
		else if( !FLAG[GF_MP630x_SMALLBOSS_02] )
		{
			EventAreaEnable( "SubEV_S_Boss_Battle02", 1 )	// 小ボス③登場
		}
	}
}

function "LP_warpin_mp6305"
{
	CallFunc("system:event_begin")

	SetChrInfoFlag("PLAYER1", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("PLAYER2", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("PLAYER3", INFOFLAG_NOCHRATARI)

	SetChrPos("PLAYER1",155.97f,35.01f,-43.50f)
	Turn("PLAYER1",-58.24f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()

	//カメラ始点
	MoveCameraAt( 0 , 154.091f , 36.021f , -42.523f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 14.773f , 0 )	// 基本仰角
	RotateCamera( 0 , 240.440f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	//カメラ終点
	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , 154.091f , 36.021f , -41.928f, 125 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.600f , 125 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , -6.657f , 125 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 240.441f ,  125)		// 角度

	//MoveCameraAt( 0 , 154.091f , 36.021f , -41.928f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 5.600f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , -6.657f , 0 )	// 基本仰角
	//RotateCamera( 0 , 240.441f , 0 )				// 角度
	//ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転

	FadeIn(FADE_BLACK, FADE_FAST)

	Wait(25)

	ChrEffect2( "PLAYER1" , 3901100 , "root", "", 0 , IMPACT_NONE , KNOCK_EFXPOS , 0.0f,0.0f,0, 1.7f, 1.0f)
	PlaySE(SE_GIM_WARP_2,100,0,0,0,1.0f,0)	//gimse

	Wait(40)

	Blur(BLUR_TYPE_EXPAND,0.3f,20)
	SetChrInfoFlag( "PLAYER1" , INFOFLAG_INVISIBLE )
	SetChrInfoFlag( "PLAYER2" , INFOFLAG_INVISIBLE )
	SetChrInfoFlag( "PLAYER3" , INFOFLAG_INVISIBLE )

	Wait(45)

	FadeOut(FADE_BLACK, FADE_FAST)
	Wait(FADE_NORMAL)

	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	ResetChrInfoFlag("PLAYER1", INFOFLAG_NOCHRATARI)
	ResetChrInfoFlag("PLAYER2", INFOFLAG_NOCHRATARI)
	ResetChrInfoFlag("PLAYER3", INFOFLAG_NOCHRATARI)

	SetFlag( TF_LOADING_TIPS_OFF, 1 )	//NowLoading 時の Tips 表示をカット

	LoadArg("map/mp6305/mp6305.arg")
	if ( FLAG[GF_06MP6305_IN_OCEAN]){
		EventCue("mp6305:Entry_warpout_mp6302")
	}

	ResetStopFlag(STOPFLAG_EVENT)

}


function "Entry_warpout_mp6305"
{
	CallFunc("system:event_begin")

	SetChrInfoFlag("PLAYER1", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("PLAYER2", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("PLAYER3", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag( "PLAYER1" , INFOFLAG_INVISIBLE )
	SetChrInfoFlag( "PLAYER2" , INFOFLAG_INVISIBLE )
	SetChrInfoFlag( "PLAYER3" , INFOFLAG_INVISIBLE )

	SetChrPos("PLAYER1",155.93f,35.04f,-43.50f)
	Turn("PLAYER1",122.04f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()

	//カメラ設定
	MoveCameraAt( 0 , 155.930f , 35.040f , -44.257f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 6.360f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 42.860f , 0 )	// 基本仰角
	RotateCamera( 0 , 108.561f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	//マップ名表示
	VisualName("visual/mapname/mn_6301.itp",VN_NAMEMAP2,-1,-1,VN_MAPNAME_TIME)//見届け(オクトゥス)の丘
	SetFlag( TF_MAPNAME_SHOWN, 1 )				// 地名表示した（テンポラリ）

	FadeIn(FADE_BLACK, FADE_FAST)
	Wait(FADE_NORMAL)

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , 155.930f , 35.039f , -41.527f , 100 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.000f , 100 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 15.387f , 100 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 108.561f , 100 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , 0.0f , 100)		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE , 60.000f , 100 )		// 視野角

	//MoveCameraAt( 0 , 155.930f , 35.039f , -41.527f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 15.387f , 0 )	// 基本仰角
	//RotateCamera( 0 , 108.561f , 0 )				// 角度
	//ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転

	ChrEffect2( "PLAYER1" , 3901100 , "root", "", 0 , IMPACT_NONE , KNOCK_EFXPOS , 0.0f,0.0f,0, 1.5f, 1.0f)
	PlaySE(SE_GIM_WARP_2,100,0,0,0,1.0f,0)	//gimse
	Wait(40)

//	ExecuteCmd( 1, MoveTo, "PLAYER1" ,152.02f,37.19f,-43.59f , 0.1f , 0.22f )
//
//	Wait(8)
//	ExecuteCmd( 2, MoveTo, "PLAYER2" ,152.02f,37.19f,-43.59f , 2.5f , 0.22f )
//	ExecuteCmd( 3, MoveTo, "PLAYER3" ,152.02f,37.19f,-43.59f , 2.5f , 0.22f )
//	Wait(5)

	ResetChrInfoFlag( "PLAYER1" , INFOFLAG_INVISIBLE )
	ResetChrInfoFlag( "PLAYER2" , INFOFLAG_INVISIBLE )
	ResetChrInfoFlag( "PLAYER3" , INFOFLAG_INVISIBLE )

	WaitThread(1)
	WaitThread(2)
	WaitThread(3)

	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	WaitThread(1006)

	FixCamera()

	ResetChrInfoFlag("PLAYER1", INFOFLAG_NOCHRATARI)
	ResetChrInfoFlag("PLAYER2", INFOFLAG_NOCHRATARI)
	ResetChrInfoFlag("PLAYER3", INFOFLAG_NOCHRATARI)

	ResetFollowPoint()
	ResetStopFlag(STOPFLAG_EVENT)
}


//──────────────────────────────
//▼オクトゥス中央の間に戻る(mp6301)
//──────────────────────────────
function "EV_M06S150"			//オクトゥス中央の間に戻る(mp6301)
{
	//開始処理ここから-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL", 151.31f, 38.32f, -43.75f)
	Turn("ADOL", 123.95f, 360.0f)
	ChangeAnimation("ADOL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("ADOL")
	SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",151.99f, 38.85f, -43.75f)
	Turn("RICOTTA", 120.23f, 360.0f)
	ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("RICOTTA")
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD", 152.95f, 38.87f, -43.61f)
	Turn("SAHAD", 120.40f, 360.0f)
	ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("SAHAD")
	SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA", 150.61f, 36.43f, -43.75f)
	Turn("LAXIA", 120.40f, 360.0f)
	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("LAXIA")
	SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL", 151.87f, 36.70f, -43.55f)
	Turn("HUMMEL", 120.40f, 360.0f)
	ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("HUMMEL")
	SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA", 150.98f, 37.45f, -43.75f)
	Turn("DANA", 121.54f, 360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)


	//カメラ設定
	MoveCameraAt(0, 0.773f, -142.587f, -2.037f, 0)	// 注視点
	ChangeCameraDistance(0, 9.000f, 0)		// 基本距離
	ChangeCameraElevation(0, 12.000f, 0)	// 基本仰角
	RotateCamera(0, 8.433f, 0)				// 角度
	ChangeCameraPers(0, 60.000f, 0)			// 視野角
	SetCameraZPlane(0.100f, 1000.000f)			// ZPlane
	RollCamera(0, 0.0f, 0)				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。


	//カメラ設定
	MoveCameraAt( 0 , 155.571f , 40.567f , -38.058f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 10.373f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 21.593f , 0 )	// 基本仰角
	RotateCamera( 0 , 192.766f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	MapAnime("mark_s1" , "on" )
	MapAnime("mark_s2" , "on" )
	MapAnime("mark_s3" , "on" )
	MapAnime("mark_m1" , "off" )

	MapAnime("stop_m1" , "on" )
	MapAnime("stop2_m1" , "on" )


	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 200.000, 2.000, 0.850, 0.500)					//イベント毎に調整
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6302:EV_M06S150_ED")

	//開始処理ここまで-----------------------------------------------

	//　　床に紋様が展開されている
	//　　中央フロアに戻るとイベント開始。
	//　　床の紋様が変化＆《氷の回廊》入口が解除されて、
	//　　先へ進めるようになったことが分かる演出。
	//　　フェードインしてパーティー展開している状態。
	
	// カット1 ----------------------------------------------------------------------------------------

	// 非表示・再表示
	SetChrInfoFlag("ADOL", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("DANA", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("LAXIA", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("SAHAD", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("RICOTTA", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("HUMMEL", INFOFLAG_INVISIBLE)	// 非表示

	// フェードイン
	FadeIn(FADE_BLACK, FADE_NORMAL)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 152.088f , 35.030f , -41.530f , 120 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 10.373f , 120 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 8.388f , 120 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 284.753f , 120 )

	WaitFade()
	
	// オベリスク消灯
	MapAnime("emblem_m1" , "close" )
	Wait(15)	//SE
	PlaySE(SE_GIM_SCFI_1,100,0,0,0,1.0f,0)		//gimse エンブレム消灯

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	// カット2 ------------------------------------------------------------------------------------------
	
	// クロスフェード
	CrossFade(FADE_NORMAL)
	
	// カメラ
	MoveCameraAt( 0 , 88.999f , 75.807f , -51.164f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 11.399f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 21.737f , 0 )	// 基本仰角
	RotateCamera( 0 , 80.656f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 88.999f , 75.807f , -51.164f , 100 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 11.399f , 100 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 21.737f, 100 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 60.261f, 100 )

	Wait(FADE_NORMAL)

	// ストッパー解除
	MapAnime("stop_m1" , "open" )
	MapAnime("stop2_m1" , "open" )
	PlaySE(SE_GIM_SCFI_2,100,0,0,0,1.0f,0)		//gimse ストッパー消える
	PlaySE(SE_GIM_SCFI_4,100,0,0,0,1.0f,0)		//gimse 移動床
	Wait(15)	//SE
	Wait(25)	//SE
	PlaySE(SE_GIM_SCFI_4A,80,0,0,0,1.0f,0)		//gimse どすん
	Wait(10)	//SE
	PlaySE(SE_GIM_SCFI_4A,80,0,0,0,1.0f,0)		//gimse どすん

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	Wait(10)

	// カット3 --------------------------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_NORMAL)

	// カメラ
	MoveCameraAt( 0 , 4.552f , -147.730f , 0.210f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.801f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -5.917f , 0 )	// 基本仰角
	RotateCamera( 0 , 26.262f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 4.552f , -147.730f , -2.519f , 65 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.801f , 65 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 22.870f , 65 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 29.899f , 65 )

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	
	// クロスフェード
	CrossFade(FADE_NORMAL)
	// セフィロトON
	MapAnime("mark_m1" , "on" )
	PlaySE(SE_GIM_SCFI_3,100,0,0,0,1.0f,0)		//gimse 床マーク
	Wait(FADE_NORMAL)
	
	Wait(10)
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -0.053f , -157.693f , 7.899f , 125 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 29.001f , 125 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 88.727f , 125 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 0.852f , 125 )

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	
	Wait(20)
	

	// カット4 ------------------------------------------------------------------------------------------
	
	// クロスフェード
	CrossFade(FADE_FAST)
	
	// カメラ
//	MoveCameraAt( 0 , 152.408f , 37.336f , -41.646f , 0 )	// 注視点
//	ChangeCameraDistance( 0 , 5.473f , 0 )		// 基本距離
//	ChangeCameraElevation( 0 , -4.061f , 0 )	// 基本仰角
//	RotateCamera( 0 , 256.441f , 0 )				// 角度
//	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
//	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ロール回転
//	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	MoveCameraAt( 0 , 152.408f , 37.336f , -42.026f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.473f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -4.061f , 0 )	// 基本仰角
	RotateCamera( 0 , 256.441f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 非表示・再表示
	ResetChrInfoFlag("ADOL", INFOFLAG_INVISIBLE)	// 再表示
	ResetChrInfoFlag("DANA", INFOFLAG_INVISIBLE)	// 再表示
	ResetChrInfoFlag("LAXIA", INFOFLAG_INVISIBLE)	// 再表示
	ResetChrInfoFlag("SAHAD", INFOFLAG_INVISIBLE)	// 再表示
	ResetChrInfoFlag("RICOTTA", INFOFLAG_INVISIBLE)	// 再表示
	ResetChrInfoFlag("HUMMEL", INFOFLAG_INVISIBLE)	// 再表示

//	// カメラ移動
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 152.408f , 37.336f , -42.026f, 50 )
//
//	// カメラ待ち
//	WaitThread(1000)

	Wait(FADE_FAST)
	
	ChangeAnimation( "LAXIA", "ANI_EV_TEMUNE_S", -1, 1 )
	
	// ラクシャ
	TalkPopup("LAXIA", 0, 2, 0, 0, 0) {
		"#000e#000mこれは……"
	}
	WaitPrompt()
	WaitCloseWindow()

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#000e#000m《海の回廊》を突破したことで"
		"次へ進めるようになったみたいだね。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	LookChr("DANA", "ADOL")
	
	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#000e#000mアドルさん、"
		"この調子で次の回廊へ進もう。"
	}
	WaitPrompt()
	WaitCloseWindow()

//	// カメラ移動
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 152.408f , 37.336f , -41.226f , 150 )
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 7.173f , 150 )
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -4.061f , 150 )
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 220.995f , 150 )
//
	//　　アドル、頷いて操作許可。
	HeadYes("ADOL" , 1 , 25 )
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_E, 1)
	Wait(30)

	// フェードアウト
	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6302:EV_M06S150_ED")
}

function "EV_M06S150_ED"
{
	SetStopFlag(STOPFLAG_EVENTIMPOSE)
	FadeOut(FADE_BLACK,0)
	WaitFade()
	
	//終了処理はスキップ禁止
	SetSkipScript("")

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	//ReleaseEventPartyChr()

	MapAnime("stop_m1" , "off" )
	MapAnime("stop2_m1" , "off" )
	MapAnime("emblem_m1" , "off" )
	MapAnime("mark_m1" , "on" )

	//マップパラメーターリセット
	ResetMapParam(-1)

	//フラグ処理
	SetFlag(GF_06MP6301_RETURN_CENTER, 1)
	CallFunc("mp6302:init")

	CallFunc("mp6302:EV_M06S150_ED2")

//	SetFlag(TF_LOADING_TIPS_OFF, 1)
//	LoadArg("map/mp6302/mp6302.arg")
//	EventCue("mp6302:EV_M06S150_ED2")
}


function "EV_M06S150_ED2"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	//ResetMapParam(-1)

	//イベント後の再配置
	SetChrPos("LEADER", 152.21f, 37.24f, -43.54f)
	Turn("LEADER", 120.06f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , 152.212f , 37.243f , -41.576f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 8.408f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 12.000f , 0 )	// 基本仰角
	RotateCamera( 0 , 59.942f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	//RestoreCamera(0, 0)		//※上記カメラ位置を指定する場合は不要
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK, FADE_FAST)
	//WaitFade()

	//終了処理ここまで----------------------------------------------------
}

//-------------------------------------------
//小ボス①登場
//-------------------------------------------
function "SubEV_S_Boss_Battle00"
{

//開始処理ここから----------------------------------------------------

	CallFunc("system:event_begin")

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrPos("PLAYER1",69.43f,-124.48f,-16.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	ChangeAnimation( "PLAYER1" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER1",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER1" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER1" )

	SetChrPos("PLAYER2",67.53f,-124.86f,-16.00f)
	Turn("PLAYER2",-60.09f,360.0f)
	ChangeAnimation( "PLAYER2" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER2",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER2" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER2" )

	SetChrPos("PLAYER3",68.45f,-122.44f,-16.00f)
	Turn("PLAYER3",-60.60f,360.0f)
	ChangeAnimation( "PLAYER3" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER3",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER3" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER3" )

	// ボスの位置セット
	SetChrPos("mons01",84.0f,-133.0f,-16.0f)
	Turn("mons01",120f,360.0f)
	ChrAlpha("mons01", 0.0f, 0)	// ID, 変化後のアルファ値, 変化にかかるフレーム数

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt( 0 , 71.618f , -129.998f , -6.888f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 32.566f , 0 )	// 基本仰角
	RotateCamera( 0 , 257.713f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 170.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6302:SubEV_S_Boss_Battle00_ED")

//開始処理ここまで-----------------------------------------------

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 76.663f , -124.726f , -8.128f , 200 )	// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.000f , 200 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 32.566f , 200 )	// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 218.853f , 200 )				// 角度

	//StopBGM(120)

	// フェードイン
	FadeIn(FADE_BLACK, FADE_FAST)
	WaitFade()

	//登場の演出としては、エフェクトを出しながら、モンスターをフェードで出現させればＯＫです。
	//エフェクト番号	105530
	//60フレーム後に光るので、そのあたりでフェード開始するといいかもしれません。
	Effect( 105530, 84.0f,-133.0f,-16.0f, 0 , 0 , IMPACT_NONE , KNOCK_EFXPOS , 0 , 2.0f, 1.0f)		//
	PlaySE(SE_S_BOSS_01, 80, 0, 1000, 0, 1.0f, 0)
	Wait(60)
	ChrAlpha("mons01", 1.0f, 90)	// ID, 変化後のアルファ値, 変化にかかるフレーム数
	PlaySE(SE_S_BOSS_02, 100, 0, 0, 0, 1.0f, 0)
	Wait(60)
	//PlayBGM(BGM_BOSS_001, 0)
	Wait(60)
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

//	CrossFade(FADE_CROSS)
//	MoveCameraAt( 0 , 72.512f , -126.401f , -14.496f , 0 )	// 注視点
//	ChangeCameraDistance( 0 , 8.900f , 0 )		// 基本距離
//	ChangeCameraElevation( 0 , 11.012f , 0 )	// 基本仰角
//	RotateCamera( 0 , 244.471f , 0 )				// 角度
//	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
//	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ロール回転
//
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 72.512f , -126.401f , -15.339f , 60 )	// 注視点
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 8.900f , 60 )		// 基本距離
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 11.012f , 60 )	// 基本仰角
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 244.471f , 60 )				// 角度
//	Wait(FADE_CROSS)
//
//	// 武器構え
//	ChangeAnimation("PLAYER1", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER2", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER3", "ANI_EV_SETARM", -1, 1)	// 武器構え
//
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

//終了処理ここから----------------------------------------------------
	CallFunc("mp6302:SubEV_S_Boss_Battle00_ED")
}
function "SubEV_S_Boss_Battle00_ED"
{

	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//キャラクター初期化
	CallFunc("system:reset_chrmot_ALL")

	// イベント用小ボスを画面外に移動
	SetChrPos("mons01" ,-100000.00f,0.00f,0.00f)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	EventCue("mp6302:Retry_S_Boss00")

	ResetStopFlag(STOPFLAG_EVENT)

//終了処理ここまで----------------------------------------------------
}
function "Retry_S_Boss00"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//ボス配置・アニメ--------------------------------
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))

	SetChrPos("ev_mons01",84.0f,-133.0f,-16.0f)
	Turn("ev_mons01",120f,360.0f)
	ChangeAnimation("ev_mons01", "ANI_WAIT", -1, 1)

	//PLAYER配置--------------------------------------
	SetChrPos("PLAYER1",69.43f,-124.48f,-16.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	//TurnToChr("PLAYER1" , "ev_mons01" , 360.0f )
	//TurnToChr("ev_mons01" , "PLAYER1" , 360.0f )

	//カメラ設定--------------------------------------
	// argの設定を上書きする
//	SetYs8Camera(7.0f, 60.0f, 10.0f, 0.0f, 0.0f)		//……ボスルーチン作成者の指定があれば入力
	MoveCameraAt( 0 , 69.430f , -124.480f , -14.037f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 12.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -119.402f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	//イベントバトル用CallFunc------------------------
	CallFunc("system:boss_start")						//……イベントバトル用の色々な処理を行うfunction

	//その他処理--------------------------------------
	//PlayBGM(BGM_BOSS_001, 15)	//◆検証版用仮
	MapAnime("CT_boss","on")							//……逃げられないストッパー起動
	EventAreaEnable( "SubEV_S_Boss_Battle00", 0 )		// イベントエリアを無効化

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ResetStopFlag(STOPFLAG_EVENT)
	//------------------------------------------------
}

//-------------------------------------------
//小ボス②登場
//-------------------------------------------
function "SubEV_S_Boss_Battle01"
{

//開始処理ここから----------------------------------------------------

	CallFunc("system:event_begin")

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrPos("PLAYER1",105.00f,-75.25f,-50.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	ChangeAnimation( "PLAYER1" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER1",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER1" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER1" )

	SetChrPos("PLAYER2",103.67f,-75.69f,-50.00f)
	Turn("PLAYER2",-59.54f,360.0f)
	ChangeAnimation( "PLAYER2" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER2",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER2" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER2" )

	SetChrPos("PLAYER3",104.44f,-73.74f,-50.00f)
	Turn("PLAYER3",-59.44f,360.0f)
	ChangeAnimation( "PLAYER3" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER3",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER3" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER3" )

	// ボスの位置セット
	SetChrPos("mons02",120.0f,-84.0f,-50.0f)
	Turn("mons02",120f,360.0f)
	ChrAlpha("mons02", 0.0f, 0)	// ID, 変化後のアルファ値, 変化にかかるフレーム数

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt( 0 , 109.070f , -74.295f , -40.348f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 33.989f , 0 )	// 基本仰角
	RotateCamera( 0 , 225.915f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 170.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6302:SubEV_S_Boss_Battle01_ED")

//開始処理ここまで-----------------------------------------------

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 109.156f , -81.406f , -42.543f , 200 )	// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.000f , 200 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 27.591f , 200 )	// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 259.079f , 200 )				// 角度

	//StopBGM(120)

	// フェードイン
	FadeIn(FADE_BLACK, FADE_FAST)
	WaitFade()

	//登場の演出としては、エフェクトを出しながら、モンスターをフェードで出現させればＯＫです。
	//エフェクト番号	105530
	//60フレーム後に光るので、そのあたりでフェード開始するといいかもしれません。
	Effect( 105530, 120.0f,-84.0f,-50.0f, 0 , 0 , IMPACT_NONE , KNOCK_EFXPOS , 0 , 2.0f, 1.0f)		//
	PlaySE(SE_S_BOSS_01, 80, 0, 1000, 0, 1.0f, 0)
	Wait(60)
	ChrAlpha("mons02", 1.0f, 90)	// ID, 変化後のアルファ値, 変化にかかるフレーム数
	PlaySE(SE_S_BOSS_02, 100, 0, 0, 0, 1.0f, 0)
	Wait(60)
	//PlayBGM(BGM_BOSS_001, 0)
	Wait(60)
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

//	CrossFade(FADE_CROSS)
//	MoveCameraAt( 0 , 108.625f , -77.767f , -48.434f , 0 )	// 注視点
//	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
//	ChangeCameraElevation( 0 , 8.838f , 0 )	// 基本仰角
//	RotateCamera( 0 , 244.771f , 0 )				// 角度
//	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
//	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ロール回転
//
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 108.625f , -77.767f , -48.781f , 60 )	// 注視点
//	ExecuteCmd(1000, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.000f , 60 )		// 基本距離
//	ExecuteCmd(1000, ChangeCameraElevation, INTERPOLATE_SPHERE , 8.838f , 60 )	// 基本仰角
//	ExecuteCmd(1000, RotateCamera, INTERPOLATE_SPHERE , 244.771f , 60 )				// 角度
//	Wait(FADE_CROSS)
//
//	// 武器構え
//	ChangeAnimation("PLAYER1", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER2", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER3", "ANI_EV_SETARM", -1, 1)	// 武器構え
//
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//終了処理ここから----------------------------------------------------
	CallFunc("mp6302:SubEV_S_Boss_Battle01_ED")
}
function "SubEV_S_Boss_Battle01_ED"
{

	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//キャラクター初期化
	CallFunc("system:reset_chrmot_ALL")

	// イベント用小ボスを画面外に移動
	SetChrPos("mons02" ,-100000.00f,0.00f,0.00f)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	EventCue("mp6302:Retry_S_Boss01")

	ResetStopFlag(STOPFLAG_EVENT)

//終了処理ここまで----------------------------------------------------
}
function "Retry_S_Boss01"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//ボス配置・アニメ--------------------------------
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))

	SetChrPos("ev_mons02",120.0f,-84.0f,-50.0f)
	Turn("ev_mons02",120f,360.0f)
	ChangeAnimation("ev_mons02", "ANI_WAIT", -1, 1)

	//PLAYER配置--------------------------------------
	SetChrPos("PLAYER1",105.00f,-75.25f,-50.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	//TurnToChr("PLAYER1" , "ev_mons01" , 360.0f )
	//TurnToChr("ev_mons01" , "PLAYER1" , 360.0f )

	//カメラ設定--------------------------------------
	// argの設定を上書きする
//	SetYs8Camera(7.0f, 60.0f, 10.0f, 0.0f, 0.0f)		//……ボスルーチン作成者の指定があれば入力
	MoveCameraAt( 0 , 105.000f , -75.250f , -48.037f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 12.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -121.068f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	//イベントバトル用CallFunc------------------------
	CallFunc("system:boss_start")						//……イベントバトル用の色々な処理を行うfunction

	//その他処理--------------------------------------
	//PlayBGM(BGM_BOSS_001, 15)	//◆検証版用仮
	MapAnime("CT_boss","on")							//……逃げられないストッパー起動
	EventAreaEnable( "SubEV_S_Boss_Battle01", 0 )		// イベントエリアを無効化

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ResetStopFlag(STOPFLAG_EVENT)
	//------------------------------------------------
}

//-------------------------------------------
//小ボス③登場
//-------------------------------------------
function "SubEV_S_Boss_Battle02"
{

//開始処理ここから----------------------------------------------------

	CallFunc("system:event_begin")

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrPos("PLAYER1",92.84f,15.86f,-62.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	ChangeAnimation( "PLAYER1" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER1",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER1",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER1" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER1" )

	SetChrPos("PLAYER2",91.73f,15.44f,-62.00f)
	Turn("PLAYER2",-59.89f,360.0f)
	ChangeAnimation( "PLAYER2" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER2",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER2",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER2" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER2" )

	SetChrPos("PLAYER3",92.50f,17.48f,-62.00f)
	Turn("PLAYER3",-56.34f,360.0f)
	ChangeAnimation( "PLAYER3" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("PLAYER3",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("PLAYER3",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "PLAYER3" , INFOFLAG_NOCHRATARI)
	LookReset( "PLAYER3" )

	// ボスの位置セット
	SetChrPos("mons03",108.0f,7.0f,-62.0f)
	Turn("mons03",120f,360.0f)
	ChrAlpha("mons03", 0.0f, 0)	// ID, 変化後のアルファ値, 変化にかかるフレーム数

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt( 0 , 98.530f , 16.275f , -51.846f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 33.941f , 0 )	// 基本仰角
	RotateCamera( 0 , 225.511f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 170.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6302:SubEV_S_Boss_Battle02_ED")

//開始処理ここまで-----------------------------------------------

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 97.698f , 10.212f , -56.559f , 200 )	// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.000f , 200 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 26.052f , 200 )	// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 257.096f , 200 )				// 角度

	//StopBGM(120)

	// フェードイン
	FadeIn(FADE_BLACK, FADE_FAST)
	WaitFade()

	//登場の演出としては、エフェクトを出しながら、モンスターをフェードで出現させればＯＫです。
	//エフェクト番号	105530
	//60フレーム後に光るので、そのあたりでフェード開始するといいかもしれません。
	Effect( 105530, 108.0f,7.0f,-62.0f, 0 , 0 , IMPACT_NONE , KNOCK_EFXPOS , 0 , 2.0f, 1.0f)		//
	PlaySE(SE_S_BOSS_01, 80, 0, 1000, 0, 1.0f, 0)
	Wait(60)
	ChrAlpha("mons03", 1.0f, 90)	// ID, 変化後のアルファ値, 変化にかかるフレーム数
	PlaySE(SE_S_BOSS_02, 100, 0, 0, 0, 1.0f, 0)
	Wait(60)
	//PlayBGM(BGM_BOSS_001, 0)
	Wait(60)
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

//	CrossFade(FADE_CROSS)
//	MoveCameraAt( 0 , 96.017f , 14.348f , -60.428f , 0 )	// 注視点
//	ChangeCameraDistance( 0 , 8.000f , 0 )		// 基本距離
//	ChangeCameraElevation( 0 , 9.966f , 0 )	// 基本仰角
//	RotateCamera( 0 , 249.963f , 0 )				// 角度
//	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
//	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ロール回転
//
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 96.017f , 14.348f , -60.999f , 60 )	// 注視点
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 8.000f , 60 )		// 基本距離
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 9.966f , 60 )	// 基本仰角
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 249.963f , 60 )				// 角度
//	Wait(FADE_CROSS)
//
//	// 武器構え
//	ChangeAnimation("PLAYER1", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER2", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	ChangeAnimation("PLAYER3", "ANI_EV_SETARM", -1, 1)	// 武器構え
//	Wait(25)
//
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//終了処理ここから----------------------------------------------------
	CallFunc("mp6302:SubEV_S_Boss_Battle02_ED")
}
function "SubEV_S_Boss_Battle02_ED"
{

	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//キャラクター初期化
	CallFunc("system:reset_chrmot_ALL")

	// イベント用小ボスを画面外に移動
	SetChrPos("mons03" ,-100000.00f,0.00f,0.00f)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	EventCue("mp6302:Retry_S_Boss02")

	ResetStopFlag(STOPFLAG_EVENT)

//終了処理ここまで----------------------------------------------------
}
function "Retry_S_Boss02"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//ボス配置・アニメ--------------------------------
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))

	SetChrPos("ev_mons03",108.0f,7.0f,-62.0f)
	Turn("ev_mons03",120f,360.0f)
	ChangeAnimation("ev_mons03", "ANI_WAIT", -1, 1)

	//PLAYER配置--------------------------------------
	SetChrPos("PLAYER1",92.84f,15.86f,-62.00f)
	Turn("PLAYER1",-60.00f,360.0f)
	//TurnToChr("PLAYER1" , "ev_mons01" , 360.0f )
	//TurnToChr("ev_mons01" , "PLAYER1" , 360.0f )

	//カメラ設定--------------------------------------
	// argの設定を上書きする
//	SetYs8Camera(7.0f, 60.0f, 10.0f, 0.0f, 0.0f)		//……ボスルーチン作成者の指定があれば入力
	MoveCameraAt( 0 , 92.840f , 15.860f , -60.037f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 12.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -120.018f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	//イベントバトル用CallFunc------------------------
	CallFunc("system:boss_start")						//……イベントバトル用の色々な処理を行うfunction

	//その他処理--------------------------------------
	//PlayBGM(BGM_BOSS_001, 15)	//◆検証版用仮
	MapAnime("CT_boss","on")							//……逃げられないストッパー起動
	EventAreaEnable( "SubEV_S_Boss_Battle02", 0 )		// イベントエリアを無効化

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ResetStopFlag(STOPFLAG_EVENT)
	//------------------------------------------------
}

