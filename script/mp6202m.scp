#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"
#include "inc/music.h"
#include "inc/efx.h"
#include "inc/temp/mp6401m.h"

//----------------------------------------------------------------------------//
//                                                                            //
// 王都東街区（過去）  			                                              //
//                                                                            //
//----------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
// 初期化スクリプト
///////////////////////////////////////////////////////////////////////////////
//-------------------------------------------

function "init"
{
	
	//遠景不必要ノード削除◆マップ作業者用
	MapHide( "@BG2_etania" , 0 )
	MapHide( "BG2_groundfog_forest" , 0 )

	// イベントエリア設定制御
	EventAreaEnable( "evb2_act_0413" , 0 )	//アクティブボイス

	if( FLAG[SF_EVENT_ON] )
	{
		SetChrPos("SubEV_Past_SpiritE", -100000.00f, 0.00f, 0.00f)

		if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )		//▼ダーナ編③王都を歩く
		{
			if( !FLAG[GF_SUBEV_PAST_D3_EASTBLOCK] )	// ダーナ編③：【サブイベント：東街区に入った】を見た
			{
				EventCue("mp6202m:SubEV_Past_D3_EastBlock")		//ダーナ編③：【サブイベント：東街区に入った】
			}
		}
		if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )		//▼過去編Ⅳ王宮前へ向かう
		{
			if( !FLAG[GF_SUBEV_PAST_SPIRITE] )	// 過去編Ⅳ：【精霊救出Ｅ：渦から精霊を救出する】を見た
			{
				SetChrPos("SubEV_Past_SpiritE",-278.33f,988.05f,1.43f)// 過去編Ⅳ：【精霊救出Ｅ：渦から精霊を救出する】
			}
		}
		// アクティブボイス
		if(!FLAG[GF_AVOICE_0413] && FLAG[GF_04MP6101M_KNOW_DOWNFALL] && !FLAG[GF_04MP6201_DIS_OBSTACLE]){
			EventAreaEnable( "evb2_act_0413" , 1 )
		}

		//一般配置ファンクション呼び出し
		CallFunc("mp6202m:NpcPosition")
	}
}

//////////////////////////////////////////////////////////////////////
//■アクティブボイス
//////////////////////////////////////////////////////////////////////
function "act_0413"
{
	if (!FLAG[GF_AVOICE_0413])
	{
		EventAreaEnable( "evb2_act_0413" , 0 )
		ActiveVoiceStop(ACTIVEVOICESTOP_WINDOWOFF)
		ActiveVoiceStart(EACT_EVID_0413, 1, 0)	//王都内に入った
	}
}

//////////////////////////////////////////////////////////////////////
//■一般配置
//////////////////////////////////////////////////////////////////////
//一般配置
function "NpcPosition"
{

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )				//▼過去編Ⅵセレンの園へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_5_GO_VALLAY] )		//▼過去編Ⅴ王家の谷へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_4_2_GO_OUT] )			//▼過去編Ⅳ-２王宮の外へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )		//▼過去編Ⅳ王宮前へ向かう
	{
		SetChrPos("Hals",-330.55f	963.59f	1.43f)
		Turn("Hals",-10.64f,360.0f)

		SetChrPos("Mira",-336.72f,969.56f,1.48f)
		Turn("Mira",-41.76f,360.0f)
		//SetChrPos("Mira",-336.66f,969.12f,1.43f)
		//Turn("Mira",-41.76f,360.0f)
		SetChrPos("TALKPT_Mira",-335.09f	967.43f	1.43f)		//カウンター会話

		SetChrPos("Fredo",-314.87f	957.91f	1.43f)
		Turn("Fredo",62.50f,360.0f)
		SetChrPos("TALKPT_Fredo",-317.40f	956.59f	1.43f)		//カウンター会話

		SetChrPos("Musdan",-331.00f	961.57f	1.43f)
		Turn("Musdan",-36.06f,360.0f)

		SetChrPos("Orlet",-329.50f	959.70f	1.43f)
		Turn("Orlet",136.05f,360.0f)

		SetChrPos("Mudas",-321.10f	990.73f	1.43f)
		Turn("Mudas",38.59f,360.0f)
		SetChrPos("TALKPT_Mudas",-322.58f	988.57f	1.43f)		//カウンター会話

		SetChrPos("Anthea",-352.12f	878.93f	1.83f)
		Turn("Anthea",159.07f,360.0f)
		SetChrWork("Anthea",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止

		SetChrPos("Meer",-353.77f	881.02f	1.83f)
		Turn("Meer",-108.93f,360.0f)
		SetChrWork("Meer",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止
		SetChrInfoFlag( "Meer",INFOFLAG_NOTALKTURN)
		SetChrInfoFlag( "Meer",INFOFLAG_NOTALKMOTION)

		SetChrPos("Thea",-352.24f	881.58f	1.83f)
		Turn("Thea",75.93f,360.0f)
		SetChrWork("Thea",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止
		SetChrInfoFlag( "Thea",INFOFLAG_NOTALKTURN)
		SetChrInfoFlag( "Thea",INFOFLAG_NOTALKMOTION)

		SetChrPos("Citizen_2_B06",-342.63f	912.38f	1.43f)
		Turn("Citizen_2_B06",36.52f,360.0f)
		//NPC_Move_t01

		//--------バザール----------------------------------
		SetChrPos("Citizen_4_B01",-326.95f	940.72f	1.43f)
		Turn("Citizen_4_B01",-132.15f,360.0f)
		ChangeAnimation( "Citizen_4_B01", "ANI_EV_UDEGUMI", -1, 1 )

		SetChrPos("Citizen_4_B02",-327.71f	942.14f	1.43f)
		Turn("Citizen_4_B02",-72.79f,360.0f)
		LookChr("Citizen_4_B02","Citizen_4_B01")

		SetChrPos("Citizen_4_B03",-337.36f	950.27f	1.43f)
		Turn("Citizen_4_B03",-165.32f,360.0f)

	}
	else if( FLAG[GF_PAST_EPISODE_3_GO_BAHA] )			//▼過去編Ⅲバハの塔へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )		//▼過去編Ⅱ南門へ向かう
	{
		//--------入り口付近--------------------------------


		//過去クエスト②　達成前
		if( !FLAG[GF_SUBEV_PAST_02_QUEST_C] )		// 過去編Ⅱ：【過去クエスト②Ｃ：達成イベント】を見た
		{
			// シーア
//			SetChrPos("Thea",-366.37f,876.39f,1.67f)
//			Turn("Thea",31.86f,360.0f)
		}
		else
		{
			//達成後

			SetChrPos("Meer",-372.67f,870.13f,1.67f)
			Turn("Meer",118.12f,360.0f)
			SetChrWork("Meer",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止
			ChangeAnimation( "Meer" , "ANI_WAIT", -1 , 1 )

			SetChrPos("Thea",-373.87f,870.64f,1.67f)
			Turn("Thea",-66.47f,360.0f)
			SetChrWork("Thea",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止
			ChangeAnimation( "Thea" , "ANI_WAIT", -1 , 1 )

			SetChrPos("Io",-352.14f,881.33f,1.83f)
			Turn("Io",-28.20f,360.0f)
			ChangeAnimation( "Io" , "ANI_WAIT", -1 , 1 )

		}

		SetChrPos("Citizen_2_B06",-342.63f	912.38f	1.43f)
		Turn("Citizen_2_B06",36.52f,360.0f)
		//NPC_Move_t01

		//--------バザール----------------------------------

		SetChrPos("Hals2",-338.06f	962.30f	1.43f)
		Turn("Hals2",-31.14f,360.0f)

		SetChrPos("Mira",-336.72f,969.56f,1.48f)
		Turn("Mira",-41.76f,360.0f)
		//SetChrPos("Mira",-336.66f,969.12f,1.43f)
		//Turn("Mira",-41.76f,360.0f)
		SetChrPos("TALKPT_Mira",-335.09f	967.43f	1.43f)		//カウンター会話

		SetChrPos("Fredo",-314.87f	957.91f	1.43f)
		Turn("Fredo",84.38f,360.0f)
		SetChrPos("TALKPT_Fredo",-317.40f	956.59f	1.43f)		//カウンター会話

		SetChrPos("Musdan",-332.02f	963.91f	1.43f)
		Turn("Musdan",5.25f,360.0f)

		SetChrPos("Orlet",-322.43f	958.58f	1.43f)
		Turn("Orlet",96.85f,360.0f)
		ChangeAnimation( "Orlet", "ANI_EV_TEKOSI", -1, 1 )

		//--------せり客--------------------------------------

		SetChrPos("Citizen_2_B01",-334.82f	958.28f	1.43f)
		Turn("Citizen_2_B01",163.75f,360.0f)

		SetChrPos("Citizen_2_B02",-331.11f	960.11f	1.43f)
		Turn("Citizen_2_B02",103.40f,360.0f)
//		ChangeAnimation( "Citizen_2_B02", "ANI_EV_UDEGUMI", -1, 1 )

		SetChrPos("Citizen_2_B03",-337.50f	952.91f	1.43f)
		Turn("Citizen_2_B03",-176.65f,360.0f)
		ChangeAnimation( "Citizen_2_B03", "ANI_EV_UDEGUMI", -1, 1 )

		SetChrPos("Anthea",-332.08f	955.64f	1.46f)
		Turn("Anthea",148.61f,360.0f)
		SetChrWork("Anthea",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止

		//--------せりより向こう側----------------------------

		SetChrPos("Mudas",-321.10f	990.73f	1.43f)
		Turn("Mudas",38.59f,360.0f)
		SetChrPos("TALKPT_Mudas",-322.58f	988.57f	1.43f)		//カウンター会話

		SetChrPos("Lakey",-317.67f	981.78f	1.43f)
		Turn("Lakey",-143.20f,360.0f)
		ChangeAnimation( "Lakey", "ANI_EV_TEKOSI", -1, 1 )

		SetChrPos("Citizen_2_B04",-318.60f	983.46f	1.43f)
		Turn("Citizen_2_B04",-60.71f,360.0f)
		LookChr("Lakey","Citizen_2_B04")
		LookChr("Citizen_2_B04","Lakey")

		SetChrInfoFlag( "Citizen_2_B05" , INFOFLAG_NOMAPATARICHECK )
		SetChrInfoFlag( "Citizen_2_B05" , INFOFLAG_NOGRAVITY )
		SetChrPos("Citizen_2_B05",-311.63f	973.77f	1.25f)
		Turn("Citizen_2_B05",125.99f,360.0f)
		ChangeAnimation("Citizen_2_B05","ANI_EV_SIT_C", -1 , 1 )

		SetChrPos("Citizen_2_D01",-292.70f	995.00f	1.43f)
		Turn("Citizen_2_D01",-14.65f,360.0f)

		SetChrPos("Citizen_2_D02",-283.27f	993.54f	1.43f)
		Turn("Citizen_2_D02",54.91f,360.0f)

		SetChrPos("C390_01",-291.14f	993.04f	1.43f)
		Turn("C390_01",104.65f,360.0f)

	}
	else if( FLAG[GF_PAST_EPISODE_1_GO_CAMP] )			//▼過去編Ⅰアドルがいたポイントへ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )	//▼ダーナ編③王都を歩く
	{
		SetChrPos("Hals",-341.28f,966.48f,1.43f)
		Turn("Hals",-24.84f,360.0f)
		SetChrPos("TALKPT_Hals",-339.96f	964.14f	1.43f)		//カウンター会話

		SetChrPos("Mira",-336.72f,969.56f,1.48f)
		Turn("Mira",-41.76f,360.0f)
		//SetChrPos("Mira",-336.66f,969.12f,1.43f)
		//Turn("Mira",-41.76f,360.0f)
		SetChrPos("TALKPT_Mira",-335.09f	967.43f	1.43f)		//カウンター会話

		SetChrPos("Fredo",-314.87f	957.91f	1.43f)
		Turn("Fredo",62.50f,360.0f)
		SetChrPos("TALKPT_Fredo",-317.40f	956.59f	1.43f)		//カウンター会話

		SetChrPos("Musdan",-337.54f	954.76f	1.43f)
		Turn("Musdan",-20.64f,360.0f)

		SetChrPos("Orlet",-336.48f	953.17f	1.43f)
		Turn("Orlet",130.71f,360.0f)
		ChangeAnimation( "Orlet", "ANI_EV_TEKOSI", -1, 1 )

		SetChrPos("Mudas",-321.10f	990.73f	1.43f)
		Turn("Mudas",38.59f,360.0f)
		SetChrPos("TALKPT_Mudas",-322.58f	988.57f	1.43f)		//カウンター会話

		SetChrPos("Anthea",-329.94f,940.00f,1.43f)
		Turn("Anthea",162.67f,360.0f)
		//npc_free

		SetChrPos("Meer",-354.54f,881.61f,1.83f)
		Turn("Meer",-0.29f,360.0f)
		//npc_free

		SetChrPos("Thea",-347.26f	891.11f	1.43f)
		Turn("Thea",37.30f,360.0f)
		SetChrWork("Thea",CWK_NPCMODE,NPC_MODE_WAIT )		//ムーブ停止

		SetChrPos("Lakey",-332.46f	967.10f	1.43f)
		Turn("Lakey",140.51f,360.0f)

		SetChrInfoFlag( "Citizen_D3_A01" , INFOFLAG_NOMAPATARICHECK )
		SetChrInfoFlag( "Citizen_D3_A01" , INFOFLAG_NOGRAVITY )
		SetChrPos("Citizen_D3_A01",-311.63f	973.77f	1.25f)
		Turn("Citizen_D3_A01",125.99f,360.0f)
		ChangeAnimation("Citizen_D3_A01","ANI_EV_SIT_C", -1 , 1 )

		SetChrPos("Citizen_D3_A02",-311.77f	988.29f	1.43f)
		Turn("Citizen_D3_A02",-124.06f,360.0f)
		//NPC_Move_t02

		SetChrPos("Citizen_D3_A03",-342.63f	912.38f	1.43f)
		Turn("Citizen_D3_A03",36.52f,360.0f)
		//NPC_Move_t01

	}
	else //▼ダーナ編①Ａ寺院内を歩く
	{
	}
}

function "NPC_Move_t01"
{
	while(1)
	{
		MoveTo(this,-347.45f,906.03f,1.43f,0.5f,0.25f)
		Wait(60)
		MoveTo(this,-329.32f,930.37f,1.43f,0.5f,0.25f)
		Wait(60)
	}
}
function "NPC_Move_t02"
{
	while(1)
	{
		MoveTo(this,-283.67f,1000.63f,1.43f,0.5f,0.25f)
		Wait(60)
		MoveTo(this,-313.61f,987.26f,1.43f,0.5f,0.25f)
		Wait(60)
	}
}

function "NPC_TeburiLoop"
{
	while(1)
	{
		Wait((80 + rand() % 120))	// 適当にばらけさせる
		ChangeAnimation("this","ANI_EV_TEBURI", -1 , 1 )
	}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//■一般会話セクション

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//──────────────────────────────
//	【商人ムスダン】
//──────────────────────────────
function "Talk_Musdan"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でハルス・オルレットと話す
		//	モーション	：
		//───────────────
		
		LookChr("this","LEADER")
		
		if( !FLAG[TF_MUSDAN_TALK] )
		{
			//	商人ムスダン
			TalkPopup("this",0,0,0,0,0)
			{
				"……実はわたくし、両親が"
				"長年病に伏せておりましてね。\p"
				"そろそろ帰って孝行しようかと。"
				"孝行4行目"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("this","ANI_EV_TEBURI", -1 , 1 )

			TalkPopup("this",0,0,0,0,0)
			{
				"ハハハ、もう十分に"
				"楽しませていただきました。\p"
				"……この国にきて、"
				"本当に良かったと思いますよ。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MUSDAN_TALK, 1 )
		}
		else
		{
			//　　★繰り返し

			//	商人ムスダン
			TalkPopup("this",0,0,0,0,0)
			{
				"名残惜しくはありますが……"
				"いや、十分に楽しませていただきました。\p"
				"ハハハ、この国にきて"
				"本当に良かったと思いますよ。2"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前で客引き
		//	モーション	：
		//───────────────
		//	商人ムスダン
		TalkPopup("this",0,0,0,0,0)
		{
			"さあさあ、朝の競りも"
			"終幕が近づいてまいりましたよ！\p"
			"次なる商品もお見逃しなく。"
			"大特価で買えるかもしれませんぞ！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でオルレットと話す
		//	モーション	：
		//───────────────
		//　　振り返らない
		if( !FLAG[TF_MUSDAN_TALK] )
		{
			CallFunc("mp6202m:Talk_Musdan_Orlet")	//共通会話
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//　　振り返らない
			//	商人ムスダン
			TalkPopup("this",0,0,0,0,0)
			{
				"わははっ、いつも"
				"張り合いのある勝負をしていただいて"
				"感謝しておりますよ。\p"
				"私の商会が王都一まで上り詰めたのも"
				"あなたのお陰かもしれませんなぁ。\p"
				"まあまあご近所同士、"
				"今後ともよろしくお願いしますよ。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}

function "Talk_Musdan_Orlet"
{

			PlayVoice(Y8V_5755,"this",100)		//いやはや（温厚に）

			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"わははっ、オルレット殿は"
				"売り上げを追いすぎておるのですよ。\p"
				"目先のカネより将来の利益、"
				"商売はもちっと広い目で臨みませんとなぁ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	商人オルレット
			TalkPopup("Orlet",0,0,0,0,0)
			{
				"んな事ァ分かってるよ。"
				"素人と一緒にするない、ムスダンよう。\p"
				"俺が言いてえのはいつも"
				"バケモンみてえな先読みしやがって"
				"コノヤロウってこった！"
			}
			WaitPrompt()
			WaitCloseWindow()

			PlayVoice(Y8V_5752,"Musdan",100)	//ありがたい事でございます

			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"わはははっ、万年売り上げ二位の"
				"オルレット殿にそう言われると、"
				"最高の褒め言葉ですなぁ！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MUSDAN_TALK, 1 )
			SetFlag( TF_ORLET_TALK, 1 )

}


//──────────────────────────────
//	【ハルス】
//──────────────────────────────
function "Talk_Hals"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でムスダンと話す
		//	モーション	：
		//───────────────

		//	ハルス
		TalkPopup("this",0,0,0,0,0)
		{
			"旦那様は以前から、故郷に帰る事を"
			"決めておられたのです。\p"
			"しかし店を続けたいという想いも強く、"
			"あと１年、あと１年と"
			"つい先延ばしにされて………\p"
			"あるいは、そんな"
			"時を惜しむ気持ちが原動力となって"
			"成功なさったのかもしれませんね。"
		}
		WaitPrompt()
		WaitCloseWindow()


	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会の前で呼び込み
		//	モーション	：
		//───────────────
		//　　振り返らない
		//	ハルス
		TalkPopup("this",0,0,0,0,0)
		{
			"次なるお値打ち品は、大麦十袋！"
			"限定百セットのみとなります！\p"
			"始値は定価の十分の一！"
			"十分の一からでございますよ！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会の前で呼び込み
		//	モーション	：
		//───────────────
		//	ハルス
		TalkPopup("this",0,0,0,0,0)
		{
			"新陛下の戴冠式も"
			"まもなくという噂ですね。\p"
			"ムスダン商会では"
			"記念品を多数ご用意しておりますよ。\p"
			"ご親戚への贈り物にいかがでしょう？"
			"きっと喜ばれる事でしょう。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【ミラ】
//──────────────────────────────
function "Talk_Mira"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会カウンター
		//	モーション	：
		//───────────────
		//	ミラ
		TalkPopup("this",0,0,0,0,0)
		{
			"いらっしゃいませ、ムスダン商会は"
			"本日も営業しておりますよ。\p"
			"閉店は半月後となります。\p"
			"どうか残りの期間も"
			"ご愛顧のほどをお願いいたしますね。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会カウンター
		//	モーション	：
		//───────────────
		//	ミラ
		TalkPopup("this",0,0,0,0,0)
		{
			"ふふ、毎朝大賑わいですね。\p"
			"定価での販売も致しておりますよ。"
			"ご用命の際は声をお掛け下さいませ。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会カウンター
		//	モーション	：
		//───────────────
		//	ミラ
		TalkPopup("this",0,0,0,0,0)
		{
			"いらっしゃいませ。"
			"どちらの商品にいたしましょう。\p"
			"ムスダン商会は王都一の品揃え──\p"
			"ムスダン2行目"
			"どうかお買い物なら"
			"ムスダン商会でご用命下さい。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【商人オルレット】
//──────────────────────────────
function "Talk_Orlet"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でムスダンと話す
		//	モーション	：
		//───────────────
		//　　振り返らない
		if( !FLAG[TF_ORLET_TALK] )
		{
			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"とまあ、そういうわけでして。\p"
				"残った商品や土地の利用権は"
				"あなたにお譲りしたいのですが……"
			}
			WaitPrompt()
			WaitCloseWindow()

			EarthQuake( 0.05f , 0.05f , 5 )	
			//	商人オルレット
			TalkPopup("this",0,0,0,0,0)
			{
				"……ざけんな、このタコが。\p"
//			}
//			WaitPrompt()
//			WaitCloseWindow()
//
//			TalkPopup("this",0,0,0,0,0)
//			{
				"てめェがいねえバザールなんざ"
				"ヌルくてやってられるかっつーの！"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("Musdan","ANI_EV_TEBURI", -1 , 1 )

			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"ふふ、そんなあなた"
				"だからこそですよ。\p"
				"どうかこのバザールを、"
				"よろしくお願いしましたよ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　オルレット、顔を背ける
			Look("this" , 20 , 0 )
			Wait(15)

			//	商人オルレット
			TalkPopup("this",0,0,0,0,0)
			{
				"クソッタレ……"
				"俺は認めねえぞ……\p"
				"なにより、最後までお前ェに"
				"出し抜かれるなんざ真っ平だぜ！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　オルレット、顔を背ける
			Look("this" , 0 , 0 )
			ChangeAnimation("this","ANI_EV_TEKOSI_S", -1 , 1 )
			Wait(25)

			//	商人オルレット
			TalkPopup("this",0,0,0,0,0)
			{
				"ハン、どうしてもってんなら"
				"こいつは取引だ。\p"
				"……落ち着いたら手紙を寄越しな。"
				"それが引き受ける条件だ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			HeadYes("Musdan" , 1 , 25)
			Wait(15)

			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"ありがとう、オルレット殿……"
				"必ずまたお会いしましょう。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_ORLET_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　振り返らない
			//	商人オルレット
			TalkPopup("this",0,0,0,0,0)
			{
				"お前の実家は辺境だったな。"
				"……何かありゃあ手紙をよこせ。\p"
				"闇市時代からのよしみだ。"
				"大抵のモンは融通してやるからよ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	商人ムスダン
			TalkPopup("Musdan",0,0,0,0,0)
			{
				"ありがとう、オルレット殿……\p"
				"どうかこの私たちのバザールを、"
				"よろしくお願いしましたよ。2"
			}
			WaitPrompt()
			WaitCloseWindow()

		}

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でムスダンの方を向く
		//	モーション	：
		//───────────────

		LookChr("this","LEADER")
		
		//	商人オルレット
		TalkPopup("this",0,0,0,0,0)
		{
			"ムスダンの野郎、個人客相手に"
			"競り売りを始めやがってな……\p"
			"ハン、元々は売れ残った商品が"
			"勿体ねえってんで始めたらしいが……\p"
			"今じゃこの有様だ。"
			"やれやれ、さすがに参ったぜ……"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：店前でムスダンと話す
		//	モーション	：
		//───────────────
		//　　ムスダンと共通
		//　　★繰り返し
		//　　※カメラ切り替えなし
		//　　振り返らない
		if( !FLAG[TF_ORLET_TALK] )
		{
			CallFunc("mp6202m:Talk_Musdan_Orlet")	//共通会話
		}
		else
		{
			//	商人オルレット
			TalkPopup("this",0,0,0,0,0)
			{
				"お前ェとは闇市時代からの"
				"ライバルだが……"
				"いい加減ウンザリだぜ。\p"
				"目の上のコブ、次こそは"
				"綺麗サッパリ取らせてもらうぜ？"
				"ムスダンよう！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【フレド】
//──────────────────────────────
function "Talk_Fredo"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：オルレット商会カウンター
		//	モーション	：
		//───────────────

		PlayVoice(Y8V_5742,"this",100)	//うーん

		//	フレド
		TalkPopup("this",0,0,0,0,0)
		{
			"ムスダン商会には、結局一度も"
			"勝てはしませんでした……\p"
			"目の上のコブだったのに、こんな形で"
			"いなくなってしまうだなんて……\p"
			"はぁぁ……これから一体"
			"何を目標に頑張ればいいんだ……"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：オルレット商会カウンター
		//	モーション	：
		//───────────────
		//	フレド
		TalkPopup("this",0,0,0,0,0)
		{
			"……この３年、ムスダン商会には"
			"水をあけられっぱなしですよ……\p"
			"うちも伸びていますが……"
			"まったく喜べる雰囲気じゃありません。\p"
			"ええ、商人の意地にかけて"
			"次こそは何としても勝たなくては……！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：オルレット商会カウンター
		//	モーション	：
		//───────────────
		if( !FLAG[TF_FREDO_TALK] )
		{
			//	フレド
			TalkPopup("this",0,0,0,0,0)
			{
				"ムスダン商会め……！"
				"またしてもやられましたよ！\p"
				"もう戴冠式の記念品を"
				"店頭に並べているなんて……！\p"
				"……ムスダンという男は"
				"独自の情報網をもっていて、"
				"市場の先の先まで正確に読んでくるんです。\p"
//				"今月こそは絶対に勝ったと思ったのに……"
//				"まったく妖怪みたいな男ですよ……！"
				"今月こそはこのオルレット商会の"
				"勝ちだと思ったのに……"
				"まったくしぶとい男ですよ……！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_FREDO_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	フレド
			TalkPopup("this",0,0,0,0,0)
			{
				"今月はかなり引き離していたのに……"
				"これじゃ確実に追いつかれちまいます。\p"
				"まったく、しぶとい男ですよ……！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【露天商ムーダス】
//──────────────────────────────
function "Talk_Mudas"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：露店をやる
		//	モーション	：
		//───────────────
		if( !FLAG[TF_MUDAS_TALK] )
		{
			//	露天商ムーダス
			TalkPopup("this",0,0,0,0,0)
			{
				"収穫祭は私どもも"
				"大いに稼がせていただきました。\p"
				"バザールは少々"
				"寂しくなりそうですが……\p"
				"なに、ムスダン商会のお陰で"
				"どこも力をつけてきておりますからね。\p"
				"きっと今以上に活気あふれる"
				"バザールにして見せますよ。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MUDAS_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	露天商ムーダス
			TalkPopup("this",0,0,0,0,0)
			{
				"ムスダン商会には"
				"私どももお世話になりました。\p"
				"これからは私たちが"
				"頑張らなくてはいけませんなぁ。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：露店をやる
		//	モーション	：
		//───────────────
		//	露天商ムーダス
		TalkPopup("this",0,0,0,0,0)
		{
			"この３年で王都も"
			"ますます賑わってきましたなぁ～。\p"
			"特に昨年、今年と大豊作が続き"
			"私どもも生活が豊かになりましたよ。\p"
			"サライ陛下も次々と"
			"素晴らしい政策を打ち出されて。\p"
			"はは、噂どおり、これぞ"
			"“最も幸福な時代”でしょうなぁ。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：露店をやる
		//	モーション	：
		//───────────────
		if( !FLAG[TF_MUDAS_TALK] )
		{
			//	露天商ムーダス
			TalkPopup("this",0,0,0,0,0)
			{
				"今の女王、イレーネ様は"
				"弱冠１６歳で王位に就かれたんですよ。\p"
				"ところがその翌年に起きたのが、"
				"あの二百年に一度の大飢饉！\p"
				"その時陛下は、王宮の食料庫を開放して"
				"飢える者を救って下さいましてね。\p"
				"以来イレーネ様といえば、"
				"私たち民の敬愛するお方ですよ。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MUDAS_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	露天商ムーダス
			TalkPopup("this",0,0,0,0,0)
			{
				"イレーネ様は慈悲のある、"
				"善政を敷かれるお方ですよ。\p"
				"退位されるとなると……"
				"寂しくなりますねぇ……"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【アンシア】
//──────────────────────────────
function "Talk_Anthea"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：ベンチに座ってミーア・シーアを見る
		//	モーション	：
		//───────────────

		PlayVoice(Y8V_5764,"this",100)	//はい

		//	アンシア
		TalkPopup("this",0,0,0,0,0)
		{
			"今日は娘たちの誕生日なんです。\p"
			"ミーアはいつも元気だけど、"
			"この一年で少ししっかりしたかしら。\p"
			"シーアはお勉強が好きで、"
			"随分と物知りになりました。\p"
			"ふふ、今日は私も精一杯"
			"２人の成長を祝うとしましょうか。"	//、"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザールエリア
		//───────────────
		//	配置・カメラ：ムスダン商会の前
		//	モーション	：
		//───────────────
		//	アンシア
		TalkPopup("this",0,0,0,0,0)
		{
			"競りって難しいですね。"
			"中々一番安く買うという訳には"
			"いきませんけど……\p"
			"でも熱気があって、"
			"参加するだけで楽しいですね。\p"
			"ミーアとシーアは食べ盛りなんです。"
			"ふふっ、お母さんも頑張りますよ！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{

		ResetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない
		ChangeAnimation( "this", "ANI_WAIT", -1, 1 )	// 待機

		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザールエリア
		//───────────────
		//	配置・カメラ：適当な位置で買い物をする
		//	モーション	：
		//───────────────
		if( !FLAG[TF_ANTHEA_TALK] )
		{
			//	アンシア
			TalkPopup("this",0,0,0,0,0)
			{
				"このバザールは、食材や日用品が"
				"とっても安く買えるんですよ。\p"
				"ふふっ、今日のお昼は"
				"何にしようかしら……\p"
				"可愛いミーアとシーアのためです。"
				"美味しい料理をこさえないとですね。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_ANTHEA_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	アンシア
			TalkPopup("this",0,0,0,0,0)
			{
				"ふふっ、今日のお昼は"
				"何にしようかしら……\p"
				"可愛いミーアとシーアのためです。"
				"美味しい料理をこさえないとですね。 "
			}
			WaitPrompt()
			WaitCloseWindow()
		}
		
		SetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない
		
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【ミーア】
//──────────────────────────────
function "Talk_Meer"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：ミーア・シーアで話す
		//	モーション	：
		//───────────────
		//　　★ＧＦ初回
		if( !FLAG[GF_1STTALK_PAST_4_MEER] )
		{
			CallFunc("mp6202m:Talk_4_Meer_Thea")	//共通会話
		}
		else
		{
			//　　★ＧＦ以降

			LookChr("this","LEADER")
			
			//	ミーア
			TalkPopup("this",0,0,0,0,0)
			{
				"（うーん、シーアには言えない……）\p"
				"（実は毎年覚えてたけど、"
				"　お小遣い使い切っちゃって"
				"　何も買えなかったなんて。）\p"
				"（えへへ、いつも一緒に居るんだもん。"
				"　忘れるわけないもんねー♪）"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：
		//	モーション	：
		//───────────────
		//　　★クエスト達成後のセリフ
		if( !FLAG[TF_MEER_TALK] )
		{
			//	ミーア
			TalkPopup("this",0,0,0,0,0)
			{
				"シーアはおどおどしてトロいけど、"
				"ま、カワイイ妹だもんね。\p"
				"えっへん、これからはおねーちゃんとして"
				"どーんと見守ってあげようじゃないの！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"それじゃあミーアちゃん、着替えた服を"
				"散らかすの、やめてくれないかな……\p"
				"お母さん、いつも困ってるよ？"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　ミーアに冷や汗エモーション
			//	ミーア
			TalkPopup("this",0,0,0,0,0)
			{
				"そ、そういうのは"
				"別クチなんだってば～！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MEER_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	ミーア
			TalkPopup("this",0,0,0,0,0)
			{
				"ま、ともかく"
				"今日はありがとね！\p"
				"巫女さまもあんまり"
				"お転婆しちゃダメだよっ、なーんてね！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{

		ResetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない
		ChangeAnimation( "this", "ANI_WAIT", -1, 1 )	// 待機

		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：
		//	モーション	：フリームーブ
		//───────────────
		//	ミーア
		if( !FLAG[TF_MEER_TALK] )
		{
			TalkPopup("this",0,0,0,0,0)
			{
				"大樹に背きし異民たち～♪"
				"密かに力をたくわえた～、ていっ！\p"
				"これはおばあちゃんに教わった"
				"古い唄なんだよね～。\p"
				"この唄にあわせて理力をつかうと"
				"小石がカンタンに動かせちゃうんだから！\p"
				"フフン、そのうち巫女様より"
				"立派な理力使いになっちゃうかもね～！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MEER_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	ミーア
			TalkPopup("this",0,0,0,0,0)
			{
				"巫女様、また遊んでよね！"
				"オルガさんに怒られない程度にさ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
		
		SetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない
		
	}

	ResetStopFlag(STOPFLAG_TALK)
}

function "Talk_4_Meer_Thea"
{
			//　　振り返らない
			//	ミーア
			TalkPopup("Meer",0,0,0,0,0)
			{
				"ごめんシーア……"
				"今日がシーアの誕生日だなんて……"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"ううん、気にしないで。\p"
				"しょうがないよ、"
				"毎年収穫祭のすぐ後だし……"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	ミーア
			TalkPopup("Meer",0,0,0,0,0)
			{
				"そういうわけには……"
				"──ってわけで、はいこれ。\p"
				"シーアに誕生日プレゼントっ！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　シーアに！エモーション
			EmotionEx("Thea", 0.00f, EMO_EX, 0, 5, 1, 1, 1.0f )	// 「！」
			Wait(40)

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"え、ええええ～……！？\p"
				"ミーアちゃん、"
				"忘れてたんじゃないの！？"
			}
			WaitPrompt()
			WaitCloseWindow()

			PlayVoice(Y8V_5778,"Meer",100)	//あはは

			//	ミーア
			TalkPopup("Meer",0,0,0,0,0)
			{
				"そんなのウソウソに"
				"決まってるじゃん♪\p"
				"あはは、シーアは単純だな～！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"（う、うそー！　また騙されたよぅ！）"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( GF_1STTALK_PAST_4_MEER, 1 )

}


//──────────────────────────────
//	【シーア】
//──────────────────────────────
function "Talk_Thea"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：ミーア・シーアで話す
		//	モーション	：
		//───────────────
		//　　★ＧＦ初回
		if( !FLAG[GF_1STTALK_PAST_4_MEER] )
		{
			CallFunc("mp6202m:Talk_4_Meer_Thea")	//共通会話
		}
		else
		{
			//　　ミーアと共通
			//　　★ＧＦ以降
			//　　振り返らない
			PlayVoice(Y8V_5777,"Thea",100)	//わあ！

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"これって、青いリボン……"
				"ミーアちゃんにあげたのとお揃いだ～！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	ミーア
			TalkPopup("Meer",0,0,0,0,0)
			{
				"あはは、あたしは"
				"赤いリボンをもらったっけ。\p"
				"……なんてゆーかその、さ。\p"
				"シーア、また一年よろしくね！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	シーア
			TalkPopup("Thea",0,0,0,0,0)
			{
				"えへへ、うんっ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：
		//	モーション	：
		//───────────────
		if( FLAG[GF_SUBEV_PAST_02_QUEST_C] )
		{
			//　　★クエスト達成後のセリフ
			//	シーア
			TalkPopup("this",0,0,0,0,0)
			{
				"えへへ、ミーアちゃんが"
				"見つかってよかったです。\p"
				"巫女様、今日はほんとうに"
				"ありがとうございましたっ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
//		else if( FLAG[GF_SUBEV_PAST_02_QUEST_A] == 2 )		// 過去編Ⅱ：【過去クエスト②Ａ：かくれんぼの話を聞く】を見た（1:見て断った、2:手伝うを選んだ）
//		{
//			//　　★クエスト中のセリフ
//			//	シーア
//			TalkPopup("this",0,0,0,0,0)
//			{
//				"ミーアちゃん、どこぉ……？\p"
//				"巫女様、ごめんなさい。"
//				"ミーアちゃんを見つけたら教えてください。\p"
//				"どうかよろしくお願いしますっ！"
//			}
//			WaitPrompt()
//			WaitCloseWindow()
//		}
//		else
//		{
//			SetFlag( TF_LOADING_TIPS_OFF, 1 )	//NowLoading 時の Tips 表示をカット
//			EventCue("mp6202m:SubEV_Past_02_Quest_A")		// 過去編Ⅱ：【過去クエスト②Ａ：かくれんぼの話を聞く】
//		}
	

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：ミーアを見守っている
		//	モーション	：
		//───────────────
		if( !FLAG[TF_THEA_TALK] )
		{
			//	シーア
			TalkPopup("this",0,0,0,0,0)
			{
				"ミーアちゃんは器用で、"
				"なんでも簡単にこなしちゃうんです。\p"
				"最近は巫女様に憧れて"
				"理力の稽古を始めたみたいで……\p"
				"うう、双子なのに"
				"置いてきぼりなんてやだな……"
				"わたしも稽古しようかなぁ……"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_THEA_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	シーア
			TalkPopup("this",0,0,0,0,0)
			{
				"わたしがミーアちゃんより得意なのは"
				"本を読むことくらいなんです。\p"
				"双子なのに置いてきぼりなんてやだな……"
				"わたしも稽古しようかなぁ……2"
				"稽古5行目"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【レイキー】
//──────────────────────────────
function "Talk_Lakey"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザールエリア
		//───────────────
		//	配置・カメラ：上のキャラと話す
		//	モーション	：
		//───────────────
		//	レイキー
		TalkPopup("this",0,0,0,0,0)
		{
			"ヒック、さすがは南方産だぁ。"
			"この酒うめぇなぁ～！\p"
			"っていやいや、俺は"
			"サボってるんじゃねえよ？\p"
			"こう見えて仕事の"
			"アイデアを練ってんのよ。\p"
			"ウマい酒がねえと頭が"
			"働かねえって寸法でな、わははは！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザールエリア
		//───────────────
		//	配置・カメラ：ムスダン商会で買い物をする
		//	モーション	：
		//───────────────
		//	レイキー
		TalkPopup("this",0,0,0,0,0)
		{
			"ヒック……へへへ、この乾物は"
			"酒のツマミによさそうじゃねーの！\p"
			"この店はいいねえ。"
			"いつ来ても発見があって飽きねえよ。\p"
			"やっぱ職人は、日常の中に"
			"こういう刺激がなくっちゃなぁ！"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		LookChr("Lakey","Citizen_2_B04")
	}
}

//──────────────────────────────
//	【イオ】
//──────────────────────────────
function "Talk_Io"
{
	SetStopFlag(STOPFLAG_TALKTURN)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		if(!FLAG[TF_TALK_MOB10])
		{
			//　　以降、イオは付近に一般配置。
			//　　話しかけると以下のメッセージ。

			PlayVoice(Y8V_6013,"Io",100)	//むふふ♪（いたずらっぽい笑い）

			//	イオ
			TalkPopup("Io",0,0,0,0,0)
			{
				"それにしてもあの地下聖堂、"
				"また探検してみたいな～。\p"
				"巫女様だって、あの奥が"
				"どうなっているか気になるでしょ？"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	"DANA"
			TalkPopup("LEADER",0,0,0,0,0)
			{
				"#000e#000mそ、それは……\p"
				"気になるけど、イオちゃんを"
				"連れていくわけにはいかないよ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	イオ
			TalkPopup("Io",0,0,0,0,0)
			{
				"ええ～っ……\p"
				"そりゃないよ～。"
				"あたしだって行きたいのにぃ！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	"DANA"
			TalkPopup("LEADER",0,0,0,0,0)
			{
				"#000e#000mだーめ、危ない場所に"
				"子供は連れていけないかな。\p"
				"勝手に入るのも禁止だよ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　不満そうにしつつも従うイオ。
			//	イオ
			TalkPopup("Io",0,0,0,0,0)
			{
				"……はーい。"
			}
			WaitPrompt()
			WaitCloseWindow()

			SetFlag(TF_TALK_MOB10,1)
		}
		else
		{
			//　　以降繰り返し。
			PlayVoice(Y8V_6010,"Io",100)	//んー？（やや疑問）

			//	イオ
			TalkPopup("Io",0,0,0,0,0)
			{
				"あの地下聖堂、"
				"奥はどうなってるんだろ？\p"
				"巫女様、何か分かったら"
				"アタシにも教えてね。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}
	ResetStopFlag(STOPFLAG_TALKTURN)
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//■常設　モブ


//──────────────────────────────
//	【王都市民】（女性）Citizen_2_B06
//──────────────────────────────
function "Talk_Citizen_2_B06"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：街路をルートムーブ＜東手前Ａ１＞
		//───────────────

		ChangeAnimation("this","ANI_EV_REI", -1 , 1 )

		if( !FLAG[TF_TALK_MOB01] )
		{
			
			PlayVoice(Y8V_5772,"this",100)	//まあ

			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"まあ巫女様、今日も"
				"ご機嫌麗しゅうございます。\p"
				"巫女様がお顔を出してくださると"
				"なんだか私どもも嬉しくなりますねぇ。\p"
				"巫女様は大樹に最も近いお方……"
				"そんな人に見守られていると思うと。\p"
				"ふふ、身に余る光栄でございますよ。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_TALK_MOB01, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"巫女様がお顔を出してくださると"
				"なんだか私どもも嬉しくなりますねぇ。\p"
				"どうか今後とも"
				"よろしくお導きくださいますように。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：街路をルートムーブ＜東手前Ａ１＞
		//───────────────

		if( !FLAG[TF_TALK_MOB01] )
		{

			PlayVoice(Y8V_5772,"this",100)	//まあ

			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"これはこれは、大樹の"
				"巫女様じゃございませんか！"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("this","ANI_EV_REI", -1 , 1 )
			Wait(40)

			TalkPopup("this",0,0,0,0,0)
			{
				"東街区は連日大盛況ですよ。\p"
				"これも大いなる大樹と"
				"巫女様のおかげでしょうねぇ。\p"
				"どうか今後とも、私どもを"
				"お導きくださいますように。"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_TALK_MOB01, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"東街区は連日大盛況ですよ。"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("this","ANI_EV_REI", -1 , 1 )

			TalkPopup("this",0,0,0,0,0)
			{
				"どうか今後とも、私どもを"
				"お導きくださいますように。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}

	ResetStopFlag(STOPFLAG_TALK)
}



//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//■ダーナ編③　モブ

//──────────────────────────────
//	【王都市民】（中年男性）
//──────────────────────────────
function "Talk_Citizen_D3_A01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{

		ResetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない
		ChangeAnimation( "this", "ANI_WAIT", -1, 1 )	// 待機

		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）・バザールエリア
		//───────────────
		//	配置・カメラ：適当な店で客
		//	モーション	：
		//───────────────
		//───────────────
		if( !FLAG[TF_TALK_MOB02] )
		{
			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"大樹の巫女様に続いて"
				"新しい女王陛下がご即位とは。\p"
				"いや、めでたい！　実にめでたいっ！\p"
				"巫女様と女王様は"
				"エタニアの両輪ですからなぁ！\p"
				"まさに新たな時代の幕開けですぞ！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_TALK_MOB02, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	王都市民
			TalkPopup("this",0,0,0,0,0)
			{
				"巫女様と女王様はエタニアの両輪。\p"
				"わははは、まさに"
				"新たな時代の幕開けですぞ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
		
		SetChrInfoFlag("this", INFOFLAG_NOTALKMOTION)	//W - 会話時にモーションしない

	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【王都市民】（青年）
//──────────────────────────────
function "Talk_Citizen_D3_A02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：街路をルートムーブ＜東手前Ａ１＞
		//───────────────
		PlayVoice(Y8V_5747,"this",100)		//へへっ…（斜に構えて）
		//	王都市民
		TalkPopup("this",0,0,0,0,0)
		{
			"そういや、新しい巫女様になって"
			"何年か経つけど……\p"
			"相変わらずのお転婆っぷりらしいな。\p"
			"うーん、新しい陛下の方は"
			"どんな人なんだろうな？"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【王都市民】（女性）Citizen_D3_A03
//──────────────────────────────
function "Talk_Citizen_D3_A03"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )			//▼ダーナ編③王都を歩く
	{
		//▼ダーナ編③王都を歩く
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：街路をルートムーブ＜東手前Ａ１＞
		//───────────────

		if( !FLAG[TF_TALK_MOB03] )
		{
			PlayVoice(Y8V_5773,"this",100)		//ふふ
			SetFlag( TF_TALK_MOB03, 1 )
		}

		//	王都市民
		TalkPopup("this",0,0,0,0,0)
		{
			"さーて買い物、買い物……\p"
			"王都には大陸各地から"
			"珍しい物が集まってくるから、"
			"ついつい目移りしちゃうのよね。\p"
			"ふう、今日も買い過ぎないように"
			"気をつけておかないとねぇ。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//■過去編Ⅱ　モブ

//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_2_B01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会の前
		//	モーション	：
		//───────────────
		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"きゃっ、大麦よ！"
			"定価の十分の一ですって！\p"
			"しかもここの大麦は美味しいのよね！"
			"ぜったいに安く買ってみせるわっ！"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_2_B02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会の前
		//	モーション	：
		//───────────────
		PlayVoice(Y8V_5747,"this",100)	//へへっ…（斜に構えて）

		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"今日は３つほど"
			"安く買わせて貰ったぞ。\p"
			"おっ、次は大麦か！"
			"よーしこれも狙ってみるとしよう！"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【買い付け商人】
//──────────────────────────────
function "Talk_Citizen_2_B03"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：ムスダン商会の前
		//	モーション	：
		//───────────────
		//	買い付け商人
		TalkPopup("this",0,0,0,0,0)
		{
			"大手にこういう商売されちゃ、"
			"ワシらの立場がないんだがなぁ……\p"
			"しかし安くていい商品ばかりだしな。"
			"足を運ばざるをえんよ、ははは。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_2_B04"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）・バザール
		//───────────────
		//	配置・カメラ：レイキーと話す
		//	モーション	：
		//───────────────
		//　　振り向かない

		PlayVoice(Y8V_5751,"this",100)	//やあ、どうも

		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"やあどうも、よくお会いしますな！\p"
			"ははは、サライ陛下に乾杯！"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	レイキー
		TalkPopup("Lakey",0,0,0,0,0)
		{
			"うわははは！"
			"大樹の巫女様に乾杯っ！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
	LookChr("Citizen_2_B04","Lakey")
}

//──────────────────────────────
//【王都市民】（青年）
//──────────────────────────────
function "Talk_Citizen_2_B05"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：街路をルートムーブ＜東手前Ａ１＞
		//───────────────
		//	王都市民
		TalkPopup("this",0,0,0,0,0)
		{
			"衛士隊のドラン隊長は"
			"《王都の守護者》って呼ばれてるんだ。\p"
			"なんせ、精鋭部隊を率いる"
			"当代最強の戦士だもんな。\p"
			"へへっ、俺たちにとっても"
			"あの人は誇りだぜ。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【行商人】※過去編Ⅰ登場キャラ
//──────────────────────────────
function "Talk_Citizen_2_D01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：奥の階段を降りた辺り／近くに竜車を置く
		//	モーション	：
		//───────────────
		//	行商人
		TalkPopup("this",0,0,0,0,0)
		{
			"ふふ、バザールは今日も"
			"大賑わいですねぇ。\p"
			"落ち着いたらムスダンさんに"
			"反物を見てもらって、と。\p"
			"今日も焦らず、のんびりいきましょう。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【女性】※過去編Ⅰ登場キャラ
//──────────────────────────────
function "Talk_Citizen_2_D02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )			//▼過去編Ⅱ南門へ向かう
	{
		//▼過去編Ⅱ南門へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：上のキャラの傍にいる
		//	モーション	：
		//───────────────
		//	女性
		TalkPopup("this",0,0,0,0,0)
		{
			"やっと王都に着きましたねぇ。\p"
			"私の手織りの反物……"
			"うまく売り切れるといいですね。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//■過去編Ⅳ　モブ

//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_4_B01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：
		//───────────────
		//　　振り返らない
		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"あの店の品は中々安かった……\p"
			"だが他の店と比べぬうちは"
			"買うとは言えぬ。\p"
			"お前はいつも性急すぎていかん。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}

//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_4_B02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：
		//───────────────
		//　　振り返らない
		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"何を言ってるのよ、あなた。"
			"安いのなら買っちゃいましょうよ！\p"
			"あなたの優柔不断のせいで"
			"いつも買い逃しちゃうんですから。\p"
			"ほら、買いましょう、いますぐっ！"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
	LookChr("Citizen_4_B02","Citizen_4_B01")
}

//──────────────────────────────
//	【バザール客】
//──────────────────────────────
function "Talk_Citizen_4_B03"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )			//▼過去編Ⅳ王宮前へ向かう
	{
		//▼過去編Ⅳ王宮前へ向かう
		//───────────────
		//	場所		：王都東街区（過去）
		//───────────────
		//	配置・カメラ：
		//	モーション	：
		//───────────────
		
		//	バザール客
		TalkPopup("this",0,0,0,0,0)
		{
			"おやおや、ムスダン商会は"
			"どうしたのかのう？\p"
			"いい品を揃えてるのは変わらんが……"
			"いつもと少し雰囲気が違う気がするのぅ。"
		}
		WaitPrompt()
		WaitCloseWindow()

	}

	ResetStopFlag(STOPFLAG_TALK)
}


////////////////////////////////////////////////////////////////////////////////

//■メインイベントセクション

////////////////////////////////////////////////////////////////////////////////

//──────────────────────────────
//▼過去Ⅲ　ダーナが塔へ向かう２
//──────────────────────────────
function "EV_M05S071"			//過去Ⅲ　ダーナが塔へ向かう２
{
	//開始処理ここから-----------------------------------------------
//	CallFunc("system:event_begin")	//EB開始処理

	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)
	SetChrPos("DANA",-319.80f, 981.14f, 1.43f)
	Turn("DANA",36.28f,360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)

	SetChrWork("Odo", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrInfoFlag("Odo", INFOFLAG_NOCHRATARI)
	SetChrPos("Odo",-320.86f, 981.88f, 1.43f)
	Turn("Odo",36.28f,360.0f)
	ChangeAnimation("Odo", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("Odo", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("Odo", SUBMOT_MOUTH, ANI_M_WAIT, 1)
//	ChangeSubAnimation("Odo", SUBMOT_EXT1, ANI_E_LOOKC, 1)

	SetChrWork("Io", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrInfoFlag("Io", INFOFLAG_NOCHRATARI)
	SetChrPos("Io",-339.30f,963.84f,1.43f)
	Turn("Io",-175.35f,360.0f)
	ChangeAnimation("Io", "ANI_EV_SIAN", -1, 1)
	ChangeSubAnimation("Io", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("Io", SUBMOT_MOUTH, ANI_M_WAIT, 1)
//	ChangeSubAnimation("Io", SUBMOT_EXT1, ANI_E_LOOKC, 1)

	SetChrPos("ev_c353",-331.39f, 971.70f, 1.43f)	// 市民・中年男
	Turn("ev_c353",-47.44f,360.0f)
	SetChrPos("ev_c354",-333.88f, 967.17f, 1.43f)	// 市民・中年女
	Turn("ev_c354",138.46f,360.0f)
	SetChrPos("ev_c357",-327.92f, 964.42f, 1.43f)	// 市民・娘①
	Turn("ev_c357",110.03f,360.0f)
	SetChrPos("ev_c358",-330.11f, 964.48f, 1.43f)	// 市民・娘②
	Turn("ev_c358",-82.97f,360.0f)
	SetChrPos("ev_c360",-329.84f, 969.94f, 1.43f)	// 市民・少女②
	Turn("ev_c360",127.80f,360.0f)
	SetChrPos("ev_c366",-332.22f, 966.69f, 1.43f)	// 商人・中年男②
	Turn("ev_c366",131.36f,360.0f)
	SetChrPos("ev_c365",-321.56f, 963.43f, 1.43f)	// 商人・中年男①
	Turn("ev_c365",152.67f,360.0f)

	//カメラ設定
	MoveCameraAt( 0 , -321.895f , 979.699f , 3.632f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.080f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 4.584f , 0 )	// 基本仰角
	RotateCamera( 0 , 167.954f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 220.000, 1.000, 0.700, 0.500)					//イベント毎に調整
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6202m:EV_M05S071_ED")

	//開始処理ここまで-----------------------------------------------

	//　　画面フェードインして東街区の路上。
	//　　ダーナとオドが理力塔から出てくるダーナ。
	//　　それに通行人たちが気づいて寄ってくる。
	//　　中にはダーナを拝みだす人も。

	// カット1 ----------------------------------------------------------------------------------------

	// 移動
	ExecuteCmd(1, MoveTo, "DANA", -323.54f, 975.40f, 1.43f, 0.1f, 0.215f)
	Wait(5)
	ExecuteCmd(2, MoveTo, "Odo", -324.62f, 976.25f, 1.43f, 0.1f, 0.215f)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -324.626f , 975.139f , 3.312f , 150 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.240f , 150 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 6.304f , 150 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 129.846f , 150 )

	// フェードイン
	FadeIn(FADE_BLACK, FADE_NORMAL)
	Wait(FADE_NORMAL)

	// 移動待ち
	WaitThread(1)
	WaitThread(2)

	EmotionEx("ev_c353", 0.00f, EMO_PA, 0, 5, 1, 1, 2.0f )	// 「PA」
	Wait(10)
	TurnToChr("ev_c353", "DANA", 7.0f)
	Wait(10)

	PlayVoice(Y8V_5757,"ev_c353",100)	//ふむ

	//	通行人（中年男）
	TalkPopup("ev_c353",0,2,0,0,0) {
		"おお、あれは……"
	}
	WaitPrompt()
	WaitCloseWindow()

	TurnToChr("ev_c360", "DANA", 8.0f)

	PlayVoice(Y8V_5777,"ev_c360",100)	//わあ！

	//	通行人（子供）
	TalkPopup("ev_c360",0,2,0,0,0) {
		"#18Sダーナ様だ！"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	// カット2 ----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_NORMAL)
	
	// カメラ
	MoveCameraAt( 0 , -323.475f , 974.408f , 4.512f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.740f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -21.448f , 0 )	// 基本仰角
	RotateCamera( 0 , 108.554f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	SetChrPos("ev_c353",-326.59f, 974.69f, 1.43f)	// 市民・中年男
	Turn("ev_c353",-110.89f,360.0f)
	SetChrPos("ev_c354",-328.22f, 975.74f, 1.43f)	// 市民・中年女
	Turn("ev_c354",-90.08f,360.0f)
	SetChrPos("ev_c357",-325.46f, 971.86f, 1.43f)	// 市民・娘①
	Turn("ev_c357",-157.59f,360.0f)
	SetChrPos("ev_c358",-326.59f, 971.71f, 1.43f)	// 市民・娘②
	Turn("ev_c358",-154.03f,360.0f)
	SetChrPos("ev_c360",-325.46f, 974.14f, 1.43f)	// 市民・少女②
	Turn("ev_c360",-139.74f,360.0f)
	SetChrPos("ev_c366",-326.81f, 972.97f, 1.43f)	// 商人・中年男②
	Turn("ev_c366",-139.81f,360.0f)
	SetChrPos("ev_c365",-323.44f, 972.28f, 1.43f)	// 商人・中年男①
	Turn("ev_c365",177.54f,360.0f)

	SetChrPos("Io",-326.62f,970.40f,1.43f)
	Turn("Io",-148.35f,360.0f)
	ChangeSubAnimation("Io",SUBMOT_EYE,ANI_E_LAUGH,1)
	ChangeSubAnimation("Io",SUBMOT_MOUTH,ANI_M_SMILE,1)
	ChangeAnimation("Io", "ANI_EV_RYOTESIRI", -1, 1)
	
	ChangeAnimation( "ev_c365", "ANI_EV_PRAY", -1, 1 )	// 祈り
	ChangeSubAnimation("ev_c365", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	LookChr("ev_c353", "DANA")
	LookChr("ev_c354", "DANA")
	LookChr("ev_c357", "DANA")
	LookChr("ev_c358", "DANA")
	LookChr("ev_c360", "DANA")
	LookChr("ev_c366", "DANA")
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -323.475f , 974.408f , 3.112f , 90 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 2.740f , 90 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -4.832f , 90 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 109.128f , 90 )
	
	// フェード待ち
	Wait(FADE_NORMAL)
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//	通行人（商人）
	TalkPopup("ev_c365",0,2,0,0,0) {
		"大樹の巫女様じゃ。"
		"ありがたやありがたや……"
	}
	WaitPrompt()
	WaitCloseWindow()

	PlayVoice(Y8V_5761,"ev_c358",100)	//ダーナ様（呼びかけ）
	
	//	通行人（娘）
	TalkPopup("ev_c358",0,2,0,0,0) {
		"#020e#000mダーナ様、こっち向いて～っ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット3 ----------------------------------------------------------------------------------------

	//　　顔を見合わせるダーナとオド。

	// クロスフェード
	CrossFade(FADE_FAST)

	// カメラ
	MoveCameraAt( 0 , -324.988f , 974.415f , 3.112f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.220f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 6.629f , 0 )	// 基本仰角
	RotateCamera( 0 , 7.710f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Turn("Odo", -8.89f, 360.0f)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -324.988f , 974.415f , 3.112f , 600 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 4.220f , 600 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 7.489f , 600 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 353.958f , 600 )

	// フェード待ち
	Wait(FADE_FAST)

	Wait(10)

//	LookChr("DANA", "Odo")
	LookChr("Odo", "DANA")

	//	理法士オド
	TalkPopup("Odo",0,2,0,0,0) {
		"おお、さすがは大樹の巫女様。"
		"大した人気ですなぁ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("DANA")

	ChangeAnimation( "DANA", "ANI_EV_HOHOKAKI", -1, 1 )	// 頬かき
	PlayVoice(Y8V_3004,"DANA",100)	//あはは…（苦笑）

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#061e#080mあはは……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("Odo")
	Turn("Odo", 30.19f, 5.0f)
	Wait(10)

	// 理法士オド
	TalkPopup("Odo",0,2,0,0,0) {
		"さあさあ、皆の衆！"
		"巫女様が道をお急ぎだぁ！！"
	}
	WaitPrompt()
	WaitCloseWindow()

	// 理法士オド
	TalkPopup("Odo",0,2,0,0,0) {
		"さっさと通してくれぇ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("ev_c353", "ev_c366")
	TurnToChr("ev_c353", "ev_c366", 8.0f)
	Wait(10)

	//	通行人
	TalkPopup("ev_c353",0,2,0,0,0) {
		"おお、ダーナ様がお通りだとよ。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	LookChr("ev_c366", "ev_c353")
	Wait(5)
	HeadYes("ev_c366", 1, 25)	// キャラ, うなずき回数, 速さ
	
	//	通行人
	TalkPopup("ev_c366",0,1,0,0,0) {
		"ジャマをしちゃなんねぇ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_c353", "ANI_EV_TEBURI", -1, 1 )	// 手振り

	//	通行人
	TalkPopup("ev_c353",0,2,0,0,0) {
		"ダーナ様に会えるなんて、"
		"今日はいいことがありそうだな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット4 ----------------------------------------------------------------------------------------

	//　　ささっと人垣が割れ、そこを通って中央区へ
	//　　歩いていくダーナとオド見せちつつフェードアウト。

	// クロスフェード
	CrossFade(FADE_NORMAL)

	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	// カメラ
	MoveCameraAt( 0 , -326.615f , 972.168f , 2.952f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.459f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -0.034f , 0 )	// 基本仰角
	RotateCamera( 0 , 139.444f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	SetChrPos("DANA",-327.14f, 969.78f, 1.43f)
	Turn("DANA",29.55f,360.0f)
	SetChrPos("Odo",-327.49f, 971.37f, 1.43f)
	Turn("Odo",30.19f,360.0f)

	SetChrPos("ev_c353",-328.10f, 974.17f, 1.43f)	// 市民・中年男
	Turn("ev_c353",7.29f,360.0f)
	SetChrPos("ev_c354",-329.16f, 974.26f, 1.43f)	// 市民・中年女
	Turn("ev_c354",-15.47f,360.0f)
	SetChrPos("ev_c357",-324.74f, 972.29f, 1.43f)	// 市民・娘①
	Turn("ev_c357",63.85f,360.0f)
	SetChrPos("ev_c358",-324.54f, 971.01f, 1.43f)	// 市民・娘②
	Turn("ev_c358",74.50f,360.0f)
	SetChrPos("ev_c360",-326.82f, 974.28f, 1.43f)	// 市民・少女②
	Turn("ev_c360",16.59f,360.0f)
	SetChrPos("ev_c366",-330.05f, 973.33f, 1.43f)	// 商人・中年男②
	Turn("ev_c366",17.67f,360.0f)
	SetChrPos("ev_c365",-323.24f, 971.55f, 1.43f)	// 商人・中年男①
	Turn("ev_c365",55.60f,360.0f)
	LookChr("ev_c366", "DANA")
	LookChr("ev_c353", "DANA")

	SetChrPos("Io",-328.76f,972.96f,1.43f)
	Turn("Io",17.67f,360.0f)
	LookChr("Io", "DANA")

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -326.615f , 972.168f , 5.532f , 170 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.459f , 170 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 0.252f , 170 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 165.227f , 170 )
	
	// 移動
	ExecuteCmd(1, MoveTo, "DANA", -333.76f, 952.73f, 1.73f, 0.1f, 0.20f)
	Wait(2)
	ExecuteCmd(2, MoveTo, "Odo", -335.57f, 953.15f, 1.73f, 0.1f, 0.20f)

	// フェード待ち
	Wait(FADE_NORMAL)

	Wait(80)
	
	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()
	
	//終了処理ここから----------------------------------------------------
	CallFunc("mp6202m:EV_M05S071_ED")
}

function "EV_M05S071_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	// 移動停止
	StopThread(1)
	StopThread(2)

	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	//ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_DANA")

	//パーティキャラを解放
	//ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	//CallFunc("system:camera_reset")

	LoadArg("map/mp6201m/mp6201m.arg")
	EventCue("mp6201m:EV_M05S072")

	ResetStopFlag(STOPFLAG_EVENT)

	//終了処理ここまで----------------------------------------------------

}
//──────────────────────────────
//▼【過去編Ⅳ】兵士の一団に遭遇する
//──────────────────────────────
function "EV_M05S210"			//兵士の一団に遭遇する
{
	//開始処理ここから-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	//SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	//SetChrPos("ADOL", 24.48f, -1422.71f, 10.83f)
	//Turn("ADOL", -112.33f, 360.0f)
	//ChangeAnimation("ADOL", "ANI_WAIT", -1, 1)
	//ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
	//ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	//ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	//LookReset("ADOL")
	//SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	//SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	//SetChrPos("RICOTTA", 24.48f, -1422.71f, 10.83f)
	//Turn("RICOTTA", 8.94f, 360.0f)
	//ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
	//ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
	//ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	//ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	//LookReset("RICOTTA")
	//SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)

	//SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	//SetChrPos("SAHAD", 24.48f, -1422.71f, 10.83f)
	//Turn("SAHAD", -64.36f, 360.0f)
	//ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
	//ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
	//ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	//ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	//LookReset("SAHAD")
	//SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("Sarai", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA", 24.48f, -1422.71f, 10.83f)
	Turn("Sarai", -64.36f, 360.0f)
	ChangeAnimation("Sarai", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("Sarai", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("Sarai", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("Sarai", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("Sarai")
	SetChrInfoFlag("Sarai", INFOFLAG_NOCHRATARI)

	SetChrWork("Olga", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Olga", 24.48f, -1422.71f, 10.83f)
	Turn("Olga", -64.36f, 360.0f)
	ChangeAnimation("Olga", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("Olga", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("Olga", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("Olga", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("Olga")
	SetChrInfoFlag("Olga", INFOFLAG_NOCHRATARI)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA", 24.48f, -1422.71f, 10.83f)
	Turn("DANA", -64.36f, 360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)

	//カメラ設定
	MoveCameraAt(0, 30.562f, -1419.305f, 12.734f, 0)	// 注視点
	ChangeCameraDistance(0, 5.000f, 0)		// 基本距離
	ChangeCameraElevation(0, 5.434f, 0)	// 基本仰角
	RotateCamera(0, 115.179f, 0)				// 角度
	ChangeCameraPers(0, 60.000f, 0)			// 視野角
	SetCameraZPlane(0.100f, 300.000f)			// ZPlane
	RollCamera(0, 0.0f, 0)				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 2.000, 10.000, 2.000, 0.450, 0.500)					//イベント毎に調整
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6202m:EV_M05S210_ED")

	//開始処理ここまで-----------------------------------------------

	FadeIn(FADE_BLACK, FADE_NORMAL)
	Wait(FADE_NORMAL)

	//　　画面フェードインして過去の山門屋上──
	//　　会話しているダーナとオルガを映した直後に
	//　　画面が一瞬暗くなって元に戻るような表現。
	//　　ダーナが空を見上げて「？」エモーション表示。

	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000m……………………………………"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mダーナ、どうしたのだ？"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000m今、太陽の光が一瞬"
		"翳った気がしたんだけど……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　オルガも空を見上げる。
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000m気のせいではないのか？"
		"雲は出ていないようだが……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mう、うん…………"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　胸騒ぎで表情が曇るダーナ。
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mそれよりもあの王宮が"
		"消滅してしまうというのは本当か？"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mうん……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　オルガが王都方面を眺めやる。
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000m……………………………………\p"
		"……私とサライは"
		"生まれも育ちもあの王都だからな。\p"
		"情けないことに平然と"
		"受け止められる話ではないようだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mオルガちゃん……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mそれと気にかかるのが"
		"やはり“大穴”の存在だ……\p"
		"一体いつからそんなものが王都に──"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	野太い声
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"よし、全員急げよ！"
		"今日中に片づけてしまうぞ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　列をなした兵士たちが不意に
	//　　ダーナたちの前を通り過ぎようとする。
	//　　先頭の兵士に「！」エモーション。
	//　　全員立ち止まってダーナのほうへ向きなおる。
	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"これはこれは……"
		"ダーナ様ではないですか。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	name2()
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"今日は祭司長までご一緒とは……"
		"城下に向かわれるのですかな？"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mうん、ちょっと"
		"王都で調べたいがあって。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"おお、そうでしたか……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	name2()
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"我々にお手伝いできることがあれば、"
		"何なりとお申し出ください。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mうん、ありがとう。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mそなたたちはどこへ向かうのだ？"
		"ずいぶんと大所帯のようだが……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"サライ女王陛下の命で"
		"食料の貯蔵を行うのです。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	name2()
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"何でも今年は凶作の可能性が高いと"
		"ダーナ様が予言されたとか。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000m昨日出した予言ではないか……\p"
		"もう対応して動いているとは"
		"さすがはサライ女王だな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"ええ、例え凶作が来たとしても"
		"我々には何の不安もありませんよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	name2()
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"何せ我がエタニア王国には"
		"サライ女王とダーナ様……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	name2()
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"“最も幸福な時代”を築いた"
		"お二人が揃っておいでなのですから。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mあ、あはは……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"さて、それではそろそろ"
		"我々は任地へ向かいます。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mうむ、引き留めてしまってすまない。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	ドラン衛士長
	TalkPopup(UNDEF,0,0,0,0,0)
	{
		"とんでもありません。"
		"それでは失礼いたします！"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　規律正しく去っていく兵士たちの一団。
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000m……言えなかったね。\p"
		"王宮が消えてしまうから、"
		"その原因を調べたいなんて……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"Olga"
	TalkPopup("Olga",0,0,0,0,0)
	{
		"#000e#000mそれでいい、これ以上"
		"無用な混乱を招くべきではない。\p"
		"さてと、ダーナ。"
		"我々もそろそろ行くとしよう。\p"
		"アドルとやらが目指しているのは"
		"王宮前の空中回廊だったか。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mうん、アドルさんが“大穴”へ"
		"到着できるよう急がなきゃ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ここで操作許可。

	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()
	//終了処理ここから----------------------------------------------------
	CallFunc("mp6202m:EV_M05S210_ED")
}

function "EV_M05S210_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//フラグ処理
	SetFlag(SF_SETRAMSAVE, 1)

	//	//NowLoading 時の Tips 表示をカット
	//	SetFlag( TF_LOADING_TIPS_OFF, 1 )

	//イベント後の再配置
	SetChrPos("LEADER", 24.48f, -1422.71f, 10.83f)
	Turn("LEADER", 48.16f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// 基本仰角
	//RotateCamera( 0 , 0.0f , 0 )				// 角度
	//ChangeCameraPers( 0 , 0.0f , 0 )			// 視野角
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ロール回転

	RestoreCamera(0, 0)		//※上記カメラ位置を指定する場合は不要
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

	//終了処理ここまで----------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////

//■サブイベントセクション

////////////////////////////////////////////////////////////////////////////////
//──────────────────────────────
//	【サブイベント：東街区に入った】
//──────────────────────────────
function "SubEV_Past_D3_EastBlock"
{
	//　　東街区に入るとサブイベント。

//開始処理ここから----------------------------------------------------

//	CallFunc("system:event_begin")

	SetStopFlag(STOPFLAG_EVENT)

	FadeOut(FADE_BLACK,0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA",-347.88f, 904.12f, 1.43f)
	Turn("DANA",-146.05f,360.0f)
	ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("DANA")
	SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)


	SetChrWork("Meer", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Meer",-344.11f, 902.95f, 1.43f)
	Turn("Meer",166.34f,360.0f)
	ChangeAnimation( "Meer" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Meer",SUBMOT_MOUTH,ANI_M_SMILE,1)
//	ChangeSubAnimation("Meer",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("Meer")
	SetChrInfoFlag( "Meer" , INFOFLAG_NOCHRATARI)

	SetChrWork("Thea", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Thea",-344.78f, 902.30f, 1.43f)
	Turn("Thea",177.00f,360.0f)
	ChangeAnimation( "Thea" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Thea",SUBMOT_MOUTH,ANI_M_SMILE,1)
//	ChangeSubAnimation("Thea",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("Thea")
	SetChrInfoFlag( "Thea" , INFOFLAG_NOCHRATARI)

	SetFlag(SF_CHARANORECVSHADOW,1)	//キャラ影受けない

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt( 0 , -346.041f , 906.583f , 2.450f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.199f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.373f , 0 )	// 基本仰角
	RotateCamera( 0 , 114.446f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。


	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 3.000, 80.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6202m:SubEV_Past_D3_EastBlock_ED")

//開始処理ここまで-----------------------------------------------

	//　　ダーナが歩いてきた所で後ろから
	//　　子供たちがやってくる。
	//　　（中央区・西街区どちらから入っても
	//　　　違和感ない形で行う）
	
	// 移動
	ExecuteCmd(1, MoveTo, "DANA", -345.78f, 907.20f, 1.43f, 0.1f, 0.205f)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -345.877f , 907.061f , 2.910f , 100 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.719f , 100 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 1.087f , 100 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 125.340f , 100 )

	// フェードイン
	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//	// 移動待ち

//	// カメラ待ち

	FadeBGM(70,30)
	SoundEfx( SEFX_EV_HILL, 15 )

	Wait(25)

//	PlayVoice(Y8V_5774,"Meer",100)	//巫女様ー！（元気よく）

	SetName("少女")
	TalkPopup("Meer",0,3,60,230,0)
	{
		"#6134Vあーっ！　巫女様みっけ！"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -345.388f , 906.836f , 2.910f , 67 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.479f , 67 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 3.951f , 67 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 163.444f , 67 )

	// 移動
	ExecuteCmd(2, MoveTo, "Meer", -344.88f, 905.62f, 1.43f, 0.1f, 0.185f)
	LookChr("Meer", "DANA")
	Wait(3)
	ExecuteCmd(3, MoveTo, "Thea", -345.52f, 905.21f, 1.43f, 0.1f, 0.185f)
	LookChr("Thea", "DANA")

	WaitThread(1)
	Turn("DANA", -21.33f, 8.0f)
	Look("DANA", 0.0f, -10.0f)	// うつむく


	// 移動待ち
	WaitThread(2)
	WaitThread(3)

	ChangeAnimation( "Thea", "ANI_EV_REI", -1, 1 )	// 礼
//	PlayVoice(Y8V_5775,"Thea",100)	//巫女様…（可愛らしく）

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	SetName("少女")
	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6135V大樹の巫女様！"
		"おひさしぶりです！"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	//　　ダーナの元にミーア・シーアが駆けてくる。
	
	ChangeAnimation( "DANA", "ANI_EV_RYOTESIRI_S", -1, 1 )	// 両手 尻組み

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6136V#000e#000mまあ、ミーアちゃんにシーアちゃん。\p"
		"#6137Vふふっ、２人とも今日も元気だね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	CrossFade(FADE_CROSS)
	MoveCameraAt( 0 , -345.107f , 905.432f , 2.588f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.669f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 10.562f , 0 )	// 基本仰角
	RotateCamera( 0 , 165.426f , 0 )				// 角度
	ChangeCameraPers( 0 , 42.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Wait(FADE_CROSS)

	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_CLOSE_S,1)
	ChangeAnimation( "Meer", "ANI_EV_TEKOSI_S", -1, 1 )

	//	ミーア
	TalkPopup("Meer",0,1,0,0,0)
	{
		"#6138Vとーぜんっ！\p"
		"#6139V#012eでも巫女様？　あたしとシーアを"
		"いっしょくたにしないで欲しいな。\p"
		"#6140V双子っていっても"
		"あたしの方がお姉ちゃんだし……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_CLOSE_S,1)
	LookChr("Meer","Thea")

	TalkPopup("Meer",0,1,0,0,0)
	{
		"#6141Vどんくさいシーアとは"
		"ぜんぜん違うんだから。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SAD_S,1)
	ChangeSubAnimation("Thea",SUBMOT_MOUTH,ANI_M_WAIT,1)
	LookChr("Thea","Meer")

	//	シーア
	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6142Vうう、ミーアちゃんってば……"
	}
	WaitPrompt()
	WaitCloseWindow()

	CrossFade(FADE_CROSS)
	MoveCameraAt( 0 , -345.722f , 905.194f , 2.450f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.369f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 13.994f , 0 )	// 基本仰角
	RotateCamera( 0 , 168.591f , 0 )				// 角度
	ChangeCameraPers( 0 , 44.900f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Wait(FADE_CROSS)
	
	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#6143V#000e#000mあはは……"
		"相変わらずみたいだね。"
	}
	WaitPrompt()
	WaitCloseWindow()

//CrossFade(FADE_NORMAL)
//MoveCameraAt( 0 , -345.274f , 905.818f , 2.588f , 0 )	// 注視点
//ChangeCameraDistance( 0 , 2.079f , 0 )		// 基本距離
//ChangeCameraElevation( 0 , 11.054f , 0 )	// 基本仰角
//RotateCamera( 0 , 59.342f , 0 )				// 角度
//ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//RollCamera( 0 , 0.0f , 0 )				// ロール回転
//// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
//
//	ExecuteCmd( 1000, RotateCamera, INTERPOLATE_SPHERE , 46.945f , 450 )				// 角度
//
//Wait(FADE_NORMAL)

	LookChr("Meer","DANA")
	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_CLOSE_E,1)
	ChangeAnimation( "Meer", "ANI_EV_TEKOSI_E", -1, 1 )
	Wait(5)
	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SAD_E,1)
	LookChr("Thea","DANA")

	//	ミーア
	TalkPopup("Meer",0,0,0,0,0)
	{
		"#6144Vねえ巫女様、そんな事より"
		"いっしょに遊ぼーよ！\p"
		"#6145Vあのね～、あたしいま"
		"理力の稽古してるんだよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_LAUGH_S,1)
	ChangeAnimation( "Meer", "ANI_EV_HASHAGU", -1, 1 )
	WaitAnimation2( "Meer" , -1, 1, "ANI_EV_HASHAGU",  0)

	TalkPopup("Meer",0,0,0,0,0)
	{
		"#6146Vフフ～ン、すっごく上達したんだから！"
	}
	WaitPrompt()
	WaitCloseWindow()

	EmotionEx("Thea", 0.00f, EMO_ASE, 0, 8, 4, 1, 1.0f )	// 「あせあせ」
	Wait(20)

	//	シーア
	TalkPopup("Thea",0,0,0,0,0)
	{
		"#6147V#080mえっと巫女様、できればわたしにも"
		"ご本を紹介してほしくて……\p"
		"#6148V#020eあのあの、このまえ教えていただいた本、"
		"とっても面白かったです！"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA", "ANI_EV_RYOTESIRI_E", -1, 1 )	// 両手 尻組み
//	PlayVoice(Y8V_2997,"DANA",100)	//ふふ（微笑）

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6149V#000e#000mふふっ、それは良かったかな。\p"
		"#6150Vでも２人ともごめんね……"
		"今日はあまり時間がなくて。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SUP_S,1)
	ChangeSubAnimation("Thea",SUBMOT_MOUTH,ANI_M_WAIT,1)

	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6151V#070e#000mええーっ、いつもは"
		"遊んでくれるのに……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SAD_S,1)
	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_SUP_E,1)
	Look("Meer" , 0 , -10 )

	TalkPopup("Meer",0,0,0,0,0)
	{
		"#6152Vはぁ、でもしょうがないよね……\p"
		"#6153Vただでさえオテンバ巫女様なんだもん。"
		"これ以上サボったら怒られるよね……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Thea", "Meer")
	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SAD_CLOSE_S,1)
	ChangeSubAnimation("Thea",SUBMOT_MOUTH,ANI_M_WAIT,1)
	EmotionEx("Thea", 0.00f, EMO_ASE, 0, 5, 1, 1, 1.0f )	// 「あせあせ」
	Wait(20)

	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6154Vミ、ミーアちゃん！"
		"失礼だようっ……！"
	}
	WaitPrompt()
	WaitCloseWindow()

//MoveCameraAt( 0 , -345.543f , 906.731f , 2.761f , 0 )	// 注視点
//ChangeCameraDistance( 0 , 1.280f , 0 )		// 基本距離
//ChangeCameraElevation( 0 , 7.247f , 0 )	// 基本仰角
//RotateCamera( 0 , 44.336f , 0 )				// 角度
//ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//RollCamera( 0 , 0.0f , 0 )				// ロール回転
//// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
//

//	PlayVoice(Y8V_3004,"DANA",100)	//あはは…（苦笑）

	Look("Meer" , 0 , 0 )
	LookChr("Meer", "DANA")
	Wait(3)
	LookChr("Thea", "DANA")
	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_CLOSE_E,1)

	ChangeAnimation( "DANA", "ANI_EV_HOHOKAKI", -1, 1 )

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6155V#000e#000mあははは……でもアタリかな。\p"
		"#6156V今日サボったらオルガちゃんに"
		"何て言われるか。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation("DANA","ANI_EV_TEBURI", -1 , 1 )

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6157Vまた今度、時間を作ってくるから。\p"
		"#6158Vその時はいっぱい遊ぼう！"
		"約束だよ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6159V#020e#080mはーい、約束だよ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_CLOSE_S,1)
	ChangeAnimation( "Thea", "ANI_EV_REI", -1, 1 )	// 礼

	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6160V#020e#080mあのあの、楽しみにしてますっ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　※聞き込みフラグを立てる
	//　　イベント終了、操作許可。
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//終了処理ここから----------------------------------------------------
	CallFunc("mp6202m:SubEV_Past_D3_EastBlock_ED")
}
function "SubEV_Past_D3_EastBlock_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
//	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	SetFlag(SF_CHARANORECVSHADOW,0)	//キャラ影受ける

	//フラグ立て
	SetFlag( GF_SUBEV_PAST_D3_EASTBLOCK, 1 )	// ダーナ編③：【サブイベント：東街区に入った】を見た
	//　　※聞き込みフラグを立てる
	SetFlag( GF_SUBEV_PAST_D3_TALK_SUBEV, 1 )
	
	if( FLAG[GF_SUBEV_PAST_D3_TALK_DARIOS] && FLAG[GF_SUBEV_PAST_D3_TALK_SUBEV] )
	{
		SetFlag( GF_SUBEV_PAST_D3_TALK_ALL, 1 )
		//SetFlag( SF_MISSIONNO, MS_08_D3B )	//★冒険メモ：あの赤毛の剣士がいた、王都東の郊外へ向かおう
	}

	//マーカー
	DelMapMarker( SMI_DANA_SYMBOL ,PAGE_MF002, MARKER_SUBEV_PAST_D3_1, 0,0)		//サブイベント：東街区に入った

	CallFunc("mp6202m:init")

	//イベント後の再配置
	SetChrPos("LEADER",-350.69f	905.91f	1.43f)
	Turn("LEADER",-33.30f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , -350.690f , 905.910f , 3.299f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 6.800f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 14.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -152.000f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

//	RestoreCamera(0, 0)		//※上記カメラ位置を指定する場合は不要
	CallFunc("system:camera_reset")

	SoundEfx( SEFX_HILL, 15 )

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//終了処理ここまで----------------------------------------------------
}


//──────────────────────────────
//	【過去クエスト②Ｃ：達成イベント】
//──────────────────────────────
function "SubEV_Past_02_Quest_C"
{

//開始処理ここから----------------------------------------------------

	//CallFunc("system:event_begin")

	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA",-364.99f,877.02f,1.67f)
	Turn("DANA",65.46f,360.0f)
	ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("DANA")
	Look("DANA", 0.0f, -10.0f)	// うつむく
	SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)

	SetChrWork("Meer", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Meer",-367.55f,876.40f,1.67f)
	Turn("Meer",-103.04f,360.0f)
	ChangeAnimation( "Meer" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Meer",SUBMOT_EYE,ANI_E_CLOSE,1)
	ChangeSubAnimation("Meer",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Meer",SUBMOT_EXT1,ANI_E_LOOKC,1)
	Look( "Meer", 0 ,-7 )
	SetChrInfoFlag( "Meer" , INFOFLAG_NOCHRATARI)

	SetChrWork("Thea", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Thea",-366.35f,875.81f,1.67f)
	Turn("Thea",162.81f,360.0f)
	ChangeAnimation( "Thea" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Thea",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Thea",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Thea" , INFOFLAG_NOCHRATARI)
	LookChr("Thea", "Io" )

	SetChrWork("Io", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Io",-367.03f,877.45f,1.67f)
	Turn("Io",-52.05f,360.0f)
	ChangeAnimation( "Io" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Io",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Io",SUBMOT_MOUTH,ANI_M_SMILE,1)
//	ChangeSubAnimation("Io",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr( "Io" , "Meer")
	SetChrInfoFlag( "Io" , INFOFLAG_NOCHRATARI)

	SetFlag(SF_CHARANORECVSHADOW,1)	//キャラ影受けない
	
	//カメラ設定
	MoveCameraAt( 0 , -366.870f , 877.103f , 3.398f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.450f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 5.992f , 0 )	// 基本仰角
	RotateCamera( 0 , 68.372f , 0 )				// 角度
	ChangeCameraPers( 0 , 46.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 3.000, 70.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6202m:SubEV_Past_02_Quest_C_ED")

//開始処理ここまで-----------------------------------------------

	//　　東街区にフェードイン。
	//　　並んだミーアとシーアの前にダーナが立っている。

	StopBGM(90)

	//	ナレーション
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
	{
		"#7Cこうしてダーナはイオとともに"
		"#7Cすっかり待ちくたびれた"
		"#7C子供たちのもとへ戻るのだった。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -366.874f , 877.104f , 2.877f , 65 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.450f , 65 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 9.114f , 65 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 67.958f , 65 )

	//MoveCameraAt( 0 , -366.874f , 877.104f , 2.877f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 3.450f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 9.114f , 0 )	// 基本仰角
	//RotateCamera( 0 , 67.958f , 0 )				// 角度
	//ChangeCameraPers( 0 , 46.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転

	PlayBGM(BGM_6202_M, 0)
	FadeBGM(70,30)
	SetEnvSEPlayState(-1, 1)	//環境SE復帰
	SoundEfx( SEFX_EV_HILL, 15 )

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//　　王都中央区にフェードイン。
	//　　ダーナ、イオ、ミーア、シーアで話している構図。
	//	ミーア
	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6234V#000mあ～あ、あたしがかくれんぼで"
		"まさか完敗するなんて……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Io" , "ANI_EV_RYOTEKOSI_S", -1 , 1 )

	//	イオ
	TalkPopup("Io",0,2,0,0,0)
	{
		"#6235V#021e#080mふふーん、今日は"
		"アタシの完全勝利ってことで。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Meer","Io")

	//	ミーア
	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6236V#012eこ、こうなったら、明日また"
		"勝負を挑ませてもらうんだから！"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadNo("Thea" ,1 , 25 )

	//	シーア
	TalkPopup("Thea",0,1,0,0,0)
	{
		"#6237Vもう、二人とも……\p"
		"#6238Vほんとにほんとに"
		"心配したんだよ！？\p"
		"#6239Vもう少しで衛士隊の人に探して"
		"もらうところだったんだから……！"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Meer", "Thea")
	LookChr("Io", "Thea")
	ChangeSubAnimation("Io",SUBMOT_EYE,ANI_E_SAD_S,1)
	ChangeSubAnimation("Io",SUBMOT_EYE,ANI_E_WAIT,1)

	//	ミーア
	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6240V#051e#000mわわ、分かったってば……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Io" , "ANI_EV_RYOTEKOSI_E", -1 , 1 )

	//	イオ
	TalkPopup("Io",0,2,0,0,0)
	{
		"#6241V#061e#000mごめんごめん、"
		"つい熱くなっちゃってさ。\p"
		"#6242Vまさかここまで"
		"大事になるなんて……"
	}
	WaitPrompt()
	WaitCloseWindow()

	CrossFade(FADE_CROSS)
	LookChr("DANA","Meer")

	MoveCameraAt( 0 , -366.011f , 877.089f , 2.952f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.031f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -1.471f , 0 )	// 基本仰角
	RotateCamera( 0 , 306.941f , 0 )				// 角度
	ChangeCameraPers( 0 , 32.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Wait(FADE_CROSS)

	LookChr("Meer", "DANA")

	ChangeAnimation( "DANA" , "ANI_EV_HOHOKAKI", -1 , 1 )

	//	"DANA"
	TalkPopup("DANA",0,2,0,0,0)
	{
		"#6243V#061e#080mあはは……\p"
		"#6244Vでも心配してくれる人がいるって"
		"とても幸せな事だと思う。\p"
		"#6245V#092eそれを忘れないようにね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Io", "DANA")

	//	イオ
	TalkPopup("Io",0,1,0,0,0)
	{
		"#6246V#012e#000m巫女様……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("Meer")

	//	ミーア
	TalkPopup("Meer",0,1,0,0,0)
	{
		"#6247V#061e#000mはーい……"
	}
	WaitPrompt()
	WaitCloseWindow()


	//	"DANA"
	TalkPopup("DANA",0,2,0,0,0)
	{
		"#6248V#082e#000mミーアちゃんはあまり"
		"シーアちゃんを困らせないこと。\p"
		"#6249Vこれからも仲良くね？"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Meer" , "ANI_EV_TEKOSI_S", -1 , 1 )

	//	ミーア
	TalkPopup("Meer",0,1,0,0,0)
	{
		"#6250V#012eえへへ……わかってるって。\p"
		"#6251Vあたしも今回でこりちゃったし。\p"
		"#6252Vシーアを泣かせるのは"
		"鎮魂祭の怪談話くらいにするからさっ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Thea","Meer")

	//	シーア
	TalkPopup("Thea",0,1,0,0,0)
	{
		"#6253V#061eミ、ミーアちゃあん……！"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Io" , "ANI_EV_TEBURI", -1 , 1 )
	LookChr("Io","Thea")

	//	イオ
	TalkPopup("Io",0,1,0,0,0)
	{
		"#6254V#021e#080mじゃあアタシも"
		"とっておきの話を披露しよっかな。\p"
		"#6255Vむふふ、大昔から伝わるっていう"
		"不死の番人の話なんだけどさぁ～。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	LookChr("Thea","Io")
	ChangeAnimation( "Meer" , "ANI_EV_TEKOSI_E", -1 , 1 )

	TalkPopup("Thea",0,1,0,0,0)
	{
		"#6256V#062eあうぅ……もう２人とも！！"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA" , "ANI_EV_WAIT2_S", -1 , 1 )

	//	"DANA"
	TalkPopup("DANA",0,2,0,0,0)
	{
		"#6257V#061e#080mあ、あははは……"
	}
	WaitPrompt()
	WaitCloseWindow()

	CrossFade(FADE_CROSS)

	MoveCameraAt( 0 , -366.811f , 876.260f , 2.753f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.091f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 11.606f , 0 )	// 基本仰角
	RotateCamera( 0 , 132.058f , 0 )				// 角度
	ChangeCameraPers( 0 , 38.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Wait(FADE_CROSS)

	ChangeSubAnimation("Thea",SUBMOT_EYE,ANI_E_SAD_E,1)
	TurnToChr("Thea","DANA", 8.0f)
	LookChr("Meer","DANA")
	LookChr("Thea","DANA")
	LookChr("Io","DANA")
	
	//　　カメラ切り替えて、改まるミーア。
	//	ミーア
	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6258V巫女様、今日はありがとね。\p"
		"#6259Vそーだ、これを持っていってくれない？\p"
		"#6260Vあたしとシーアで"
		"見つけた宝物なんだ～。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	アイテム入手テキスト
	//「リムの花×３を受け取った。」
	GetItemMessageExPlus(ICON3D_MT_R3_FLOWER, 3, ITEMMSG_SE_JINGLE, "を受け取った。" ,0 ,0 )
	WaitPrompt()
	WaitCloseWindow()

	//　　※報酬未定。現代に持ち帰れるものを想定。

	FadeBGM(70,20)

	ChangeAnimation( "DANA" , "ANI_EV_WAIT2_E", -1 , 1 )

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6261V#000e#000mいいの？　そんなに大事な物を……"
	}
	WaitPrompt()
	WaitCloseWindow()

	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6262V#000e#080mいーのいーの。"
		"ねっ、シーア！"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	// うなずきセット
	HeadYes("Thea" , 1 , 25 )
	ChangeSubAnimation("Thea", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	ChangeSubAnimation("Thea", SUBMOT_EYE, ANI_E_CLOSE_E, 1)

	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6263V#080mはい、２人でさがせば"
		"きっとまた見つかりますから。"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("DANA" , 1 , 25 )

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#6264V#000e#000mそれじゃあ、受け取らせてもらおうかな。\p"
		"#6265Vありがとう、ミーアちゃん、シーアちゃん！"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Thea" , "ANI_EV_REI", -1 , 1 )

	TalkPopup("Thea",0,2,0,0,0)
	{
		"#6266Vえへへ……こちらこそです！\p"
		"#6267V巫女様、本当にお世話になりました！"
	}
	WaitPrompt()
	WaitCloseWindow()

//	PlayVoice(Y8V_5778,"xxx",100)	//あはは


	TalkPopup("Meer",0,2,0,0,0)
	{
		"#6268Vそれじゃ、あたしたちは"
		"お母さんの所に帰るね。\p"
		"#6269Vまたねっ、２人とも！"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Io","Meer")

	//	イオ
	TalkPopup("Io",0,1,0,0,0)
	{
		"#6270V#000e#080mばいばーい！"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　暗転を挟んでカメラをダーナに。
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	PlaySE(SE_QUEST_END, 100, 0, 0, 0, 1.0f, 0)		// クエスト達成	

	//	システムテキスト
	TalkPopup(UNDEF,0,5,0,0,0)
	{
		"#8S "
		"#-1W#4Cエタニアクエスト#8C【双子のかくれんぼ】#4Cを達成した！#10W" 
		"#8S"
	}
	Wait(10)
	CallFunc("system:QuestVoice_Success")
	WaitPrompt()
	WaitCloseWindow()

	LookReset("DANA")
	LookChr("Io" , -20 , -5 )

	SetChrPos("Thea", -100000.0f, 0.0f, ,0.0f)
	SetChrPos("Meer", -100000.0f, 0.0f, ,0.0f)

	PlaySE(SE_VIRTUE, 100, 0, 0, 0, 1.0f, 0)	//徳ポイントアップ

	//	システムテキスト
	TalkPopup(UNDEF,0,5,0,0,0)
	{
		"#8S"
		"#-1W#4Cダーナの徳が上昇した。#10W"
		"#8S"
	}
	Wait(10)
	WaitPrompt()
	WaitCloseWindow()

		// カメラ
	MoveCameraAt( 0 , -365.841f , 877.302f , 3.095f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.520f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 4.467f , 0 )	// 基本仰角
	RotateCamera( 0 , 43.140f , 0 )				// 角度
	ChangeCameraPers( 0 , 39.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()
	
	ChangeAnimation( "DANA" , "ANI_EV_UDEGUMI_S", -1 , 1 )
	
	//　　画面フェードインしてダーナのカメラ。
	TalkPopup("DANA",0,1,0,0,0)
	{
		"#081e#080mふふ、双子の姉妹か。"
		"本当に微笑ましいなあ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("DANA","Io")

	TalkPopup("DANA",0,1,0,0,0)
	{

		"#082e#000mさてと、後はイオちゃんだけど……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　イオ、ダーナに向いてニヤリと企み笑み。
	LookChr("Io" , "DANA")
	ChangeSubAnimation("Io",SUBMOT_EYE,ANI_E_LAUGH_S,1)
	ChangeSubAnimation("Io",SUBMOT_MOUTH,ANI_M_TSMILE_S,1)

	Wait(35)

	//　　ダーナに冷や汗エモーション。
	EmotionEx("DANA", 0.015f,EMO_TARA,0,5,1,1,0.8f )
	Wait(45)

	TalkPopup("DANA",0,1,0,0,0)
	{
		"#000e#000mふう、まっすぐお家に"
		"帰ってくれると助かるけど……\p"
		"よかったら送っていくよ？"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Io" , "ANI_EV_RYOTESIRI_S", -1 , 1 )

	//	イオ
	TalkPopup("Io",0,0,0,0,0)
	{
		"#080mまーまー、そんな年でもないし。"
		"それにね──\p"
		"#022eアタシ、ずっと前から"
		"探している物があるんだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA" , "ANI_EV_UDEGUMI_E", -1 , 1 )

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000m探し物？"
		"私でよければ手伝うよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("Io")

	//	イオ
	TalkPopup("Io",0,0,0,0,0)
	{
		"#010l#000mうーん、いいや。\p"
		"#011eずっと見つからなかったけど……"
		"もうすぐ見つかりそうな気がするし。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000mそ、そうなの？\p"
		"よく判らないけど、日が沈むまで"
		"お家に帰るって約束できる？"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Io", "DANA")
	ChangeAnimation( "Io" , "ANI_EV_RYOTESIRI_E", -1 , 1 )

	//	イオ
	TalkPopup("Io",0,0,0,0,0)
	{
		"#012l#012e#080mはいはい、しますします。\p"
		"多分この辺りを"
		"ブラブラしてるだけだからさ～。\p"
		"そんなに心配しないでよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("DANA" , 1 , 25 )

	//	"DANA"
	TalkPopup("DANA",0,0,0,0,0)
	{
		"#000e#000mうん、それじゃあ約束したからね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("DANA")

	TalkPopup("DANA",0,0,0,0,0)
	{
		"#0L#011e（さてと、そろそろ寺院方面にある"
		"　水晶石に向かわなくちゃ。）\p"
		"（アドルさん……待っててね。）"
	}
	WaitPrompt()
	WaitCloseWindow()

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//終了処理ここから----------------------------------------------------
	CallFunc("mp6202m:SubEV_Past_02_Quest_C_ED")
}
function "SubEV_Past_02_Quest_C_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS ))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	SetFlag(SF_CHARANORECVSHADOW,0)	//キャラ影受ける

	//フラグ立て
	SetFlag( GF_SUBEV_PAST_02_QUEST_C, 1 )		// 過去編Ⅱ：【過去クエスト②Ｃ：達成イベント】を見た
	//SetFlag( SF_MISSIONNO, MS_08_02F )		//★冒険メモ：改めて王都南の橋へ向かおう
	SetFlag(SF_WARP_DISABLED,0)		//ワープ禁止解除

	SetFlag(GF_VIRTURE_POINT,(FLAG[GF_VIRTURE_POINT] + 5 ))			//徳ポイント加算
	EventCue("system:EV_FloorOpen")			//扉が開く予知を視る キューを入れる

	GetItem( ICON3D_MT_R3_FLOWER, 3 )								// 『リムの花×３』
	SetChrPos("Meer" , -100000.00f  , 0.00f ,0.00f )
	SetChrPos("Thea" , -100000.00f  , 0.00f ,0.00f )

	//マーカー
	DelMapMarker( SMI_DANA_SYMBOL ,PAGE_MP6511M, MARKER_SUBEV_PAST02_8, 0,0)			// 過去編Ⅱ：地上へ戻る(迷子クエスト)
	DelMapMarker( SMI_DANA_SYMBOL ,PAGE_MF002, MARKER_SUBEV_PAST02_8, 0,0)		// 過去編Ⅱ：地上へ戻る(迷子クエスト)
	SetMapMarker( SMI_DANA_SYMBOL ,PAGE_MF002, MARKER_EV_M04S191, -354.30f, 820.17f, 12.54f, -354.30f, 820.17f,MARKER_EV_M04S191,MN_F_MP6201M,0)		//メイン：過去Ⅱ ダーナが参道に着く

	CallFunc("mp6202m:init")

	//イベント後の再配置
	SetChrPos("LEADER",-361.05f,886.19f,1.67f)
	Turn("LEADER",25.41f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , -361.046f , 886.192f , 3.539f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 7.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 12.397f , 0 )	// 基本仰角
	RotateCamera( 0 , -147.225f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 900.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	PlayBGM(BGM_6202_M, 0)
	SetEnvSEPlayState(-1, 1)	//環境SE復帰
	SoundEfx( SEFX_HILL, 15 )

	FadeIn(FADE_BLACK, FADE_FAST)
	//WaitFade()

//終了処理ここまで----------------------------------------------------
}

function "SubEV_Past_SpiritE"
{
	//開始処理ここから-----------------------------------------------

	CallFunc("system:event_begin")


	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)
	SetChrPos("DANA",-280.26f,988.24f,1.43f)
	Turn("DANA",-83.42f,360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	ChangeSubAnimation("DANA",SUBMOT_EXT2,ANI_SIGN_HIDE,1)

	//カメラ設定
	MoveCameraAt( 0 , -279.276f , 988.467f , 2.680f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.850f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -5.883f , 0 )	// 基本仰角
	RotateCamera( 0 , 232.093f , 0 )				// 角度
	ChangeCameraPers( 0 , 46.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 900.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 3.000, 70.000, 2.000, 0.950, 0.500)					//イベント毎に調整
	SetDoFFocus(0,0,0)
	
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6202m:SubEV_Past_SpiritE_ED")

	//開始処理ここまで-----------------------------------------------

	FadeBGM(70,30)
	PlaySE(SE_SPIRIT_SAVE_01, 80, 1, 500, 0, 1.0f, 0)

	FadeIn(FADE_BLACK, FADE_FAST)
	WaitFade()

	//──────────────────────────────
	//	【PS4】【精霊救出Ｅ：渦から精霊を救出する】
	//──────────────────────────────
	//　　王都東街区の外れ-277.33f	987.36f	1.43f	-23.07f付近に光る渦がある。
	//　　調べるとイベント起動。
	//選択肢

	SetFlag(TF_MENU_SELECT,0)
	MenuReset()
	MenuType(MENUTYPE_POPUP)
	MenuAdd(1,"淀みを開放する")
	MenuAdd(2,"やめておく")
	MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 1)
	WaitMenu(0)
	MenuClose(10,0)

	if(FLAG[TF_MENU_SELECT] == 1 )
	{
		//────────────────────
		//	⇒淀みを開放する
		//　　下の流れに接続。
		//	⇒やめておく
		//　　操作許可を戻す。
		//────────────────────
		//　　ダーナは指先に理力を纏わせて、光る渦にそっと触れる。
		//　　すると光る渦ははじけて消滅し、
		//　　中から小さな精霊が現れる。

		ChangeAnimation( "DANA" , "ANI_EV_SPIRIT_S", -1 , 1 )
		Wait(15)
		PlaySE(SE_SPIRIT_SAVE_02, 60, 1, 500, 0, 1.0f, 0)
		WaitAnimation2( "DANA" , -1, 1, "ANI_EV_SPIRIT_S",  0)

		ChangeAnimation( "DANA" , "ANI_EV_SPIRIT_E", -1 , 1 )
		StopEffect(106720,ALL,1)
		StopSE(SE_SPIRIT_SAVE_02, 3000)

		CrossFade(15)
		ChangeAnimation( "SubEV_Past_SpiritE" , "ANI_RELEASE", -1 , 1 )
		Wait(90)
		StopSE(SE_SPIRIT_SAVE_01, 1000)
		PlaySE(SE_SPIRIT_SAVE_03, 100, 0, 0, 0, 1.0f, 0)
		WaitAnimation2( "SubEV_Past_SpiritE" , -1, 1, "ANI_RELEASE",  0)

		Wait(15)
		SetChrPos("Pulau",-278.33f,988.05f,1.43f)
		ChangeAnimation( "Pulau" , "ANI_EV_ESCAPE", -1 , 1 )
		Blur(BLUR_TYPE_EXPAND, 0.4f , 10)
		EarthQuake(0.15, 0.15 , 10)
		PlaySE(SE_SPIRIT_SAVE_04, 80, 0, 0, 0, 1.0f, 0)
		Wait(7)
		ChangeAnimation( "DANA" , "ANI_EV_SUP_S", -1 , 1 )
		Wait(30)

		//	精霊
		SetName("精霊")
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"ぷはーっ！！\p"
			"で、で、出られました～っ！"
		}
		WaitPrompt()
		WaitCloseWindow()
		SetName("")

		ChangeAnimation( "DANA" , "ANI_EV_SUP_E", -1 , 1 )

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000mあはは……大変だったみたいだね。\p"
			"でも、どうしてこんな所に？"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	精霊
		SetName("精霊")
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"あ！　どうもこんにちは。"
			"あなたは私が見えるんですね。\p"
			"ふふ、とっても嬉しいです。"
			"もしかしてあなたなら……うふふ！"
		}
		WaitPrompt()
		WaitCloseWindow()
		SetName("")
	
		ChangeAnimation( "DANA" , "ANI_EV_HOHOKAKI", -1 , 1 )

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000mえ、ええと？"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	精霊
		SetName("精霊")

		TalkPopup("Pulau",0,2,0,0,0)
		{
			"ごめんなさい、"
			"つい浮かれてしまって。\p"
			"その、あなたの質問ですけど……"
			"実はどうにも不思議な事があって。\p"
			"……私はしずくの精霊。"
			"名前をプラウといいます。"
		}
		WaitPrompt()
		WaitCloseWindow()
		SetName("")

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"ここからうんと遠く、西の大河で"
			"暮らしているのですが……\p"
			"どういうわけか、この地に"
			"引き寄せられて来たのです。\p"
			"うーん、この力は何なのでしょう……\p"
			"他の精霊はあまり"
			"感じていないようなのですが……"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000m王都に引き寄せられる……"
			"そんな事があるんだ。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"ふふ、でももういいんです。\p"
			"やっと私が見える人に"
			"会えたんですから！"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000mそ、そんなに嬉しかったんだ。\p"
			"あなたはどうやら"
			"人に興味があるみたいだね。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"はい！　その通りです！\p"
			"私思うんです、精霊と人は"
			"もっと手を取り合うべきだって。\p"
			"大昔には精霊の力を借りて"
			"世界の調和を保った人もいます。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//　　精霊にキラキラエモーション。
		EmotionEx("Pulau", 0.00f,EMO_KIRA,0,5,1,1,1.1f )
		Wait(45)

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"私たちも、そういった関わり方を"
			"目指すべきだと思うんです！\p"
			"もちろんその、一足飛びには"
			"無理だと分かっていますけど……\p"
			"ただ、私と友人になってくれる"
			"人がいたらいいなって……"
		}
		WaitPrompt()
		WaitCloseWindow()

		ChangeAnimation( "DANA" , "ANI_EV_RYOTESIRI_S", -1 , 1 )

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000m（ふふっ、精霊にも"
			"　変わった子がいるんだなあ。）"
		}
		WaitPrompt()
		WaitCloseWindow()

		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000mうん、いいよ。"
			"私はダーナ、友達になろう。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"……ありがとう。"
			"ダーナ、あなたはいい人ですね。\p"
			"これは感謝の証です。"
			"どうか受け取ってください。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//　　精霊からエフェクトが放たれ
		//　　ダーナに吸い込まれていく。
		ChangeAnimation( "DANA" , "ANI_EV_RYOTESIRI_E", -1 , 1 )

		PlaySE(SE_SPIRIT_SAVE_05, 70, 1, 1000, 0, 1.0f, 0)
		ChrEffect2( "Pulau" , 106640 , "effect_base","" , 0 , IMPACT_NONE , KNOCK_EFXPOS , 0.0f,0.0f,0, 1.0f, 1.0f)
		Wait(20)
		StopEffect(106640,ALL,1)

		ChrEffect("DANA", 106660, 0.0f , -0.13f , 1.37f, 0, 0, 0 , 0, 1.0f, 0.0f, 0, 1.0f, 1.0f)		//力授かり
		Wait(45)
		StopSE(SE_SPIRIT_SAVE_05, 2000)
		StopEffect(106660,ALL,1)
		Wait(55)

		FadeBGM(25,30)	
		PlaySE( SE_GET_THE_BOX03 , 100 , 0,  0, 0, 1.0f, 0)		//ITEMMSG_SE_JINGLE

		Message("#-1W#4Cダーナに#3Cしずくの精霊プラウ#4Cの力が宿った。#10W")		//（※「息吹の精霊ジンヤ」を色換えしたい）
		Wait(60)
		WaitPrompt()
		WaitCloseWindow()

		PlaySE( SE_HEAL , 100 , 0,  0, 0, 1.0f, 0)
		Message("#-1W#4CダーナのＤＥＦが３０増えた。#10W")
		WaitPrompt()
		WaitCloseWindow()

		FadeBGM(70,30)

		ChangeAnimation( "DANA" , "ANI_EV_TEMUNE_S", -1 , 1 )

		//	"DANA"
		TalkPopup("DANA",0,1,0,0,0)
		{
			"#000e#000m体の隅々までみなぎる、"
			"この感覚は……\p"
			"ありがとう、役立たせてもらうね。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"ふふ、相手があなたなら"
			"私も嬉しいです──"
		}
		WaitPrompt()
		WaitCloseWindow()

		//　　精霊に！エモーション。
		EmotionEx("Pulau", 0.00f,EMO_EX,0,5,1,1,1.0f )
		Wait(40)

		ChangeAnimation( "Pulau" , "ANI_EV_YES", -1 , 1 )

		//　　急に慌てだす。
		//	しずくの精霊プラウ
		TalkPopup("Pulau",0,2,0,0,0)
		{
			"あ、あれ？　この気配は……"
			"もしかして兄さん……？\p"
			"す、すみません。"
			"私隠れなくちゃ……\p"
			"さよなら、ダーナ！"
			"また会いましょうね！"
		}
		WaitPrompt()
		WaitCloseWindow()
		
		ChangeAnimation( "Pulau" , "ANI_EV_LEAVE", -1 , 1 )
		
		Wait(30)
		PlaySE(SE_SPIRIT_SAVE_07, 80, 0, 0, 0, 1.0f, 0)
		Wait(30)
		
		Look("DANA" , 0 ,13)
		
		Wait(40)

		ChangeAnimation( "DANA" , "ANI_EV_TEMUNE_E", -1 , 1 )

		//　　精霊、去っていく。
		//────────────────────
		//	⇒エルドを救出していない
		if(!FLAG[GF_SUBEV_PAST_SPIRITF])
		{
			TalkPopup("DANA",0,1,0,0,0)
			{
				"#000e#000m行っちゃった……"
				"でも“兄さん”って言っていたような。\p"
				"もしかして他にも精霊がいるのかな？"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
		//	⇒救出している
		else
		{
			TalkPopup("DANA",0,1,0,0,0)
			{
				"#000e#000m行っちゃった……"
				"でも“兄さん”って言っていたような。\p"
				"うーん、やっぱりさっき会った"
				"精霊エルドの事なのかも。\p"
				"事情もありそうだけど、とにかく"
				"無事に再会できるといいね。"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
		//────────────────────
		//　　イベント終了、操作許可。

		FadeOut(FADE_BLACK,FADE_NORMAL)
		WaitFade()

		//　　画面暗転。
		PlaySE(SE_QUEST_END, 100, 0, 0, 0, 1.0f, 0)		// クエスト達成	

		//	システムテキスト
		TalkPopup(UNDEF,0,5,0,0,0)
		{
			"#8S "
			"#-1W#4Cしずくの精霊プラウを救出した！#10W" 
			"#8S"
		}
		Wait(10)
		CallFunc("system:QuestVoice_Success")
		WaitPrompt()
		WaitCloseWindow()

		PlaySE(SE_VIRTUE, 100, 0, 0, 0, 1.0f, 0)	//徳ポイントアップ

		//	システムテキスト
		TalkPopup(UNDEF,0,5,0,0,0)
		{
			"#8S"
			"#-1W#4Cダーナの徳が上昇した。#10W"
			"#8S"
		}
		Wait(10)
		WaitPrompt()
		WaitCloseWindow()
	}

	StopSE(SE_SPIRIT_SAVE_01, 1000)

	// フェードアウト
	FadeOut(FADE_BLACK, FADE_FAST)
	WaitFade()

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6202m:SubEV_Past_SpiritE_ED")
}

function "SubEV_Past_SpiritE_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_DANA")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	SetChrPos("Pulau",-100000.00f,0.00f,0.00f)

	if(FLAG[TF_MENU_SELECT] == 1 )
	{
		//フラグ処理
		SetFlag(GF_SUBEV_PAST_SPIRITE, 1)			// 過去編Ⅳ：【精霊救出Ｅ：渦から精霊を救出する】を見た
		SetFlag(GF_TROPHY_ETERNIASPIRIT_05,1)		//精霊救出率カウント
		SetFlag(GF_VIRTURE_POINT,(FLAG[GF_VIRTURE_POINT] + 5 ))			//徳ポイント加算
		EventCue("system:EV_FloorOpen")			//扉が開く予知を視る キューを入れる
		CallFunc("system:Get_DanaSpirit")		//「全てのエタニアの精霊を救出した。」トロフィー判定用

		SetChrWork("DANA",CWK_SUP_DEF,(DANA.CHRWORK[CWK_SUP_DEF] + 30))		//精霊の力

		CallFunc("system:SetMarkerDANA")	//クエスト系マーカー処理

		CallFunc("mp6202m:init")
	}
	
	//イベント後の再配置
	SetChrPos("LEADER",-281.25f,990.13f,1.43f)
	Turn("LEADER",118.99f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , -281.255f , 990.132f , 3.308f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 6.284f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 17.215f , 0 )	// 基本仰角
	RotateCamera( 0 , 83.650f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 900.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK, FADE_FAST)
	//WaitFade()

	//終了処理ここまで----------------------------------------------------

}

