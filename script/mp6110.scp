#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"
#include "inc/music.h"
#include "inc/efx.h"
#include "inc/temp/mp6110.h"

//----------------------------------------------------------------------------//
//                                                                            //
// 塔前の野営地	    			                                              //
//                                                                            //
//----------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
// 初期化スクリプト
///////////////////////////////////////////////////////////////////////////////
//-------------------------------------------

function "init"
{
	//遠景不必要ノード削除◆マップ作業者用
	MapHide( "@BG2_mp6104_2" , 0 )
	MapHide( "@BG2_mp6110" , 0 )

	// イベントエリア設定制御
	EventAreaEnable("evb2_M05S060", 0)

	// マップノード
	MapAnime("gim04", "close")
	MapAnime("camp_all", off)	//キャンプ未設置
//	SetChrPos("LP_tent", -100000.00f, 0.00f, 0.00f)	//キャンプLP消す
//	SetChrPos("LP_cook", -100000.00f, 0.00f, 0.00f)	//料理LP消す

	if (FLAG[SF_EVENT_ON]){
		// イベント発生制御
		if (FLAG[GF_05MP6110_OUT_CAMP]) {				// ▼[M05S092][塔前の野営地を出発する]
			MapAnime("camp_all", on)	//キャンプ
			MapHide("@camp_fire", 0)	//火消す
			MapHide("@camp_smoke", 0)
			
			SetEnvSEPlayState(6110101, 1)
			// ＬＰ制御
			//SetChrPos("LP_SubEV_Past_03_Rearrive", -98.818f , 1409.762f , 79.04f)	// 過去編Ⅲ：【過去編Ⅲ：水晶石を調べて再訪する】
			//SetChrWork( "LP_SubEV_Past_03_Rearrive" , CWK_CHECKRADIUS , 2.5f )		// 範囲
		}
		if (FLAG[GF_05MP6115_SEE_HOLLOW] 			// ▼[M05S050][ダーナが頭痛に見舞われる]
			&& !FLAG[GF_05MP6201M_GOTO_BAHA]) {	// ▽ [M05S072][過去Ⅲ　ダーナが塔へ向かう３]
				//EventAreaEnable("evb2_M05S060", 1)
		}
		if (FLAG[GF_05MP6201M_GOTO_BAHA]){			// ▼ [M05S072][過去Ⅲ　ダーナが塔へ向かう３]
			MapAnime("gim04", "open")
		}

		// マップノード・アニメ
		// -----------------------------------------------------------------
		// 過去編ギミック_ヒモロギの樹開拓ルート_王宮側
		// ※王宮が復活すると、遠景で見えている箇所は全て以下の対応が必要となります
		// -----------------------------------------------------------------
		if( FLAG[GF_05MP6204_APPEAR_CASTLE] )	//消滅した王宮が復活する
		{
			MapAnime("gim03" , "open" )		//ヒモロギの樹
		}
		else
		{
			MapAnime("gim03" , "close" )	//ヒモロギの樹
		}

		MapAnime("mistSphere", "off")	// 霧のマユ
		if( FLAG[GF_TBOX_DUMMY087]				// ▼[M06S020][調査のためジャンダルムへ向かう]
			&& !FLAG[GF_06MP4109_CLEAR_MIST] )		// ▽[M06S111][山門の霧を突破する２]
		{
			MapAnime("mistSphere", "on")	// 霧のマユ
		}
	}

	//マップ名表示
	if(!FLAG[SF_LOADINIT] && !FLAG[GF_MPxxxx_MAP_NAME_NO_DRAW] && !FLAG[TF_MAPNAME_SHOWN]){
		if( FLAG[SF_LASTENTRY_NO] == 1 || FLAG[SF_LASTENTRY_NO] == 100 ){
			VisualName("visual/mapname/mn_6103.itp",VN_NAMEMAP2,-1,-1,VN_MAPNAME_TIME)//トワル街道
			SetFlag( TF_MAPNAME_SHOWN, 1 )				// 地名表示した（テンポラリ）
		}
	}
}

function "LP_tent"
{

	SetStopFlag(STOPFLAG_SIMPLEEVENT2)

	ResetMotion( "ALL" , 1 )
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	YesNoMenu(TF_MENU_SELECT, "野営地のテントで休みますか？", 0)
	WaitMenu(0)
	
	if (FLAG[TF_MENU_SELECT] == 1)
	{
		SetWork(WK_BGMLIMIT, 1)
		FadeOut(FADE_BLACK,FADE_NORMAL)
		WaitFade()

		SaveCamera()

		SetEnvSEPlayState(6110001, 0)
		SetEnvSEPlayState(6110002, 0)
		SetEnvSEPlayState(6110101, 0)
		PlaySE(SE_ENV_FOREST_4, 20, 1, 1000, 0, 1.0f, 0)	//夜の虫
	
		//寝言
		CallFunc("system:TentVoice_Sleep")

		SetEnvSEPlayState(-1, 0)	//環境SE全停止	
		PlaySE( SE_HOTEL_JINGLE , 100 , 0,  0, 0, 1.0f, 0)	//ジングル
		StopSE(SE_ENV_FOREST_4, 2000)	//虫の音止める
		Wait(120)

		//テント回復処理・リトライセーブ
		CallFunc("system:camp_rest")
	
		PlaySE(SE_HEAL, 100, 0, 0, 0, 1.0f, 0)

		TalkPopup(UNDEF,0,5,0,0,0)
		{
			"#8S"
			"#-1W#4C全員のＨＰ、ＳＰとＥＸＴＲＡゲージが全快した！#10W" 
			"#8S"
		}
		Wait(10)
		WaitPrompt()
		WaitCloseWindow()
	
		Wait(15)

		SetChrPos("LEADER",-103.34f,1415.61f,78.47f)
		Turn("LEADER",59.37f,360.0f)

		ResetPartyPos()
		ResetFollowPoint()
		//Wait(1) //処理待ち用
	
		RestoreCamera(0,0)
		CallFunc("system:camera_reset")
	
		ResetStopFlag(STOPFLAG_SIMPLEEVENT2)

		SetEnvSEPlayState(-1, 1)	//環境SE復帰

		SetWork(WK_BGMLIMIT, 0) 	
		FadeIn(FADE_BLACK,FADE_FAST)
		//WaitFade()

	} else {
		ResetStopFlag(STOPFLAG_SIMPLEEVENT2)

	}

}


////////////////////////////////////////////////////////////////////////////////

//■メインイベントセクション

////////////////////////////////////////////////////////////////////////////////
//──────────────────────────────
//▼バハの塔前で水晶石を見つける(mp6110)
//──────────────────────────────
function "EV_M05S060"			//バハの塔前で水晶石を見つける
{
	//開始処理ここから-----------------------------------------------
	CallFunc("system:event_begin")	//EB開始処理

	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL", -106.84f, 1424.32f, 78.46f)
	Turn("ADOL", -1.99f, 360.0f)
	ChangeAnimation("ADOL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("ADOL")
	SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA", -108.92f, 1424.64f, 78.46f)
	Turn("RICOTTA", -12.96f, 360.0f)
	ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("RICOTTA")
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD", -108.60f, 1425.90f, 78.44f)
	Turn("SAHAD", -3.43f, 360.0f)
	ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("SAHAD")
	SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA", -105.85f, 1425.16f, 78.46f)
	Turn("LAXIA", -7.51f, 360.0f)
	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("LAXIA")
	SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL", -106.60f, 1426.34f, 78.45f)
	Turn("HUMMEL", -3.43f, 360.0f)
	ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("HUMMEL")
	SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA", -107.91f, 1424.81f, 78.46f)
	Turn("DANA", -3.65f, 360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	DestroyObj(-107.919f , 1409.036f , 77.668f , 2.5f , 0, 0, 0 )
	
	//エフェクトロード
	LoadEffect( "efx_ev05.ite" )

	// ポートレート読み込み
	Portrait_Load(0, "system/black.itp" )		//擬似フェードアウト用
	Portrait_Create(0, 0, 0, 0, 0, 64,64, 0.0f, 0x00ffffff, 0x00000000)

	//カメラ設定
	MoveCameraAt( 0 , -107.102f , 1422.412f , 80.381f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.299f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 4.879f , 0 )	// 基本仰角
	RotateCamera( 0 , 176.246f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 400.000, 0.000, 0.150, 0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6110:EV_M05S060_ED")

	//開始処理ここまで-----------------------------------------------

	//　　野営地付近に近づいたところでイベント開始。

	// カット1 ----------------------------------------------------------------------------------------

	//　　カメラスクロールさせつつ、塔入口前に
	//　　覆いかぶさった異質な岩(隕石)を見せていく。

	// 移動
	ExecuteCmd(1, MoveTo, "ADOL", -106.32f, 1412.36f, 78.42f, 0.1f, 0.18f)
	ExecuteCmd(2, MoveTo, "DANA", -107.40f, 1412.82f, 78.38f, 0.1f, 0.18f)
	Wait(3)
	ExecuteCmd(3, MoveTo, "LAXIA", -105.34f, 1413.17f, 78.47f, 0.1f, 0.18f)
	Wait(3)
	ExecuteCmd(4, MoveTo, "RICOTTA", -108.43f, 1413.07f, 78.47f, 0.1f, 0.18f)
	Wait(3)
	ExecuteCmd(5, MoveTo, "SAHAD", -107.87f, 1414.15f, 78.47f, 0.1f, 0.18f)
	ExecuteCmd(6, MoveTo, "HUMMEL", -106.08f, 1414.35f, 78.47f, 0.1f, 0.18f)

	// カメラ移動（アドルたち背後から隕石と塔を見せる構図）
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,-117.456f , 1376.974f , 85.096f , 160 )		// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 20.898f , 160 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -13.064f , 160 )		// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 307.372f , 160 )		// 角度
	ExecuteCmd(1004, ChangeCameraPers, INTERPOLATE_SPHERE , 70.000f , 160 )		// 視野角
	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , 9.2f , 160 )		// ロール回転

	// フェードイン
	FadeIn(FADE_BLACK, FADE_NORMAL)
	WaitFade()

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	
	Wait(10)
	
	// カメラ移動（隕石をゆっくり見せていく）
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -116.564f , 1359.664f , 45.203f , 120 )		// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 20.898f , 120 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE ,  -23.663f , 120)		// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 287.318f , 120 )		// 角度
	ExecuteCmd(1004, ChangeCameraPers, INTERPOLATE_SPHERE , 70.000f , 120 )		// 視野角
	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , -2.0f , 120 )		// ロール回転
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	
	Wait(20)
	
	// カット2 ----------------------------------------------------------------------------------------

	//　　カメラ切り替えて、断崖上のアドルたちを映す。

	// クロスフェード
	CrossFade(FADE_NORMAL)
	
	// 移動停止
	WaitThread(1)
	WaitThread(2)
	WaitThread(3)
	WaitThread(4)
	WaitThread(5)
	WaitThread(6)

	// カメラ
	MoveCameraAt( 0 , -108.039f , 1407.705f , 79.746f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.917f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 0.725f , 0 )	// 基本仰角
	RotateCamera( 0 , 234.109f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.3f , 0 )				// ロール回転

	SetDoF(0, LERP_LINEAR, 5.000, 180.000, 2.000, 0.500, 0.500)	// 被写界震度

	// 位置調整・表情・モーション
	SetChrPos("ADOL", -107.62f, 1407.92f, 77.72f)
	Turn("ADOL", -41.58f, 360.0f)
	SetChrPos("DANA", -107.11f, 1408.67f, 77.81f)
	Turn("DANA", -45.07f, 360.0f)
	SetChrPos("LAXIA", -108.72f, 1408.34f, 77.80f)
	Turn("LAXIA", -37.97f, 360.0f)
	SetChrPos("SAHAD", -109.55f, 1407.26f, 77.68f)
	Turn("SAHAD", -71.05f, 360.0f)
	SetChrPos("RICOTTA", -108.46f, 1407.40f, 77.67f)
	Turn("RICOTTA", -52.17f, 360.0f)
	SetChrPos("HUMMEL", -107.98f, 1409.40f, 77.93f)
	Turn("HUMMEL", -38.02f, 360.0f)
	
	LookTo("ADOL", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("DANA", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("LAXIA", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("SAHAD", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("RICOTTA", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("HUMMEL", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -107.993f , 1407.774f , 79.406f , 50 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.677f , 50 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 1.298f , 50 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 224.081f , 50 )
	
	// フェード待ち
	Wait(FADE_NORMAL)
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	
	ChangeAnimation( "HUMMEL", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組
	PlayVoice(Y8V_2168,"HUMMEL",100)	//さて（平常のテンション。あらゆる場面で使用）
	Wait(15)
	
	// ヒュンメル
	TalkPopup("HUMMEL", 0, 1, 0, 0, 0) {
		"#000e#000m塔の前まで来たはいいが、"
		"あの岩は一体……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// 両手腰

	// サハド
	TalkPopup("SAHAD", 0, 1, 0, 0, 0) {
		"#000e#000mずいぶんとデカいな……\p"
		"ありゃあ、漂流者全員でも"
		"どかすのは難しいんじゃないか？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -108.233f , 1407.508f , 79.206f , 160 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 2.717f , 160 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.736f , 160 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 236.683f , 160 )

	//　　ラクシャ、大きな岩(隕石)を見やりつつ、
	//　　「…」エモーション表示。
	EmotionEx("LAXIA", 0.00f, EMO_3DOT, 0, 5, 1, 1, 1.0f)	//…
	ChangeAnimation( "LAXIA", "ANI_EV_SIAN_S", -1, 1 )	// 思案
	Wait(45)
	
	LookChr("RICOTTA", "LAXIA")
	TurnToChr("RICOTTA", "LAXIA", 6.0f)
	Wait(5)
	LookRoll("RICOTTA", 10.0f)	// かしげる
	
	// リコッタ
	TalkPopup("RICOTTA", 0, 2, 0, 0, 0) {
		"#000e#000mラクシャ姉、ハラでも減ったか？"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookRoll("RICOTTA", 0.0f)	// かしげる戻す

	LookChr("LAXIA", "RICOTTA")
	ChangeAnimation( "LAXIA", "ANI_EV_SIAN_E", -1, 1 )	// 思案

	// ラクシャ
	TalkPopup("LAXIA", 0, 1, 0, 0, 0) {
		"#060e#000mそ、そうではなくて……\p"
		"#000e#000mリコッタちゃん、あの岩……"
		"何となく違和感がありませんか？"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookTo("RICOTTA", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	Turn("RICOTTA", -52.17f, 7.0f)
	ChangeAnimation( "RICOTTA", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組
	PlayVoice(Y8V_2562,"RICOTTA",100)	//んー（平常のテンション。あらゆる場面で使用）
	WaitAnimation2( "RICOTTA" , -1, 1, "ANI_EV_UDEGUMI_S",  0)

	//　　リコッタにPAエモーション表示。
	EmotionEx("RICOTTA", 0.08f, EMO_PA, 0, 5, 1, 1, 0.9f)	//パッ
	Wait(35)
	ChangeAnimation( "RICOTTA", "ANI_EV_UDEGUMI_E", -1, 1 )	// 腕組

	// リコッタ
	TalkPopup("RICOTTA", 0, 2, 0, 0, 0) {
		"#000e#000m確かに……"
		"周りの岩と違う。\p"
		"色、カタチ、確かにヘンかも……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_E", -1, 1 )	// 両手腰
	LookChr("SAHAD", "RICOTTA")

	// サハド
	TalkPopup("SAHAD", 0, 1, 0, 0, 0) {
		"#000e#000mそりゃそうだが、それより"
		"今は塔に入る方法を考えねーとな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット3 ----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_FAST)

	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	// カメラ
	MoveCameraAt( 0 , -106.779f , 1408.130f , 79.286f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 0.997f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -0.467f , 0 )	// 基本仰角
	RotateCamera( 0 , 102.179f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.3f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 位置調整・表情・モーション
	LookTo("LAXIA", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	LookTo("SAHAD", -98.175f , 1396.054f , 79.406f)	// 座標：隕石
	ChangeAnimation("DANA", "ANI_EV_ZUTUU", -1, 1)	// 頭痛
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_SAD_CLOSE, 1)	// 目

	// カメラ移動（水平）
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -106.802f , 1408.330f , 79.286f, 130 )
	
	// フェード待ち
	Wait(FADE_FAST)

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#060e#000m#0L………………………………"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ダーナ、軽く頭を押さえつつ(隕石見て軽い頭痛)
	//　　何かに気づいてＰＡエモーション表示。

	LookSpd("DANA", 0.08f, 0.08f, 0.08f )// ゆっくりめに首向き
	Look("DANA", -10.0f, 5.0f)	// （＾＾）↑→
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_SAD_CLOSE_E, 1)	// 目x
	ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKL_S,1)
	EmotionEx("DANA", 0.00f, EMO_PA, 0, 5, 1, 1, 1.0f)	//パッ
	Wait(35)

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"アドルさん、あれを……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　画面スクロールして水晶石を見せる。

	//　　共鳴音と連動するように水晶石が明滅しているのを映す。
	Effect2(3900500, -99.165f , 1409.866f , 78.590f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.0f)

	Wait(10)
	
	CrossFade(FADE_FAST)

	StopThread(1000)

	MoveCameraAt( 0 , -105.540f , 1408.271f , 79.112f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.066f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -9.762f , 0 )	// 基本仰角
	RotateCamera( 0 , 313.179f , 0 )				// 角度
	ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.3f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	PlaySE(SE_M05S060_06, 50, 1, 4000, 0, 1.0f, 0)		

	Wait(FADE_FAST)

	LookChr("ADOL", "chkpt")
	TurnToChr("ADOL", "chkpt", 6.0f)
	Wait(90)
	
	// フェードアウト
	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()

	// カット4 ----------------------------------------------------------------------------------------

	//　　一旦フェードアウトしてキャラ再配置。
	//　　水晶石を囲んでいるアドルたち。

	// カメラ
	MoveCameraAt( 0 , -98.964f , 1409.906f , 80.414f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.761f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 3.932f , 0 )	// 基本仰角
	RotateCamera( 0 , 266.603f , 0 )				// 角度
	ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	// 位置調整・表情・モーション
	SetChrPos("ADOL", -100.67f, 1409.70f, 78.47f)
	Turn("ADOL", -98.77f, 360.0f)
	SetChrPos("DANA", -100.50f, 1410.57f, 78.47f)
	Turn("DANA", -70.37f, 360.0f)
	SetChrPos("LAXIA", -99.85f, 1411.29f, 78.47f)
	Turn("LAXIA", -29.53f, 360.0f)
	SetChrPos("SAHAD", -99.97f, 1408.22f, 78.30f)
	Turn("SAHAD", -141.89f, 360.0f)
	SetChrPos("RICOTTA", -101.07f, 1409.04f, 78.47f)
	Turn("RICOTTA", -121.66f, 360.0f)
	SetChrPos("HUMMEL", -99.25f, 1411.78f, 78.47f)
	Turn("HUMMEL", 11.06f, 360.0f)
	ChangeAnimation( "DANA", "ANI_WAIT", -1, 1 )	// 待機
	ChangeAnimation( "SAHAD", "ANI_WAIT", -1, 1 )	// 待機
	ChangeAnimation( "RICOTTA", "ANI_WAIT", -1, 1 )	// 待機
	ChangeAnimation( "HUMMEL", "ANI_WAIT", -1, 1 )	// 待機
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)	// 目
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)	// 目

	LookTo("ADOL", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	LookTo("DANA", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	LookTo("LAXIA", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	LookTo("SAHAD", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	LookTo("RICOTTA", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	LookTo("HUMMEL", -98.818f , 1409.762f , 80.054f)	// 座標：水晶石
	
	Wait(30)	// 暗転時間

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -98.964f , 1409.906f , 79.794f , 80 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.761f , 80 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 7.370f , 80 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 241.678f , 80 )

	PlayBGM(BGM_EVENT_013, 0)

	// フェードイン
	FadeIn(FADE_BLACK, FADE_NORMAL)
	WaitFade()

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	ChangeAnimation( "HUMMEL", "ANI_EV_SIAN_S", -1, 1 )	// 思案
	// ヒュンメル
	TalkPopup("HUMMEL", 0, 2, 0, 0, 0) {
		"#000e#000mこれは例の水晶石か。"
		"ならば……"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("DANA", 1, 25)	// キャラ, うなずき回数, 速さ

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#000e#000mうん、アドルさん。"
		"過去を視ることができるはずだよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)

	// カット5 ----------------------------------------------------------------------------------------

	//　　アドルが水晶石に手をかざして集中すると、
	//　　その隣に寄り添って一緒に手をかざすダーナ。

	// クロスフェード
	CrossFade(FADE_FAST)
	
	// カメラ
	MoveCameraAt( 0 , -99.572f , 1410.381f , 79.874f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.423f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.392f , 0 )	// 基本仰角
	RotateCamera( 0 , 29.512f , 0 )				// 角度
	ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 位置調整・表情・モーション
	LookReset("ADOL")
	LookReset("DANA")
	ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)

	DestroyObj(-107.919f , 1409.036f , 77.668f , 2.5f , 0, 0, 0 )

	DestroyObj(-103.992f , 1410.320f , 78.521f , 3.5f , 0, 0, 0 )

		
	// カメラ移動（いいシーンなのでロール回転も使用）
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -99.645f , 1410.348f , 80.034f, 120 )		// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.943f , 120 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE ,  5.688f , 120 )		// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 24.928f , 120 )		// 角度
	ExecuteCmd(1004, ChangeCameraPers, INTERPOLATE_SPHERE , 35.000f, 120 )		// 視野角
	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , -2.6f , 120 )		// ロール回転
	
	// 移動
	ExecuteCmd(1, MoveTo, "ADOL", -99.91f, 1409.74f, 78.46f, 0.1f, 0.10f)
	
	// フェード待ち
	Wait(FADE_FAST)

	// 移動待ち
	WaitThread(1)
	
	ChangeAnimation("ADOL", "ANI_EV_KAZASU_S", -1, 1)		// 手をかざす
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	
	// 水晶石と交信エフェクト
	Effect2(3900530, -99.165f , 1409.866f , 79.884f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.5f, 1.0f)
	PlaySE(SE_M05S060_01, 80, 1, 1000, 0, 1.0f, 0)
	StopSE(SE_M05S060_06, 2000)
	
	Wait(15)

	// 移動
	ExecuteCmd(2, MoveTo, "DANA", -99.84f, 1410.42f, 78.47f, 0.1f, 0.10f)

	// 移動待ち
	WaitThread(2)

	ChangeAnimation("DANA", "ANI_EV_KAZASU_S", -1, 1)
	WaitAnimation2( "DANA" , -1, 1, "ANI_EV_KAZASU_S",  0)

	LookChr("LAXIA", "DANA")
	
	//　　ラクシャにＰＡエモーション。
	EmotionEx("LAXIA", 0.00f, EMO_PA, 0, 5, 1, 1, 1.2f)	//パッ
	Wait(35)

	// ラクシャ
	TalkPopup("LAXIA", 0, 2, 0, 0, 0) {
		"#071e#000mダーナさん、何を……？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#011e#000m……水晶石の理力を増幅するね。\p"
		"水晶石2行目"
		"#012e#000mアドルさんが視るものを"
		"私たち全員が共有できるはずだよ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット6 ----------------------------------------------------------------------------------------

	//　　ダーナ、目を閉じて理力エフェクトをまとう。
	
	// クロスフェード
	CrossFade(FADE_CROSS)
	
	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	
	// カメラ
	MoveCameraAt( 0 , -99.673f , 1410.046f , 79.834f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.943f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 2.439f , 0 )	// 基本仰角
	RotateCamera( 0 , 132.890f , 0 )				// 角度
	ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
	
	// 位置調整・表情・モーション
	SetChrPos("DANA", -99.85f, 1410.45f, 78.47f)
	Turn("DANA", -52.26f, 360.0f)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,-99.629f , 1410.006f , 80.014f, 120 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.903f , 120 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.441f , 120 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 141.495f , 120 )
	
	// フェード待ち
	Wait(FADE_CROSS)
	
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	ChrEffect2( "DANA" , 3900600 , "Bone_root", "", 0 , 0 , 0 , 0.0f,0.0f,0, 1.0f, 1.0f)	// 理力オーラ（ループ）
	PlaySE(SE_M05S060_05, 70, 0, 0, 0, 1.0f, 0)
	Wait(30)

	Wait(10)
	PlayVoice(Y8V_1414,"SAHAD",100)	//お？（疑問）

	// サハド
	TalkPopup("SAHAD", 0, 2, 0, 0, 0) {
		"#000e#000mお？　そんなことができるのか。"
	}
	WaitPrompt()
	WaitCloseWindow()

	PlayVoice(Y8V_2564,"RICOTTA",100)	//なはは（楽しそうに）

	// リコッタ
	TalkPopup("RICOTTA", 0, 2, 0, 0, 0) {
		"#021e#080mなはは、楽しみー！"
	}
	WaitPrompt()
	WaitCloseWindow()

//	EarthQuake(0.01f, 0.01f, 5)

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#18S行くよ……！"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	// カット7 ----------------------------------------------------------------------------------------

	//　　水晶石の光が強く変化するのを見せる。
	//　　過去編の遷移エフェクト表示して画面ホワイトアウト。

	// クロスフェード
	CrossFade(FADE_NORMAL)
	
	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	// カメラ
	MoveCameraAt( 0 , -99.220f , 1409.904f , 79.088f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.340f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 2.337f , 0 )	// 基本仰角
	RotateCamera( 0 , 214.410f , 0 )				// 角度
	ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 1.4f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 位置調整・表情・モーション
	SetChrPos("RICOTTA", -100.63f, 1409.27f, 78.46f)
	Turn("RICOTTA", -114.55f, 360.0f)
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -99.149f , 1409.720f , 79.914f , 300 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  6.764f , 300 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 5.590f , 300 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 297.604f , 300 )

	EarthQuake( 0.01f , 0.01f , 300 )	// 縦揺れ幅, 横揺れ幅, 時間

	Effect2(3900570, -98.575f , 1409.608f , 78.090f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.0f)	// 過去に飛ぶ時の画面切り替えエフェクト
	PlaySE(SE_M05S060_04, 30, 1, 4000, 0, 1.0f, 0)

	// フェード待ち
	Wait(FADE_NORMAL)

	Effect2(3900510, -99.165f , 1409.866f , 78.590f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.0f)	// 水晶石の輝きが強まる。3900500とセット（ループ）
//	PlaySE(SE_M05S060_02, 100, 0, 0, 0, 1.0f, 0)

//	Wait(180)
	Wait(60)
	PlaySE(SE_M05S060_02, 80, 0, 0, 0, 1.0f, 0)
	Wait(60)
	PlaySE(SE_M05S060_02, 80, 0, 0, 0, 1.0f, 0)
	Wait(60)
	PlaySE(SE_M05S060_02, 80, 0, 0, 0, 1.0f, 0)

	StopBGM(120)

	PlaySE(SE_M05S060_03, 100, 0, 0, 0, 1.0f, 0)
	SetEnvSEPlayState(-1, 0)	//環境SE全停止
	StopSE(SE_M05S060_01, 2000)
	StopSE(SE_M05S060_04, 2000)

	// フェードアウト
	FadeOut(FADE_WHITE, FADE_SLOW)
	WaitFade()
	
	Wait(60)
	
	// 擬似フェードアウト表示
	Portrait_Anime(0 ,PR_ANIME_SCALE, 30.0f, 17.0f, 0, 0, 0)
	Portrait_Anime(0 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 1.0f, 0)

	// フェードイン
	FadeIn(FADE_WHITE, FADE_NORMAL)
	WaitFade()

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6110:EV_M05S060_ED")
}

function "EV_M05S060_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	//ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//CallFunc("mp6110:init")

	//マーカー
	DelMapMarker( SMI_SYMBOL ,PAGE_F035, MARKER_EV_M05S060, 0,0)		//メイン：バハの塔前で水晶石を見つける

	// ポートレートリリース
	Portrait_Close(-1)
	Portrait_Unload(-1)

	//エフェクトリリース
	ReleaseEffect("efx_ev05.ite")

	// エフェクト停止
	StopEffect(-1, ALL, 1)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	StopBGM(30)

	//CallFunc("system:camera_reset")
	LoadArg("map/mp6216m/mp6216m.arg")
	EventCue("mp6216m:EV_M05S070")

	ResetStopFlag(STOPFLAG_EVENT)


	//終了処理ここまで----------------------------------------------------
}

//──────────────────────────────
//▼塔前の地割れに橋が架かる(mp6110)
//──────────────────────────────
function "EV_M05S090"			//塔前の地割れに橋が架かる
{

	//開始処理ここから-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL", -100.00f, 1409.74f, 78.46f)
	Turn("ADOL", -105.88f, 360.0f)
	ChangeAnimation("ADOL", "ANI_EV_KAZASU", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("ADOL")
	SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA", -101.47f, 1409.85f, 78.47f)
	Turn("RICOTTA", -111.00f, 360.0f)
	ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("RICOTTA")
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD", -100.21f, 1408.74f, 78.37f)
	Turn("SAHAD", -141.89f, 360.0f)
	ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("SAHAD")
	SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA", -100.53f, 1411.04f, 78.47f)
	Turn("LAXIA", -72.17f, 360.0f)
	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("LAXIA")
	SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL", -100.78f, 1411.70f, 78.47f)
	Turn("HUMMEL", -56.45f, 360.0f)
	ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("HUMMEL")
	SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA", -100.05f, 1410.44f, 78.47f)
	Turn("DANA", -77.48f, 360.0f)
	ChangeAnimation("DANA", "ANI_EV_KAZASU", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)


	//カメラ設定
	MoveCameraAt( 0 , -98.973f , 1411.539f , 80.253f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.099f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 16.383f , 0 )	// 基本仰角
	RotateCamera( 0 , 151.420f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 5000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Portrait_Load(0, "system/black.itp" )		//擬似フェードアウト用（黒）
	Portrait_Create(0, 0, 0, 0, 0, 64,64, 0.0f, 0x00ffffff, 0x00000000)
	Portrait_Load(1, "system/white.itp" )		//擬似フェードアウト用（白）
	Portrait_Create(1, 0, 0, 0, 0, 64,64, 0.0f, 0x00ffffff, 0x00000000)

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 200.000, 0.000, 0.450, 0.620)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6110:EV_M05S090_ED")

	//開始処理ここまで-----------------------------------------------

	//　　過去⇔現在遷移エフェクト表示して画面フェードイン。
	//　　マップはすでに夕方になっており、
	//　　ラクシャが気にしていた岩がヒモロギの木によって
	//　　吊り上げられ、橋になっている光景を映し出す。
	
	// カット1 ----------------------------------------------------------------------------------------

	PlaySE(SE_M05S090_01, 100, 0, 0, 0, 1.0f, 0)

	// 擬似フェードアウト（黒）表示
	Portrait_Anime(0 ,PR_ANIME_SCALE, 30.0f, 17.0f, 0, 0, 0)
	Portrait_Anime(0 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 1.0f, 0)

	FadeIn(FADE_BLACK, 0)
	WaitFade()

	// フェードアウト
	FadeOut(FADE_WHITE, FADE_NORMAL)
	WaitFade()

	Portrait_Anime(0 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 0.0f, 0)

	// 擬似フェードアウト（白）表示
	Portrait_Anime(1 ,PR_ANIME_SCALE, 30.0f, 17.0f, 0, 0, 0)
	Portrait_Anime(1 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 1.0f, 0)

	FadeIn(FADE_WHITE, 0)
	WaitFade()

	Effect2( 3900585, -98.575f , 1409.608f , 78.090f, 90.00f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.5f)	// 過去から帰還のエフェクト
	PlaySE(SE_M05S090_03, 100, 1, 2000, 0, 1.0f, 0)

	// 位置調整・表情・モーション
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_CLOSE, 1)	// 目

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -99.503f , 1411.317f , 79.893f , 150 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 2.479f , 150 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 2.631f , 150 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 134.801f , 150 )

	SetEnvSEPlayState(-1, 1)	//環境SE

	// 擬似フェードアウト削除
	Portrait_Anime(1 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 0.0f, FADE_SLOW)
	Wait(30)
	PlaySE(SE_M05S090_02, 80, 0, 0, 0, 1.0f, 0)
	Wait(30)
	StopSE(SE_M05S090_03, 3000)

	PlaySE(SE_M05S090_02, 80, 0, 0, 0, 1.0f, 0)
	Wait(30)
	PlaySE(SE_M05S090_02, 80, 0, 0, 0, 1.0f, 0)


	Wait(30)

	ChangeAnimation("ADOL", "ANI_EV_KAZASU_E", -1, 1)
	ChangeAnimation("DANA", "ANI_EV_KAZASU_E", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_E, 1)	// 目
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE_E, 1)	// 目

	Wait(40)

	// カット2 ----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_FAST)
	
	// カメラ
	MoveCameraAt( 0 , -116.080f , 1429.323f , 129.750f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 8.880f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -11.049f , 0 )	// 基本仰角
	RotateCamera( 0 , 288.233f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 5000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 位置調整・表情・モーション
	SetChrPos("ADOL", -102.59f, 1407.93f, 78.34f)
	Turn("ADOL", -41.93f, 360.0f)
	SetChrPos("DANA", -101.78f, 1408.37f, 78.45f)
	Turn("DANA", -45.50f, 360.0f)
	SetChrPos("LAXIA", -101.16f, 1409.12f, 78.47f)
	Turn("LAXIA", -33.09f, 360.0f)
	SetChrPos("SAHAD", -103.70f, 1408.64f, 78.29f)
	Turn("SAHAD", -35.30f, 360.0f)
	SetChrPos("RICOTTA", -103.64f, 1407.72f, 78.18f)
	Turn("RICOTTA", -32.83f, 360.0f)
	SetChrPos("HUMMEL", -102.40f, 1409.27f, 78.47f)
	Turn("HUMMEL", -35.13f, 360.0f)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_SUP, 1)	// 目
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_SUP, 1)	// 目
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_SUP, 1)	// 目
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_SUP, 1)	// 目
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_TAME, 1)	// 口
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_SUP, 1)	// 口

	Look("ADOL", 0.0f, 10.0f)	// 上向く
	Look("DANA", 0.0f, 10.0f)	// 上向く
	Look("LAXIA", 0.0f, 10.0f)	// 上向く
	Look("SAHAD", 0.0f, 10.0f)	// 上向く
	Look("RICOTTA", 0.0f, 10.0f)	// 上向く
	Look("HUMMEL", 0.0f, 10.0f)	// 上向く

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -138.388f , 1392.016f , 83.102f , 145 )		// 注視点
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 8.879f , 145 )		// 基本距離
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -18.963f , 145 )		// 基本仰角
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 272.213f , 145 )		// 角度
	ExecuteCmd(1004, ChangeCameraPers, INTERPOLATE_SPHERE , 80.000f , 145 )		// 視野角
	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , 10.9f , 145 )		// ロール回転

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	
	Wait(20)

	// カット3 ----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_FAST)

	// カメラ
	//MoveCameraAt( 0 , -101.862f , 1407.478f , 80.181f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 2.879f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 2.525f , 0 )	// 基本仰角
	//RotateCamera( 0 , 357.830f , 0 )				// 角度
	//ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 5000.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	MoveCameraAt( 0 , -102.376f , 1408.178f , 79.741f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.879f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.379f , 0 )	// 基本仰角
	RotateCamera( 0 , 4.992f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 5000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。


	SetDoF(0, LERP_LINEAR, 5.000, 200.000, 0.000, 0.450, 0.620)
	
//	// カメラ移動
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -102.376f , 1408.178f , 79.741f , 100 )
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 2.879f , 100 )
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 1.379f , 100 )
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 4.992f , 100 )
//	
	// フェード待ち
	Wait(FADE_FAST)
//
//	// カメラ待ち
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

	ChangeAnimation( "DANA", "ANI_EV_TEMUNE_S", -1, 1 )	// 手胸当て

	// ダーナ
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#000e#000m──これで道は拓けたね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//PlayVoice(Y8V_1413,"SAHAD",100)	//おお！（嬉しい）

	ChangeAnimation("SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1)
	
	// サハド
	TalkPopup("SAHAD", 0, 2, 0, 0, 0) {
		"#000mおお……"
	}
	WaitPrompt()
	WaitCloseWindow()

	// リコッタ
	TalkPopup("RICOTTA", 0, 2, 0, 0, 0) {
		"#070e#000mいつ見てもビックリ……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("HUMMEL")
	ChangeAnimation( "HUMMEL", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組
	
	// ヒュンメル
	TalkPopup("HUMMEL", 0, 2, 0, 0, 0) {
		"#011e#000mフム、そして今視えたのが……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("LAXIA")
	
	// うなずきセット

	//PlayVoice(Y8V_0370,"LAXIA",100)	//ええ（平常のテンション。あらゆる場面で使用）

	HeadYes("LAXIA" , 1 , 25 )
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_CLOSE_E, 1)

	// ラクシャ
	TalkPopup("LAXIA", 0, 2, 0, 0, 0) {
		"#000mええ、今までアドルが"
		"視てきたダーナさんの過去……\p"
		"#011e#000mこんなふうに視えるものなのですね。"
		"視える4行目"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	ChangeAnimation("SAHAD", "ANI_EV_RYOTEKOSI_E", -1, 1)
	
	// サハド
	TalkPopup("SAHAD", 0, 2, 0, 0, 0) {
		"#091e#080m全く次から次へと"
		"たまげてばかりだぜ。"
	}
	WaitPrompt()
	WaitCloseWindow()
	Wait(10)

	// カット4 ----------------------------------------------------------------------------------------

	PlayBGM(BGM_EVENT_004, 0)

	// クロスフェード
	CrossFade(30)

	// カメラ
//	MoveCameraAt( 0 , -103.117f , 1408.699f , 80.925f , 0 )	// 注視点
//	ChangeCameraDistance( 0 , 3.178f , 0 )		// 基本距離
//	ChangeCameraElevation( 0 , -12.217f , 0 )	// 基本仰角
//	RotateCamera( 0 , 345.601f , 0 )				// 角度
//	ChangeCameraPers( 0 , 33.000f , 0 )			// 視野角
//	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ロール回転
//	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	MoveCameraAt( 0 , -103.117f , 1408.699f , 80.416f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.180f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -5.350f , 0 )	// 基本仰角
	RotateCamera( 0 , 348.067f , 0 )				// 角度
	ChangeCameraPers( 0 , 33.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転

	SetChrPos("ADOL",-102.02f,1409.50f,78.47f)
	Turn("ADOL",35.62f,360.0f)

//	SetChrPos("ADOL",-102.02f,1409.50f,78.47f)
//	Turn("ADOL",54.40f,360.0f)
	SetChrPos("LAXIA", -102.74f, 1410.07f, 78.47f)
	Turn("LAXIA", 14.59f, 360.0f)
	SetChrPos("SAHAD", -103.88f, 1410.07f, 78.46f)
	Turn("SAHAD", -27.77f, 360.0f)
	SetChrPos("HUMMEL",-104.04f,1408.92f,78.28f)
	Turn("HUMMEL",-103.80f,360.0f)
	SetChrPos("RICOTTA", -103.23f, 1408.12f, 78.29f)
	Turn("RICOTTA", -169.57f, 360.0f)
	SetChrPos("DANA", -102.23f, 1408.40f, 78.47f)
	Turn("DANA", 136.74f, 360.0f)
	ChangeAnimation( "HUMMEL", "ANI_WAIT", -1, 1 )	// 待機
	ChangeAnimation( "LAXIA", "ANI_WAIT", -1, 1 )	// 待機
	ChangeAnimation( "DANA", "ANI_WAIT", -1, 1 )	// 待機

	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)	// 目
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)	// 目

	LookChr("ADOL", "DANA")
	LookChr("LAXIA", "DANA")
	LookChr("SAHAD", "DANA")
	LookChr("HUMMEL", "DANA")
	LookChr("RICOTTA", "DANA")
	LookChr("DANA", "LAXIA")

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -103.117f , 1408.699f , 79.945f , 70 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.179f, 70 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.111f  , 70 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 340.929f , 70 )

	//MoveCameraAt( 0 , -103.117f , 1408.699f , 79.945f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 3.179f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 4.111f , 0 )	// 基本仰角
	//RotateCamera( 0 , 340.929f , 0 )				// 角度
	//ChangeCameraPers( 0 , 33.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//	"LAXIA"
	ChangeAnimation("LAXIA", "ANI_EV_SIAN_S", -1, 1)
	TalkPopup("LAXIA", 0, 2, 0, 0, 0)
	{
		"#000e#000mでも、ダーナさん、"
		"何故わたくしたちにまで？"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	TalkPopup("DANA", 0, 2, 0, 0, 0)
	{
		"#000e#000mうん、お世話になる以上、"
		"皆にも知ってもらわなきゃって。"
	}
	WaitPrompt()
	WaitCloseWindow()

//	CrossFade(FADE_NORMAL)

//	ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
//	ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
//	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)

//	MoveCameraAt(0, -104.134f, 1409.752f, 79.925f, 0)	// 注視点
//	ChangeCameraDistance(0, 2.699f, 0)		// 基本距離
//	ChangeCameraElevation(0, 4.929f, 0)	// 基本仰角
//	RotateCamera(0, 263.099f, 0)				// 角度
//	ChangeCameraPers(0, 33.000f, 0)			// 視野角
//	SetCameraZPlane(0.100f, 1600.000f)			// ZPlane
//	RollCamera(0, 0.0f, 0)				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

//	Wait(FADE_NORMAL)

	LookChr("ADOL", "DANA")

	//選択肢
	SetFlag(TF_MENU_SELECT, 0)
	MenuReset()
	MenuType(MENUTYPE_POPUP)
	MenuAdd(1, "ありがとう")
	MenuAdd(2, "気を遣い過ぎだ")
	MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 0)
	WaitMenu(0)
	MenuClose(10, 0)

	//─────────────────────────
	//	⇒ありがとう
	if (FLAG[TF_MENU_SELECT] == 1){
		LookChr("DANA", "ADOL")
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_S, 1)
		ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_SMILE_S, 1)
		Wait(10)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_S, 1)
		HeadYes("ADOL", 1, 25)
		Wait(20)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_E, 1)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 0)
		Wait(20)
		ChangeAnimation("LAXIA", "ANI_EV_SIAN_E", -1, 1)

		TalkPopup("LAXIA", 0, 2, 0, 0, 0)
		{
			"#000e#000mええ、見せていただいて"
				"感謝しています。\p"
				"本当にダーナさんは昔、"
				"ここにあった国の方なんですね。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}
		//	⇒気を遣い過ぎだ
	if (FLAG[TF_MENU_SELECT] == 2){
		LookChr("DANA", "ADOL")
		ChangeAnimation("ADOL", "ANI_EV_TEBURI", -1, 1)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
		HeadYes("ADOL", 1, 25)
		Wait(20)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_E, 1)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 0)
		Wait(20)
		ChangeAnimation("LAXIA", "ANI_EV_SIAN_E", -1, 1)
		
		TalkPopup("LAXIA", 0, 2, 0, 0, 0)
		{
			"#000e#000mでも、おかげで話に聞くより"
			"過去のことがよく分かりました。\p"
			"本当にダーナさんは昔、 "
			"ここにあった国の方なんですね。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}
	//─────────────────────────

	LookChr("DANA", "SAHAD")
	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// 両手腰

	PlayVoice(Y8V_1407,"SAHAD",100)	//ああ（平常のテンション。あらゆる場面で使用）
	HeadYes("SAHAD", 1,  25 )

	TalkPopup("SAHAD", 0, 2, 0, 0, 0)
	{
		"#011e#000m信じてなかったワケじゃないが、"
		"何つーか実感せざるを得ないよな。"
	}
	WaitPrompt()
	WaitCloseWindow()

//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE, -101.731f, 1408.134f, 79.826f, 80)		// 注視点
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE, 2.699f, 80)		// 基本距離
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE, 4.056f, 80)		// 基本仰角
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE, 242.143f, 80)		// 角度
//	ExecuteCmd(1004, ChangeCameraPers, INTERPOLATE_SPHERE, 33.000f, 80)		// 視野角
	LookReset("DANA")

//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)
//	WaitThread(1004)

	// カットX ----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_CROSS)

	// カメラ
	MoveCameraAt( 0 , -102.896f , 1408.399f , 79.886f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.220f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.764f , 0 )	// 基本仰角
	RotateCamera( 0 , 173.098f , 0 )				// 角度
	ChangeCameraPers( 0 , 33.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
	
	// 非表示・再表示
	SetChrInfoFlag("ADOL", INFOFLAG_INVISIBLE)	// 非表示
	SetChrInfoFlag("LAXIA", INFOFLAG_INVISIBLE)	// 非表示

	// カメラ移動（水平）
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -102.658f , 1408.370f , 79.886f , 180 )
	
	// フェード待ち
	Wait(FADE_CROSS)
	
	ChangeAnimation( "DANA", "ANI_EV_RYOTEMAE_S", -1, 1 )	// 両手 前組み
	
	//	"DANA"
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#080e#080mあはは……私も自分に何が起きたか"
		"分からないくらいだから。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	Look("DANA", 0.0f, -10.0f)	// うつむく
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE_S, 1)	// 目
	
	//	"DANA"
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#011e#000m今ので思い出せたけど、"
		"あの時、私は確かにここへ来た……\p"
		"エタニアが滅びてしまう原因を"
		"突き止めたい一心で……"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	LookSpd("DANA",0.08f,0.08f,0.08f)
	Look("DANA", 30.0f, 15.0f)
		
	//	"DANA"
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#062eでも、こうして見る限り、"
		"滅びは止められなかったのかな……"
	}
	WaitPrompt()
	WaitCloseWindow()
		

	//　　寂しそうに傾いた塔を眺めるダーナ。
	LookChr("RICOTTA", "DANA")

	TalkPopup("RICOTTA", 0, 2, 0, 0, 0)
	{
		"#051e#000mダーナ姉……"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ダーナにＰＡエモーション表示。
	EmotionEx("DANA", 0.00f, EMO_PA, 0, 5, 1, 1, 1.0f)	//パッ
	ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_SAD_E,1)
	Wait(35)
	LookReset("DANA")
	ChangeAnimation( "DANA", "ANI_EV_RYOTEMAE_E", -1, 1 )	// 両手 前組み
	LookChr("DANA", "RICOTTA")

	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#000mごめんね……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("DANA")
		
	TalkPopup("DANA", 0, 2, 0, 0, 0) {
		"#011e#000mとにかく、この調子で"
		"記憶を取り戻していけば……"
	}
	WaitPrompt()
	WaitCloseWindow()


	// カットX -----------------------------------------------------------------------------------------

	CrossFade(FADE_CROSS)
//	ResetChrInfoFlag("HUMMEL", INFOFLAG_INVISIBLE)
//	SetChrPos("HUMMEL", -104.39f, 1408.85f, 78.22f)
//	Turn("HUMMEL", -94.71f, 360.0f)
//	SetChrPos("SAHAD", -104.06f, 1410.48f, 78.47f)
//	Turn("SAHAD", -27.77f, 360.0f)
//	SetChrPos("ADOL", -102.14f, 1409.83f, 78.47f)
//	Turn("ADOL", 37.84f, 360.0f)

	// カメラ
	MoveCameraAt( 0 , -103.040f , 1409.298f , 79.901f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.240f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.706f , 0 )	// 基本仰角
	RotateCamera( 0 , 357.722f , 0 )				// 角度
	ChangeCameraPers( 0 , 28.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -103.000f , 1409.287f , 79.901f , 600 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  4.240f , 600 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 3.711f , 600 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 316.179f , 600 )

	// 非表示・再表示
	ResetChrInfoFlag("ADOL", INFOFLAG_INVISIBLE)	// 非表示
	ResetChrInfoFlag("LAXIA", INFOFLAG_INVISIBLE)	// 非表示

	Wait(FADE_CROSS)

	HeadYes("LAXIA" , 1 , 25 )
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_CLOSE_E, 1)
		
	//	"LAXIA"
	TalkPopup("LAXIA", 0, 2, 0, 0, 0)
	{
		"#000mええ、きっと全てを"
		"思い出せるはずです。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//選択肢
	SetFlag(TF_MENU_SELECT, 0)
	MenuReset()
	MenuType(MENUTYPE_POPUP)
	MenuAdd(1, "よし、すぐに塔へ向かうぞ")
	MenuAdd(2, "君がここにいることは意味がある")
	MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 0)
	WaitMenu(0)
	MenuClose(10, 0)

	//─────────────────────────
	//	⇒よし、すぐに塔へ向かうぞ
	if (FLAG[TF_MENU_SELECT] == 1){
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_S, 1)
		ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_SMILE_S, 1)
		Wait(10)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_S, 1)
		HeadYes("ADOL", 1, 25)
		Wait(20)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_E, 1)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 0)
		Wait(20)

		LookChr("RICOTTA", "ADOL")
		//　　リコッタに「…」エモーション。
		EmotionEx("RICOTTA", 0.00f, EMO_3DOT, 0, 5, 1, 1, 1.0f)	//…
		Wait(45)
		TalkPopup("RICOTTA", 0, 1, 0, 0, 0)
		{
			"#000e#000mアドル兄、もう陽が暮れる。"
		}
		WaitPrompt()
		WaitCloseWindow()

//		ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE, -105.617f, 1403.133f, 79.702f, 130)		// 注視点
//		ExecuteCmd(1001, ChangeCameraElevation, INTERPOLATE_SPHERE, -2.487f, 130)		// 基本仰角
//		ExecuteCmd(1002, RotateCamera, INTERPOLATE_SPHERE, 347.233f, 130)		// 角度

//		WaitThread(1000)
//		WaitThread(1001)
//		WaitThread(1002)

		//	"HUMMEL"
		PlayVoice(Y8V_2165,"HUMMEL",100)	//ああ（平常のテンション。あらゆる場面で使用）

		LookChr("HUMMEL", "ADOL")
		ChangeAnimation( "HUMMEL", "ANI_EV_TEBURI", -1, 1 )	// 手振り
		
		LookChr("ADOL", "HUMMEL")
				
		TalkPopup("HUMMEL", 0, 1, 0, 0, 0)
		{
			"#000e#000m夜更かしは感心しないな。\p"
			"仕事の効率が下がる上に"
			"美容にもよくないと聞く。"
		}
		WaitPrompt()
		WaitCloseWindow()

		//　　アドルに冷や汗エモーション表示。
		EmotionEx("ADOL", 0.00f, EMO_TARA, 0, 5, 1, 1, 1.0f)	//冷や汗
		ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_SAD_CLOSE_S,1)
		ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)

		Wait(45)

		LookChr("DANA", "ADOL")
		
		TalkPopup("DANA", 0, 2, 0, 0, 0)
		{
			"#081e#080mアドルさん、ありがとう。"
			"でも、今日はちゃんと休憩しよう。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}
		//	⇒君がここにいることは意味がある
	if (FLAG[TF_MENU_SELECT] == 2){
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_S, 1)
		ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_SMILE_S, 1)
		Wait(10)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_S, 1)
		HeadYes("ADOL", 1, 25)
		Wait(20)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE_E, 1)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 0)
		Wait(20)

		LookChr("DANA", "ADOL")

		TalkPopup("DANA", 0, 2, 0, 0, 0)
		{
			"#000e#000mアドルさん……\p"
			"ありがとう。"
			"私もそう思って頑張るから。"
		}
		WaitPrompt()
		WaitCloseWindow()

		LookChr("RICOTTA", "ADOL")

		//　リコッタに「…」エモーション表示。
		EmotionEx("RICOTTA", 0.00f, EMO_3DOT, 0, 5, 1, 1, 1.0f)	//…
		Wait(45)

		TalkPopup("RICOTTA", 0, 1, 0, 0, 0)
		{
			"#000e#000mアドル兄、そろそろ陽が暮れる。"
		}
		WaitPrompt()
		WaitCloseWindow()


		PlayVoice(Y8V_2165,"HUMMEL",100)	//ああ（平常のテンション。あらゆる場面で使用）

		LookChr("HUMMEL", "ADOL")
		ChangeAnimation( "HUMMEL", "ANI_EV_TEBURI", -1, 1 )	// 手振り
	
		LookChr("ADOL", "HUMMEL")

		//	"HUMMEL"
		TalkPopup("HUMMEL", 0, 1, 0, 0, 0)
		{
			"#000e#000m……夜更かしは感心しないな。\p"
			"仕事の効率が下がる上に"
			"美容にもよくないと聞く。"
		}
		WaitPrompt()
		WaitCloseWindow()

		LookChr("DANA", "ADOL")

		//	"DANA"
		TalkPopup("DANA", 0, 2, 0, 0, 0)
		{
			"#000e#000mみんなの言う通りかな……"
			"今日はここで休憩しよう。"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	Wait(10)

	StopBGM(60)

	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()

	Wait(20)
	PlaySE(SE_M05S090_04, 100, 0, 0, 0, 1.0f, 0)
	Wait(50)
	SetEnvSEPlayState(-1, 0)	//環境SE全停止
	Wait(30)

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6110:EV_M05S090_ED")
}

function "EV_M05S090_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	//ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")
	ResetChrInfoFlag("ADOL", INFOFLAG_INVISIBLE)
	ResetChrInfoFlag("LAXIA", INFOFLAG_INVISIBLE)
	ResetChrInfoFlag("HUMMEL", INFOFLAG_INVISIBLE)

	//パーティキャラを解放
	//ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	// ポートレートリリース
	Portrait_Close(-1)
	Portrait_Unload(-1)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	//CallFunc("system:camera_reset")

	LoadArg("map/mp6110t2/mp6110t2.arg")
	EventCue("mp6110:EV_M05S091")

	ResetStopFlag(STOPFLAG_EVENT)

	//終了処理ここまで----------------------------------------------------
}


//──────────────────────────────
//▼塔前で野営する(mp6110)
//──────────────────────────────
function "EV_M05S091"			//塔前で野営する
{

	//開始処理ここから-----------------------------------------------

	SetStopFlag(STOPFLAG_EVENTIMPOSE)
	ResetStopFlag(STOPFLAG_CINEMA)

	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//キャンプの設置
	MapAnime("camp_all", on)	//キャンプ未設置
	MapHide("@camp_fire", 1)	//火出す

	//炎を消す場合、camp_fire@　のノードを不可視にしてください。
	//煙を消す場合、camp_smoke@　のノードを不可視にしてください。

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrPos("DANA",-103.75f,1418.94f,78.47f)
	Turn("DANA",-114.63f,360.0f)
	SetChrPos("RICOTTA",-101.06f,1420.92f,78.47f)
	Turn("RICOTTA",51.29f,360.0f)
	
	SetChrPos("HUMMEL",-101.76f,1417.97f,78.47f)
	Turn("HUMMEL",166.73f,360.0f)
	
	SetChrPos("SAHAD",-100.29f,1419.72f,78.47f)
	Turn("SAHAD",82.21f,360.0f)
	SetChrPos("LAXIA",-102.48f,1421.29f,78.47f)
	Turn("LAXIA",-13.75f,360.0f)
	SetChrPos("ADOL",-103.60f,1420.22f,78.47f)
	Turn("ADOL",-75.05f,360.0f)

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("ADOL", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_SMILE_CLOSE, 1)
	ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_SMILE, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("ADOL")
	SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("RICOTTA", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_SMILE, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_SMILE, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("RICOTTA")
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOSHADOW)

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("SAHAD", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_SMILE_CLOSE, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_SMILE, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("SAHAD")
	SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("LAXIA", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("LAXIA")
	SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("LAXIA", INFOFLAG_NOSHADOW)

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("HUMMEL", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("HUMMEL")
	SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)
	PitchChr("HUMMEL" , 5 , 0)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("DANA", "ANI_EV_SIT_G", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("DANA", INFOFLAG_NOSHADOW)

	PitchChr("DANA" , 5 , 0)

	LookSpd("ADOL" , 0.1,0.1,0.1)
	LookSpd("DANA" , 0.1,0.1,0.1)
	LookSpd("LAXIA" , 0.1,0.1,0.1)
	LookSpd("HUMMEL" , 0.1,0.1,0.1)
	LookSpd("SAHAD" , 0.08,0.08,0.08)
	LookSpd("RICOTTA" , 0.1,0.1,0.1)


	//カメラ設定
	//MoveCameraAt( 0 , -123.739f , 1401.652f , 100.557f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 4.508f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , -24.440f , 0 )	// 基本仰角
	//RotateCamera( 0 , 222.396f , 0 )				// 角度
	//ChangeCameraPers( 0 , 54.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 3.9f , 0 )				// ロール回転
	//// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	MoveCameraAt( 0 , -104.062f , 1419.840f , 85.078f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.706f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -6.029f , 0 )	// 基本仰角
	RotateCamera( 0 , 190.904f , 0 )				// 角度
	ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -0.0f , 0 )				// ロール回転

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 160.000, 1.000, 0.700, 0.500)					//イベント毎に調整

	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6110:EV_M05S091_ED")

	//開始処理ここまで-----------------------------------------------

	PlayBGM(BGM_EVENT_005, 0)

	FadeIn(FADE_BLACK, FADE_NORMAL)
	Wait(FADE_NORMAL)

//	Wait(30)

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -104.062f , 1419.840f , 79.943f , 120 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE ,9.707f , 120 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 0.551f, 120 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 178.790f ,  120 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,4.9f, 120 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 120 )		// 視野角

	//MoveCameraAt( 0 , -104.062f , 1419.840f , 79.943f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 9.707f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 0.551f , 0 )	// 基本仰角
	//RotateCamera( 0 , 178.790f , 0 )				// 角度
	//ChangeCameraPers( 0 , 50.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , -0.0f , 0 )				// ロール回転

	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	WaitThread(1006)

	Wait(10)

	CrossFade(FADE_NORMAL)

	MoveCameraAt( 0 , -101.288f , 1419.718f , 78.555f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.770f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 23.859f , 0 )	// 基本仰角
	RotateCamera( 0 , 331.047f , 0 )				// 角度
	ChangeCameraPers( 0 , 30.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 3.9f , 0 )				// ロール回転

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 3.000, 60.000, 1.000, 0.700, 0.500)					//イベント毎に調整

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -101.730f , 1419.215f , 78.927f , 180 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 4.708f , 180 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE ,8.223f, 180 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 300.267f ,  180 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,-18.9f, 180 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 180 )		// 視野角

	//MoveCameraAt( 0 , -101.730f , 1419.215f , 78.927f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 4.708f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 8.223f , 0 )	// 基本仰角
	//RotateCamera( 0 , 300.267f , 0 )				// 角度
	//ChangeCameraPers( 0 , 30.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 3.9f , 0 )				// ロール回転

	Wait(50)

	//　　画面ブラックアウトして、作業しているＳＥ。
	//　　フェードインすると、小屋が完成している状態に。
	//　　焚火を囲むアドル班のメンバーたち。
	//　　アドル→ラクシャ→サハド→リコッタ→ヒュンメル→ダーナ。

	FadeBGM(70,10)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	ChangeAnimation( "SAHAD" , "ANI_EV_SG_BORI", -1 , 1 )

	TalkMes("SAHAD","#1853V#080mゲップ……",
		"ふう、ようやく人心地ついたぜ。","")
	WaitPrompt()
	WaitCloseWindow()

	WaitAnimation2( "SAHAD" , -1, 1, "ANI_EV_SG_BORI",  0)

	HeadYes("RICOTTA"  ,2 , 15)
	//	"RICOTTA"
	TalkMes("RICOTTA","#2737V#021e#080mなはは、お腹いっぱい！","","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(10)

	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(1005)
	WaitThread(1006)

	CrossFade(FADE_CROSS)

	MoveCameraAt( 0 , -103.282f , 1419.803f , 79.026f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.030f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 8.057f , 0 )	// 基本仰角
	RotateCamera( 0 , 136.241f , 0 )				// 角度
	ChangeCameraPers( 0 , 24.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 8.5f , 0 )				// ロール回転

	Wait(FADE_CROSS)

	Wait(10)

	LookSpd("DANA" , 0.1,0.1,0.1)
	Look("DANA" , 0 , -10 )

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -103.550f , 1420.068f , 78.952f , 150 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.910f , 150 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.549f, 150 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 129.317f ,  150 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,-18.9f, 150 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 150 )		// 視野角

	//MoveCameraAt( 0 , -103.550f , 1420.068f , 78.952f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 3.910f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 4.549f , 0 )	// 基本仰角
	//RotateCamera( 0 , 129.317f , 0 )				// 角度
	//ChangeCameraPers( 0 , 24.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 8.5f , 0 )				// ロール回転

	Wait(15)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	//	"DANA"
	TalkMes("DANA","#3195V#000m#0L………………………………","","")
	WaitPrompt()
	WaitCloseWindow()

	LookSpd("LAXIA" , 0.1,0.1,0.1)
	LookChr("LAXIA" , "DANA")
	//　　ラクシャにPAエモーション。
	EmotionEx("LAXIA", -0.02f,EMO_PA,0,5,1,1,0.75f )

	Wait(35)

	ChangeAnimation( "LAXIA" , "ANI_EV_SG_TEBURI", -1 , 1 )

	TalkMes("LAXIA","#1050V#000e#000mダーナさん、どうされました？","","")
	WaitPrompt()
	WaitCloseWindow()

	Look("DANA" , -20 , 0 )

	//	"DANA"
	TalkMes("DANA","#3196V#020l#012e#000mあ、うん……何だかこういう",
		"雰囲気って久しぶりだなと思って。","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Look("ADOL" ,10 , 0 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_SMILE_CLOSE_E,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKR_S,1)

	Wait(15)

	CrossFade(FADE_CROSS)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	MoveCameraAt( 0 , -103.912f , 1418.864f , 78.984f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.378f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 23.360f , 0 )	// 基本仰角
	RotateCamera( 0 , 154.124f , 0 )				// 角度
	ChangeCameraPers( 0 , 34.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 11.1f , 0 )				// ロール回転

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -103.912f , 1418.864f , 79.033f , 800 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.228f , 800 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 11.297f , 800 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 90.714f ,  800 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,23.000f, 800 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 800 )		// 視野角

	//MoveCameraAt( 0 , -103.912f , 1418.864f , 79.033f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 1.228f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 11.297f , 0 )	// 基本仰角
	//RotateCamera( 0 , 90.714f , 0 )				// 角度
	//ChangeCameraPers( 0 , 34.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 11.1f , 0 )				// ロール回転

	Wait(FADE_CROSS)

	Wait(10)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	TalkMes("DANA","#3197V#091e#080m小さい頃は夕食の後によく",
		"お父さんと暖炉前でおしゃべりして……","")
	WaitPrompt()

	LookSpd("DANA" , 0.06,0.06,0.06)
	Look("DANA" , 0 , -10 )
	TalkMes("DANA","#3198V#000l#092e#080m今はみんなとこうしていると思うと、",
		"何だか不思議な気持ち……","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(10)

	CrossFade(FADE_CROSS)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	MoveCameraAt( 0 , -101.296f , 1420.492f , 78.803f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.819f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 5.593f , 0 )	// 基本仰角
	RotateCamera( 0 , 293.262f , 0 )				// 角度
	ChangeCameraPers( 0 , 23.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -3.6f , 0 )				// ロール回転

	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SMILE,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_SMILE,1)
	LookChr("SAHAD" , "DANA")

	Wait(FADE_CROSS)
	Wait(10)

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -101.281f , 1420.518f , 78.704f , 210 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE ,  6.948f , 210 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 7.483f , 210 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 289.038f ,  210 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,23.000f, 170 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 150 )		// 視野角

	//MoveCameraAt( 0 , -101.281f , 1420.518f , 78.704f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 6.948f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 7.483f , 0 )	// 基本仰角
	//RotateCamera( 0 , 289.038f , 0 )				// 角度
	//ChangeCameraPers( 0 , 23.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , -3.6f , 0 )				// ロール回転

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	//	"RICOTTA"
	TalkMes("RICOTTA","#2738V#022e#080mダーナ姉は母上もいたのか？","","")
	WaitPrompt()
	WaitCloseWindow()

	HeadNo("DANA" , 1 ,35 )

	//	"DANA"
	TalkMes("DANA","#3199V#011e#000mううん……お母さんは……",
		"小さい頃に亡くなったの。","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(10)

	CrossFade(FADE_CROSS)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	MoveCameraAt( 0 , -100.207f , 1421.672f , 78.754f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.969f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 7.479f , 0 )	// 基本仰角
	RotateCamera( 0 , 280.843f , 0 )				// 角度
	ChangeCameraPers( 0 , 32.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -7.2f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 2.000, 10.000, 1.000, 0.700, 0.500)					//イベント毎に調整

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -100.190f , 1421.584f , 78.754f , 170 )		// 注視点
//	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 6.144f , 150 )		// 基本距離
//	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 11.522f , 150 )		// 基本仰角
//	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 174.884f ,  150 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,0.0f, 150 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 150 )		// 視野角

	//MoveCameraAt( 0 , -100.190f , 1421.584f , 78.754f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 3.969f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 7.479f , 0 )	// 基本仰角
	//RotateCamera( 0 , 280.843f , 0 )				// 角度
	//ChangeCameraPers( 0 , 32.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , -7.2f , 0 )				// ロール回転

	Wait(FADE_CROSS)

	Wait(5)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	//	"LAXIA"
	TalkMes("LAXIA","#1051V#050e#000mえ…………","","")
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "RICOTTA" , "ANI_EV_SG_TEBURI", -1 , 1 )

	LookChr("ADOL" , "RICOTTA" )
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)

	//	"RICOTTA"
	TalkMes("RICOTTA","#2739V#021e#080mそれならリコッタと一緒だな！","","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(10)


	CrossFade(FADE_FAST)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	MoveCameraAt( 0 , -104.398f , 1418.968f , 78.934f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.409f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 2.452f , 0 )	// 基本仰角
	RotateCamera( 0 , 134.140f , 0 )				// 角度
	ChangeCameraPers( 0 , 28.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 6.1f , 0 )				// ロール回転

	Wait(10)

	//　　ダーナにPAエモーション。
	EmotionEx("DANA", 0.0f,EMO_PA,0,5,1,1,0.85f )
	ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_SAD_CLOSE_E,1)
	LookChr("DANA" , "RICOTTA")

	Wait(35)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	TalkMes("DANA","#3200V#080mリコッタちゃん……","","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_CLOSE_E,1)

	Wait(10)
	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -104.398f , 1418.968f , 79.703f , 145 )		// 注視点
//	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 11.908f, 1000 )		// 基本距離
//	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , 29.815f, 1000 )		// 基本仰角
//	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 303.401f ,  1000 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,-6.7f, 1000 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 1000 )		// 視野角

	//MoveCameraAt( 0 , -104.398f , 1418.968f , 79.703f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 3.739f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 2.452f , 0 )	// 基本仰角
	//RotateCamera( 0 , 134.140f , 0 )				// 角度
	//ChangeCameraPers( 0 , 28.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 6.1f , 0 )				// ロール回転
	//// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	Wait(65)

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	LookReset("ADOL")

	MoveCameraAt( 0 , -101.843f , 1419.560f , 78.562f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 6.440f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 18.311f , 0 )	// 基本仰角
	RotateCamera( 0 , 233.670f , 0 )				// 角度
	ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -8.1f , 0 )				// ロール回転

	Wait(15)

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -102.009f , 1419.782f , 81.737f , 900 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 6.439f, 900 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE ,  14.865f, 900 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 326.892f ,  900 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,-6.7f, 1000 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 1000 )		// 視野角

	//MoveCameraAt( 0 , -102.009f , 1419.782f , 81.737f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 6.439f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 14.865f , 0 )	// 基本仰角
	//RotateCamera( 0 , 326.892f , 0 )				// 角度
	//ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , -8.1f , 0 )				// ロール回転


	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ExecuteFunc(100,"mp6110:M05S091_talkroop")
	ExecuteFunc(101,"mp6110:M05S091_fadeout")

	//	テキスト(色替え)
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
	{
		"#7Cその後も他愛無い話は続いた……\p"
		"#7Cダーナも少しずつ"
		"#7C自分の過去を話すようになり……\p"
		"#7Cアドル班のメンバーたちと"
		"#7Cさらに打ち解けていくのであった。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　会話が続いているような演出見せつつ画面フェードアウト。
	//　　夜空を映しつつ寝言イベントの処理へ。
	//　　（この回だけは強制的にダーナの寝言にする？）

	StopThread(101)
	FadeOut(FADE_BLACK,120)
	WaitFade()

	SetEnvSEPlayState(6110101, 0)	//

	StopThread(100)

	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	MapHide("camp_fire@" , 0)
	MapHide("camp_smoke@" , 0)

	ResetChrPos((CHRTYPE_PLAYER | REMOVE_POS))

	Wait(30)

	MoveCameraAt( 0 , -101.631f , 1416.927f , 82.651f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 9.643f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 11.129f , 0 )	// 基本仰角
	RotateCamera( 0 , 168.778f , 0 )				// 角度
	ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , -6.2f , 0 )				// ロール回転

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 200.000, 1.000, 0.700, 0.500)					//イベント毎に調整


	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	Wait(10)

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , -106.367f , 1412.976f , 108.721f , 430 )		// 注視点
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE ,  21.146f, 430 )		// 基本距離
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , -29.266f, 430 )		// 基本仰角
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE ,  309.125f ,  430 )		// 角度
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE ,-6.7f, 430 )		// ロール回転
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 430 )		// 視野角

	//MoveCameraAt( 0 , -106.367f , 1412.976f , 108.721f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 21.146f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , -29.266f , 0 )	// 基本仰角
	//RotateCamera( 0 , 309.125f , 0 )				// 角度
	//ChangeCameraPers( 0 , 41.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , -6.2f , 0 )				// ロール回転

	StopBGM(120)

	Wait(20)
	CallFunc("system:TentVoice_Sleep")

	Wait(20)
	PlaySE( SE_HOTEL_JINGLE , 100 , 0,  0, 0, 1.0f, 0)	//ジングル
	SetEnvSEPlayState(-1, 0)	//環境SE全停止

	FadeOut(FADE_BLACK,FADE_SLOW)
	WaitFade()

	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	StopThread(1006)

	Wait(60)

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6110:EV_M05S091_ED")
}

function "EV_M05S091_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//念のため
	StopThread(101)
	StopThread(100)

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//NowLoading 時の Tips 表示をカット
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	LoadArg("map/mp6110t3/mp6110t3.arg")
	EventCue("mp6110:EV_M05S092")

	ResetStopFlag(STOPFLAG_EVENTIMPOSE)


	//終了処理ここまで----------------------------------------------------
}

function "M05S091_talkroop"
{
	while(1){

		Wait(45)
		SetChrWork("SAHAD", CWK_FORCELIPSYNC, 1)
		ChangeAnimation( "SAHAD" , "ANI_EV_SG_RYOTEBURI", -1 , 1 )
		
		WaitAnimation2( "SAHAD" , -1, 1, "ANI_EV_SG_RYOTEBURI",  0)
		
		LookChr("DANA" , "SAHAD")
		Look("LAXIA" , -20 , 0 )
		
		Wait(25)
		SetChrWork("SAHAD", CWK_FORCELIPSYNC, 0)
		Wait(35)

		SetChrWork("LAXIA", CWK_FORCELIPSYNC, 1)
		ChangeAnimation( "LAXIA" , "ANI_EV_SG_TEBURI", -1 , 1 )
		
		LookChr("ADOL", "LAXIA")
		LookChr("SAHAD", "LAXIA")
		LookChr("RICOTTA", "LAXIA")
		
		WaitAnimation2( "LAXIA" , -1, 1, "ANI_EV_SG_TEBURI",  0)
		Wait(30)
		SetChrWork("LAXIA", CWK_FORCELIPSYNC, 0)
		Wait(50)
		
		SetChrWork("HUMMEL", CWK_FORCELIPSYNC, 1)
		
		ChangeAnimation( "HUMMEL" , "ANI_EV_SG_TEBURI", -1 , 1 )
		WaitAnimation2( "HUMMEL" , -1, 1, "ANI_EV_SG_TEBURI",  0)
		
		Wait(25)
		SetChrWork("HUMMEL", CWK_FORCELIPSYNC, 0)
		
		Wait(45)
		
		LookChr("ADOL" ,"SAHAD")
		LookChr("DANA" ,"SAHAD")
		LookChr("LAXIA","SAHAD")
		
		SetChrWork("SAHAD", CWK_FORCELIPSYNC, 1)
		
		LookReset("SAHAD")
		ChangeAnimation( "SAHAD" , "ANI_EV_SG_BORI", -1 , 1 )
		
		WaitAnimation2( "SAHAD" , -1, 1, "ANI_EV_SG_BORI",  0)
		Wait(30)
		SetChrWork("SAHAD", CWK_FORCELIPSYNC, 0)

		Wait(50)
		SetChrWork("SAHAD", CWK_FORCELIPSYNC, 1)
		ChangeAnimation( "ADOL" , "ANI_EV_SG_TEBURI", -1 , 1 )
		
		WaitAnimation2( "ADOL" , -1, 1, "ANI_EV_SG_TEBURI",  0)

		Wait(20)
		SetChrWork("ADOL", CWK_FORCELIPSYNC, 0)
		Wait(35)
		
		LookChr("DANA" , "ADOL")
		ChangeAnimation( "DANA" , "ANI_EV_SG_TEBURI", -1 , 1 )
		WaitAnimation2( "DANA" , -1, 1, "ANI_EV_SG_TEBURI",  0)
		
		Wait(20)
	}
}

function "M05S091_fadeout"
{
	Wait(700)

	FadeOut(FADE_BLACK,120)
	WaitFade()

}

//──────────────────────────────
//▼塔前の野営地を出発する(mp6110)
//──────────────────────────────
function "EV_M05S092"			//塔前の野営地を出発する
{
	//開始処理ここから-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")



	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定				
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL", -102.89f, 1418.11f, 78.47f)
	Turn("ADOL", -161.41f, 360.0f)

	ChangeAnimation("ADOL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("ADOL")
	SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA", -101.29f, 1420.67f, 78.47f)
	Turn("RICOTTA", 27.46f, 360.0f)
	ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("RICOTTA")
	SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD", -100.77f, 1418.65f, 78.47f)
	Turn("SAHAD", 120.12f, 360.0f)
	ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("SAHAD")
	SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA", -101.73f, 1418.03f, 78.47f)
	Turn("LAXIA", 177.69f, 360.0f)
	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookChr("LAXIA", "HUMMEL")
	SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL", -103.06f, 1421.05f, 78.47f)
	Turn("HUMMEL", -32.33f, 360.0f)
	ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("HUMMEL")
	SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)

	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA", -103.46f, 1419.51f, 78.47f)
	Turn("DANA", -92.22f, 360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")
	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)

	SetChrInfoFlag( "Suzume" , INFOFLAG_NOATARI )
	SetChrInfoFlag( "Suzume" , INFOFLAG_FLING )
	SetChrPos("Suzume",-120.23f,1411.44f,90.95f)
	Turn("Suzume",-84.39f,360.0f)
	PitchChr("Suzume", 17.33f, 0)
	RollChr("Suzume", 0.00f, 0)

	SetChrInfoFlag( "Suzume2" , INFOFLAG_NOATARI )
	SetChrInfoFlag( "Suzume2" , INFOFLAG_FLING )

	SetChrPos("Suzume2",-120.23f,1411.44f,90.95f)
	Turn("Suzume2",-84.39f,360.0f)
	PitchChr("Suzume2", 13.54f, 0)
	RollChr("Suzume2", 0.00f, 0)

	//キャンプの設置
	MapAnime("camp_all", on)	//キャンプ設置
	MapHide("@camp_fire", 0)
	MapHide("@camp_smoke", 0)

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt(0, -116.393f, 1406.113f, 92.937f, 0)	// 注視点
	ChangeCameraDistance(0, 9.000f, 0)		// 基本距離
	ChangeCameraElevation(0, -30.768f, 0)	// 基本仰角
	RotateCamera(0, 269.901f, 0)				// 角度
	ChangeCameraPers(0, 60.000f, 0)			// 視野角
	SetCameraZPlane(0.100f, 1600.000f)			// ZPlane
	RollCamera(0, 0.0f, 0)				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。


	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 200.000, 2.000, 0.550, 0.500)					//イベント毎に調整
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6110:EV_M05S092_ED")

	//開始処理ここまで-----------------------------------------------

	PlaySE(SE_SUZUME, 100, 0, 0, 0, 1.0f, 0)
	Wait(60)

	FadeIn(FADE_BLACK, FADE_NORMAL)

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE, -114.500f, 1409.140f, 92.937f, 100)		// 注視点
	ExecuteCmd(1001, RotateCamera, INTERPOLATE_SPHERE, 281.760f, 100)		// 角度
	//　　画面暗転のまま、チュンチュンと小鳥の鳴き声ＳＥ。
	//　　フェードインして、朝日の中、

//	ExecuteCmd(11, MoveZ , "Suzume" , 100.95f, 0 , INTERPOLATE_SPHERE  , 260 )
	ExecuteCmd( 1, MoveToEx, "Suzume" ,-89.25f,1395.34f,90.95f, 0.1f, 1.1f ,0,0)

	Wait(40)
//	ExecuteCmd(12, MoveZ , "Suzume2" , 100.95f, 0 , INTERPOLATE_SPHERE  , 260 )
	ExecuteCmd( 2, MoveToEx, "Suzume2" ,-89.25f,1395.34f,90.95f, 0.1f, 1.1f ,0,0)
	//SetChrPos("Suzume2",-89.25f,1395.34f,90.95f)
	//Turn("Suzume2",-84.39f,360.0f)
	//PitchChr("Suzume2", 13.54f, 0)
	//RollChr("Suzume2", 0.00f, 0)

	WaitThread(1000)
	WaitThread(1001)

	Wait(15)

	CrossFade(FADE_NORMAL)
	MoveCameraAt( 0 , -101.921f , 1421.446f , 80.659f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.361f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 1.742f , 0 )	// 基本仰角
	RotateCamera( 0 , 172.900f , 0 )				// 角度
	ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.000, 250.000, 2.000, 0.550, 0.500)					//イベント毎に調整

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -101.921f , 1421.446f , 80.163f , 60 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  2.361f , 60 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 5.630f , 60 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 167.232f , 60 )

	//MoveCameraAt( 0 , -101.921f , 1421.446f , 80.163f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 2.361f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 5.630f , 0 )	// 基本仰角
	//RotateCamera( 0 , 167.232f , 0 )				// 角度
	//ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
	//SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//　　小屋前で向き合っているアドルたち。
	LookChr("ADOL", "LAXIA")
	ChangeAnimation("LAXIA", "ANI_EV_TEBURI", -1, 1)
	TalkPopup("LAXIA", 0, 2, 0, 0, 0)
	{
		"#000e#000m全員、準備はできたようですね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	PlayVoice(Y8V_1413,"SAHAD",100)	//おお！（嬉しい）

	//	"SAHAD"
	ChangeAnimation("SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1)
	TalkPopup("SAHAD", 0, 2, 0, 0, 0)
	{
		"#021e#080mおお、メシ食ってクソして"
		"本日も絶好調だぜ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"LAXIA"
	ChangeAnimation("LAXIA", "ANI_EV_UDEGUMI_S", -1, 1)
	TalkPopup("LAXIA", 0, 2, 0, 0, 0)
	{
		"#011e#000mまったく……"
	}
	WaitPrompt()
	WaitCloseWindow()


	CrossFade(FADE_CROSS)

	SetChrPos("SAHAD", -100.26f, 1419.08f, 78.47f)
	Turn("SAHAD", 115.95f, 360.0f)
	SetChrPos("HUMMEL", -103.06f, 1420.73f, 78.47f)//-103.07f, 1420.81f, 78.47f)
	Turn("HUMMEL", -42.99f, 360.0f)
	SetChrPos("LAXIA", -101.80f, 1417.92f, 78.47f)
	Turn("LAXIA", 177.69f, 360.0f)
	SetChrPos("ADOL", -102.89f, 1418.64f, 78.47f)
	Turn("ADOL", -139.64f, 360.0f)
	SetChrPos("DANA", -103.31f, 1419.75f, 78.47f)
	Turn("DANA", -72.41f, 360.0f)
	SetChrPos("RICOTTA", -102.35f, 1421.18f, 78.47f)//-101.95f, 1421.44f, 78.47f)
	Turn("RICOTTA", -26.45f, 360.0f)//-15.79f, 360.0f)
	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)

	LookReset("ADOL")
	LookChr("RICOTTA", "DANA")

	MoveCameraAt( 0 , -101.909f , 1419.011f , 79.989f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 3.240f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 2.242f , 0 )	// 基本仰角
	RotateCamera( 0 , 55.981f , 0 )				// 角度
	ChangeCameraPers( 0 , 29.800f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 非表示・再表示
	SetChrInfoFlag("SAHAD", INFOFLAG_INVISIBLE)	// 非表示

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -101.909f , 1419.011f , 79.989f , 300 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.240f , 300 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 2.528f , 300 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 47.958f , 300 )

	Wait(FADE_CROSS)

	//	"HUMMEL"
	ChangeAnimation("HUMMEL", "ANI_EV_SIAN_S", -1, 1)
	TalkPopup("HUMMEL", 0, 2, 0, 0, 0)
	{
		"#000e#000m塔は研究施設ということだが、"
		"中は一体どうなっている？"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"

	ChangeAnimation("DANA", "ANI_EV_TEMUNE_S", -1, 1)
	LookChr("ADOL", "DANA")
	LookChr("LAXIA", "DANA")

	TalkPopup("DANA", 0, 2, 0, 0, 0)
	{
		"#011e#000m私も全ての部屋に入ったことが"
		"あるわけじゃないからなあ。\p"
		"ただ各階の出入りは理力による"
		"制御装置で厳重に管理されていたよ。\p"
		"各階3行目"
		"#012e#000mそれが今はどうなっているか"
		"分からないけど……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
	LookChr("HUMMEL", "DANA")
	ChangeAnimation("HUMMEL", "ANI_EV_SIAN_E", -1, 1)


	ChangeAnimation("DANA", "ANI_EV_TEMUNE_E", -1, 1)
	WaitAnimation2("DANA", -1, 1, "ANI_EV_TEMUNE_E", 0)

	LookChr("DANA", "LAXIA")

	//	"LAXIA"
	ChangeAnimation("LAXIA", "ANI_EV_TEBURI", -1, 1)
	TalkPopup("LAXIA", 0, 1, 0, 0, 0)
	{
		"#000e#000m傾いていることもありますし、"
		"建物も脆くなっているかもしれません。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	"DANA"
	HeadYes("DANA", 1, 25)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	Wait(15)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_CLOSE_E, 1)

	TalkPopup("DANA", 0, 0, 0, 0, 0)
	{
		"#000mうん、とにかく慎重に進もう。"
	}
	WaitPrompt()
	WaitCloseWindow()

	PlayVoice(Y8V_2559,"RICOTTA",100)	//御意（平常のテンション。あらゆる場面で使用）

	ChangeAnimation("RICOTTA", "ANI_EV_YARUKI_S", -1, 1)
	//	"RICOTTA"
	TalkPopup("RICOTTA", 0, 0, 0, 0, 0)
	{
		"#021e#080m御意っ！"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ここで操作許可。
	FadeOut(FADE_BLACK, FADE_FAST)
	WaitFade()

	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

//-- 周辺の地図登録システムメッセージ --------------------------------

	PlaySE(SE_EV_POINT, 100, 0, 0, 0, 1.0f, 0)	//イベントポイント登録
	Message("#4C周辺のイベントポイントが地図に記された。")
	WaitPrompt()
	WaitCloseWindow()

	//終了処理ここから----------------------------------------------------
	CallFunc("mp6110:EV_M05S092_ED")
}

function "EV_M05S092_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	SetChrPos("Suzume",-100000.0f,0.00f,0.00f)
	SetChrPos("Suzume2",-100000.0f,0.00f,0.00f)

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//フラグ処理
	SetFlag(SF_SETRAMSAVE,1)		//リトライセーブ
	SetFlag(GF_05MP6110_OUT_CAMP, 1)		//塔前の野営地を出発する

	//水晶石をアクティブ
	SetCheckPoint(CP_MP6110)
	DelMapMarker( SMI_WARPPT,PAGE_F035  , -1,-99 ,1410)
	SetMapMarker( SMI_CHECKED_WARPPT, PAGE_F035,-1 , -99 ,1410 ,78 ,-99 ,1410 , CP_MP6110, MN_F_MP6110,0)	// 新しい水晶石マーカーを設置
	ChangeAnimation( "chkpt" , "ANI_STOP", -1 , 1 )

	CallFunc("mp6110:init")

	//マップマーカー
	SetMapMarker( SMI_SYMBOL ,PAGE_MP632x, MARKER_EV_M05S130, 24.79f, 0.45f, 594.21f, 24.79f, 0.45f,MARKER_EV_M05S130,MN_D_MP6330,0)		//メイン：ダーナがモノリスを起動する

	if( !FLAG[GF_SUBEV_JOIN_KASHU] ) {	// カシューと合流した
		SetMapMarker( SMI_SUBEVENT ,PAGE_F035, MARKER_PERSON_KASHU, -260.79f,1547.92f,95.95f, -260.79f,1547.92f,MARKER_PERSON_KASHU,MN_F_MP6104,0)		//漂流者：カシュー
	}

	//イベント後の再配置
	SetChrPos("LEADER", -107.08f, 1418.00f, 78.47f)
	Turn("LEADER", -15.43f, 360.0f)

	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , -107.080f , 1418.000f , 80.336f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 7.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 14.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -165.735f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	CallFunc("system:camera_reset")

	//リトル・パロのボイス
	CallFunc("system:SetMarkerParoVoice")		//リトルパロのマーカー登録ボイス

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK, FADE_FAST)
	//WaitFade()

	//終了処理ここまで----------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////

//■サブイベントセクション

////////////////////////////////////////////////////////////////////////////////
//──────────────────────────────
//	【過去編Ⅲ：現代に戻るイベント】　後の再配置
//──────────────────────────────
function "SubEV_Past_03_Return_Relocate"
{
	//	  　現代編の水晶石の前に復帰して操作許可を戻す。

	CallFunc("system:event_begin")

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	CallFunc("mp6110:init")

	//イベント後の再配置
	SetChrPos("LEADER",-102.07f,1409.29f,78.47f)
	Turn("LEADER",84.07f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// 基本仰角
	//RotateCamera( 0 , 0.0f , 0 )				// 角度
	//ChangeCameraPers( 0 , 0.0f , 0 )			// 視野角
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ロール回転

	RestoreCamera(0, 0)		//※上記カメラ位置を指定する場合は不要
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()
}

//──────────────────────────────
//【過去編Ⅲ：水晶石を調べて再訪する】
//──────────────────────────────
function "SubEV_Past_03_Rearrive"
{
//　　GF_05MP6110_OUT_CAMPが立って以降、
//　　mp6110にある水晶石のＬＰを調べると以下の選択肢。

//開始処理ここから----------------------------------------------------
	SetStopFlag(STOPFLAG_SIMPLEEVENT2)
	ResetStopFlag(STOPFLAG_NOCHARACLIP)
	SaveCamera()

	ResetMotion( "PARTYALL" , 0 )
	StopEffect(-1,PARTYALL,1)
	StopEmotion( "PARTYALL" )
	ResetMoveVec("PARTYALL")
//開始処理ここまで-----------------------------------------------

	TurnToChr( LEADER , this , 7.5f )
	Wait(10)

	//テキスト
	TalkPopup(UNDEF, 0, 3, SYSTEM_PPOSX, SYSTEM_PPOSY, 0)
	{
		"#7C不思議な紋章が刻まれた水晶石がある。"
		"水晶石2行目2"
	}
	WaitPrompt()
	WaitCloseWindow()

	SetFlag( TF_MENU_SELECT, 0 )
	YesNoMenu(TF_MENU_SELECT,"#7C水晶石に触れますか？",1)

	//────────────────────
	//	⇒はい
	if( FLAG[TF_MENU_SELECT] )	// Yesを選んだ
	{
		//　　下の流れに接続
	
		//　　クロスフェードで水晶石の前にキャラを配置。
		//　　（ダーナはいる・いない場合がある）
	
	//開始処理ここから-----------------------------------------------
		CrossFade(45)
	
		ResetStopFlag(STOPFLAG_SIMPLEEVENT2)
	
		//CallFunc("system:event_begin")
		SetStopFlag(STOPFLAG_EVENT)
		ResetStopFlag(STOPFLAG_NOCHARACLIP)
		SetStopFlag(STOPFLAG_NOCHARACLIP)
	
		//イベント開始前情報の保存
		SaveEventState()
		SaveCamera()
	
		//パーティ状態のリセット
		CallFunc("system:party_reset")
	
		//環境の初期化・不要なものを隠す
		ClearDebris()
		ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
		//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))
	
		//キャラクター初期化
		SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("ADOL", -99.91f, 1409.74f, 78.46f)
		Turn("ADOL", -98.77f, 360.0f)
		ChangeAnimation("ADOL", "ANI_WAIT", -1, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_WAIT, 1)
		ChangeSubAnimation("ADOL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
		ChangeSubAnimation("ADOL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
		LookReset("ADOL")
		SetChrInfoFlag("ADOL", INFOFLAG_NOCHRATARI)
	
		SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("LAXIA", -99.85f, 1411.29f, 78.47f)
		Turn("LAXIA", -29.53f, 360.0f)
		ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
		ChangeSubAnimation("LAXIA", SUBMOT_EYE, ANI_E_WAIT, 1)
		ChangeSubAnimation("LAXIA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
		ChangeSubAnimation("LAXIA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
		LookReset("LAXIA")
		SetChrInfoFlag("LAXIA", INFOFLAG_NOCHRATARI)
	
		SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("SAHAD", -99.97f, 1408.22f, 78.30f)
		Turn("SAHAD", -141.89f, 360.0f)
		ChangeAnimation("SAHAD", "ANI_WAIT", -1, 1)
		ChangeSubAnimation("SAHAD", SUBMOT_EYE, ANI_E_WAIT, 1)
		ChangeSubAnimation("SAHAD", SUBMOT_MOUTH, ANI_M_WAIT, 1)
		ChangeSubAnimation("SAHAD", SUBMOT_EXT1, ANI_E_LOOKC, 1)
		LookReset("SAHAD")
		SetChrInfoFlag("SAHAD", INFOFLAG_NOCHRATARI)
	
		SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("RICOTTA", -101.07f, 1409.04f, 78.47f)
		Turn("RICOTTA", -121.66f, 360.0f)
		ChangeAnimation("RICOTTA", "ANI_WAIT", -1, 1)
		ChangeSubAnimation("RICOTTA", SUBMOT_EYE, ANI_E_WAIT, 1)
		ChangeSubAnimation("RICOTTA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
		ChangeSubAnimation("RICOTTA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
		LookReset("RICOTTA")
		SetChrInfoFlag("RICOTTA", INFOFLAG_NOCHRATARI)
	
		SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("HUMMEL", -99.25f, 1411.78f, 78.47f)
		Turn("HUMMEL", 11.06f, 360.0f)
		ChangeAnimation("HUMMEL", "ANI_WAIT", -1, 1)
		ChangeSubAnimation("HUMMEL", SUBMOT_EYE, ANI_E_WAIT, 1)
		ChangeSubAnimation("HUMMEL", SUBMOT_MOUTH, ANI_M_WAIT, 1)
		ChangeSubAnimation("HUMMEL", SUBMOT_EXT1, ANI_E_LOOKC, 1)
		LookReset("HUMMEL")
		SetChrInfoFlag("HUMMEL", INFOFLAG_NOCHRATARI)
	
		if( FLAG[SF_DANA_JOINOK] )
		{
			SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
			SetChrPos("DANA", -100.50f, 1410.57f, 78.47f)
			Turn("DANA", -70.37f, 360.0f)
			ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
			ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
			ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
			ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
			LookReset("DANA")
			SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)
		}
	
		//BGM設定◆
		//PlayBGM( BGM_FIELD_101 , XX )
	
		// ポートレート読み込み
		Portrait_Load(0, "system/black.itp" )		//擬似フェードアウト用
		Portrait_Create(0, 0, 0, 0, 0, 64,64, 0.0f, 0x00ffffff, 0x00000000)
	
		//カメラ設定
		MoveCameraAt( 0 , -99.220f , 1409.904f , 79.088f , 0 )	// 注視点
		ChangeCameraDistance( 0 , 5.340f , 0 )		// 基本距離
		ChangeCameraElevation( 0 , 2.337f , 0 )	// 基本仰角
		RotateCamera( 0 , 214.410f , 0 )				// 角度
		ChangeCameraPers( 0 , 35.000f , 0 )			// 視野角
		SetCameraZPlane( 0.100f , 1600.000f )			// ZPlane
		RollCamera( 0 , 1.4f , 0 )				// ロール回転
		// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
	
		// 被写界深度の設定
		SetDoF(0, LERP_LINEAR, 2.000, 30.000 ,0.000 ,0.150 ,0.500)
		// グレアの設定
		SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)
	
		//スキップ許可
		SetSkipScript("mp6110:SubEV_Past_03_Rearrive_ED")
	
		// カメラ移動
		ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -99.149f , 1409.720f , 79.914f , 300 )
		ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  6.764f , 300 )
		ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 5.590f , 300 )
		ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 297.604f , 300 )
	
		Effect2(3900500, -99.165f , 1409.866f , 78.590f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.0f, 1.0f)	//共鳴音と連動するように水晶石が明滅（ループ）
	
		Wait(20)
	//開始処理ここまで-----------------------------------------------
	
		//　　先頭のアドルが手をかざし、水晶石が光る演出が入る。
	
		ChangeAnimation("ADOL", "ANI_EV_KAZASU_S", -1, 1)		// 手をかざす
		Wait(10)
		ChangeSubAnimation("ADOL", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
	
		PlaySE(SE_GO_KAKO_1, 100, 1, 1000, 0, 1.0f, 0)	//水晶石と交信エフェクトループ
		PlaySE(SE_GO_KAKO_4, 30, 1, 4000, 0, 1.0f, 0)

		Effect2(3900530, -98.575f , 1409.608f , 78.090f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.0f)	// 水晶石と交信エフェクト
	
		EarthQuake( 0.01f , 0.01f , 300 )	// 縦揺れ幅, 横揺れ幅, 時間
	
		Effect2(3900570, -98.575f , 1409.608f , 78.090f, 0.0f, 0, 0, IMPACT_NONE, KNOCK_EFXPOS, 0, 1.2f, 1.0f)	// 過去に飛ぶ時の画面切り替えエフェクト
		PlaySE(SE_GO_KAKO_4, 30, 1, 4000, 0, 1.0f, 0)
	
	//	Wait(250)
		Wait(90)
		PlaySE(SE_GO_KAKO_2, 80, 0, 0, 0, 1.0f, 0)	//	発光（過去編ワープ）
		Wait(60)
		PlaySE(SE_GO_KAKO_2, 80, 0, 0, 0, 1.0f, 0)	//	発光（過去編ワープ）
		Wait(60)
		PlaySE(SE_GO_KAKO_2, 80, 0, 0, 0, 1.0f, 0)	//	発光（過去編ワープ）
		Wait(40)
	
		StopBGM(120)
	
		//　　ホワイトアウトし、以下に接続
	
		PlaySE(SE_GO_KAKO_3, 100, 0, 0, 0, 1.0f, 0)	//	ホワイトアウト
		SetEnvSEPlayState(-1, 0)	//環境SE全停止
		StopSE(SE_GO_KAKO_1, 2000)
		StopSE(SE_GO_KAKO_4, 4000)

		// フェードアウト（白）
		FadeOut(FADE_WHITE, FADE_NORMAL)
		Wait(FADE_NORMAL)
	
		// カメラ停止
		StopThread(1000)
		StopThread(1001)
		StopThread(1002)
		StopThread(1003)
	
		Wait(60)
		
		// 擬似フェードアウト表示
		Portrait_Anime(0 ,PR_ANIME_SCALE, 30.0f, 17.0f, 0, 0, 0)
		Portrait_Anime(0 ,PR_ANIME_COLOR, 1.0f, 1.0f, 1.0f, 1.0f, 0)
	
		// フェードイン（白）
		FadeIn(FADE_WHITE, FADE_NORMAL)
		WaitFade()
	
		// フェードアウト（黒）
		FadeOut(FADE_BLACK, 0)
		WaitFade()
	
	//終了処理ここから----------------------------------------------------
		CallFunc("mp6110:SubEV_Past_03_Rearrive_ED")
	}
	//	⇒いいえ
	else
	{
		//	  　そのまま操作許可を戻す
	
	//終了処理ここから----------------------------------------------------
		CrossFade(FADE_CROSS)
		SetStopFlag(STOPFLAG_NOCHARACLIP)
	
		//イベント後の再配置
		//SetChrPos("LEADER", -218.56f, 816.64f, 64.58f)
		//Turn("LEADER", 166.13f, 360.0f)
		ResetPartyPos()
		ResetFollowPoint()
		//Wait(1) //処理待ち用
	
		RestoreCamera(0,0)
		ResetCameraObserver(0)
		ResetCameraZPlane()
		//WaitFade()
		Wait(FADE_CROSS)
	
		ResetStopFlag(STOPFLAG_SIMPLEEVENT2)
	//終了処理ここまで----------------------------------------------------
	}
	//────────────────────

}
function "SubEV_Past_03_Rearrive_ED"
{
	SetSkipScript("")		//終了処理はスキップ禁止

	//モンスターを復帰
	//ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラクター初期化
	CallFunc("system:reset_chrmot_ADOL")
	CallFunc("system:reset_chrmot_LAXIA")
	CallFunc("system:reset_chrmot_SAHAD")
	CallFunc("system:reset_chrmot_HUMMEL")
	CallFunc("system:reset_chrmot_RICOTTA")
	
	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	// エフェクト停止
	StopEffect(-1, ALL, 1)

	// ポートレートリリース
	Portrait_Close(-1)
	Portrait_Unload(-1)

	CallFunc("system:camera_reset")

	SetFlag( TF_LOADING_TIPS_OFF, 1 )	//NowLoading 時の Tips 表示をカット

	StopBGM(30)
//	SetFlag(SF_NOCHANGEBGM, 1)
	
	LoadArg("map/mp6110m/mp6110m.arg")
	EventCue("mp6110m:SubEV_Past_03_Rearrive2")
	
	ResetStopFlag(STOPFLAG_EVENT)

//終了処理ここまで----------------------------------------------------
}
