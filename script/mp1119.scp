#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/music.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"

//-------------------------------------------
// 1119�F
//-------------------------------------------
// init�X�N���v�g
function "init"
{
	CallFunc("rng:expMult")
	//���i�s�K�v�m�[�h�폜���}�b�v��Ǝҗp
	MapHide( "ground_south_all" , 0 )
	MapHide( "tree_alpha_all" , 0 )
	MapHide( "ground_south" , 1 )
	MapHide( "@BG2_groundfog" , 0 )	//���i�̔t�H�O������

	MapHide( "camp_fire1" , 0)
	MapHide( "camp_fire2" , 0)
	MapHide( "camp_smoke1" , 0)

	// �C�x���g�G���A/�ݒ萧��
	EventAreaEnable( "evc_M02S701" , 0 )
	EventAreaEnable( "ev2_EV_LOCATION010" , 0 )

	// �C�x���g��������
	if (FLAG[SF_BOSS_BATTLE])
	{
		//���g���C��f�o�b�O�{�X�W�����v����̃{�X��
		if( FLAG[GF_QUEST_400] >= QUEST_SUCCESS &&		// ������[�ւ̌���i���R�b�^�j
			!FLAG[GF_SPEEDRUN_SKILL_SAHAD] && FLAG[SF_SAHAD_JOINOK])			// ��荞�݃X�L���K���F�A���T�n�h�u�r�}�X�^�[�R���O����������
		{
			SetWork(WK_BGM, BGM_Nothing)
			EventCue("mp1119:Retry_Speedrun_Monkey2_Battle")
		}

	}
	else if( FLAG[SF_EVENT_ON] )
	{
		if(!FLAG[GF_TBOX_DUMMY062]){			// �f�B�i�ƍ�������
			EventAreaEnable( "evc_M02S701" , 1 )

			SetChrPos("Dina", 898.47f, 629.60f, 10.56f)		//�ʒu��ύX������}�b�v�}�[�J�[�̈ʒu���ύX���邱��
			Turn("Dina", -128.38f, 360.0f)

			//������ON
			SetEnvSEPlayState(1119200, 1)
			MapHide( "camp_fire1" , 1)
			MapHide( "camp_fire2" , 1)
			MapHide( "camp_smoke1" , 1)

		}
		if (!FLAG[GF_02MP1119_LOOK_DINA]){			// �f�B�i�𔭌�����
			SetFlag(GF_02MP1119_LOOK_DINA,1)
			//EventCue("mp1119:EV_M02S700")
		}
		if ( !FLAG[GF_LOCATION10] ) {		// ���P�[�V����010
			EventAreaEnable( "ev2_EV_LOCATION010" , 1 )
		}

	//��ʔz�u�t�@���N�V�����Ăяo��
		CallFunc("mp1119:NpcPosition")

	//�m�o�b�}�[�J�[�Z�b�g
		CallFunc("system:SetMarkerNPC")
	}

	//�}�b�v���\��
	if(!FLAG[SF_LOADINIT] && !FLAG[GF_MPxxxx_MAP_NAME_NO_DRAW] && !FLAG[TF_MAPNAME_SHOWN]){
		if( FLAG[SF_LASTENTRY_NO] == 0 || FLAG[SF_LASTENTRY_NO] == 100 ){
			VisualName("visual/mapname/mn_1119.itp",VN_NAMEMAP2,-1,-1,VN_MAPNAME_TIME)//���̏o���l
			SetFlag( TF_MAPNAME_SHOWN, 1 )				// �n���\�������i�e���|�����j
		}
	}
}

//////////////////////////////////////////////////////////////////////
//����ʔz�u
//////////////////////////////////////////////////////////////////////
//��ʔz�u
function "NpcPosition"
{
	if( FLAG[GF_QUEST_400] >= QUEST_SUCCESS &&		// ������[�ւ̌���i���R�b�^�j
		!FLAG[GF_SPEEDRUN_SKILL_SAHAD] && FLAG[SF_SAHAD_JOINOK])			// ��荞�݃X�L���K���F�A���T�n�h�u�r�}�X�^�[�R���O����������
	{
		//�}�X�^�[�R���O
		SetChrPos("Monkey",785.02f, 785.21f, 3.41f)
		Turn("Monkey",-78.27f,360.0f)
		ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	}
}

//////////////////////////////////////////////
// ���P�[�V�����|�C���g010:�ł��グ��ꂽ��[
//////////////////////////////////////////////
function "EV_LOCATION010"
{
//�J�n������������----------------------------------------------------

	SetFlag(SF_ALLMUTEKI,1)		//���G�n�m
	SetStopFlag(STOPFLAG_PC)
	SetStopFlag(STOPFLAG_EVENT)
	SaveCamera()

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

	ChangeAnimation( "LEADER" , "ANI_WAIT", -1 , 1 )

	//���[�V�������I������܂őҋ@
	WaitAnimation2( "LEADER" ,-1 ,-1 ,ANI_WAIT ,1 )

	ResetMotion( "ALL" , 1 )
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	// ���P�[�V�����p
	Portrait_Load(3, "visual/mapname/lnbase00.itp" )

	Portrait_Load(4, "visual/mapname/lnmp1119.itp" )

	Portrait_Create(3 , LOCATEFIND_START_POSX , LOCATEFIND_START_POSY , 0 , 0 , LOCATEFIND_START_SIZEX , LOCATEFIND_START_SIZEY , 0.0f , 0x00ffffff , 0x00000000 )
	Portrait_Create(4 , LOCATENAME_POSX , LOCATENAME_POSY , 0 , 0 , LOCATENAME_SIZEX , LOCATENAME_SIZEY , 0.0f , 0x00ffffff , 0x00000000 )

	// �J����
	MoveCameraAt( 0 , 844.820f , 792.181f , 1.268f , 0 )	// �����_
	ChangeCameraDistance( 0 , 19.599f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 13.723f , 0 )	// ��{�p
	RotateCamera( 0 , 0.903f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	//�X�L�b�v����
	SetSkipScript("mp1119:EV_LOCATION010_ED")

//�J�n���������܂�-----------------------------------------------

	//-- �J�b�g ----------------------------------------------------------

	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt , INTERPOLATE_SPHERE , 842.274f , 796.841f , 1.268f , 400 )	// �����_
	ExecuteCmd(1001, ChangeCameraDistance , INTERPOLATE_SPHERE , 19.599f , 400 )		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation , INTERPOLATE_SPHERE , 20.829f , 400 )	// ��{�p
	ExecuteCmd(1003, RotateCamera , INTERPOLATE_SPHERE , 255.684f , 400 )				// �p�x

	// �t�F�[�h�C��
	FadeIn(FADE_BLACK,FADE_NORMAL)

	CallFunc("system:LocateName_Anime")

	// �J�����҂�
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp1119:EV_LOCATION010_ED")
}
function "EV_LOCATION010_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	ResetChrPos((CHRTYPE_MONS | RESET_POS))

	//�t���O
	SetFlag(GF_LOCATION10, 1)	//�ł��グ��ꂽ��[

	//�}�b�v�}�[�J�[
	DelMapMarker( SMI_SUBEVENT ,PAGE_F010, MARKER_EV_LC_MP1119, 0, 0)	//���P�@�F�ł��グ��ꂽ��[
	SetMapMarker( SMI_LOCATION ,PAGE_F010, MARKER_EV_LC_MP1119, 842.68f,792.22f,-2.67f, 842.68f,792.22f,LOCATION_MP1119,MN_F_MP1119,0)		//���P�@�F�ł��グ��ꂽ��[

	//�~�j�}�b�v�J��
	OpenMinimap(PAGE_F010,0 ,840.94f, 791.28f ,100 )

	CallFunc("mp1119:init")

	//�L�����Ĕz�u�ƁA�����X�^�[�����ʒu�ɖ߂��A�J���������Z�b�g
	MoveCameraAt( 0 , 837.143f , 777.357f , 2.335f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 14.000f , 0 )	// ��{�p
	RotateCamera( 0 , -25.519f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	//�C�x���g��̍Ĕz�u�ʒu
	SetChrPos("LEADER", 837.14f, 777.36f, 0.47f )
	Turn("LEADER" ,-152.60f, 360.0f)

	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	// �|�[�g���[�g�����[�X
	Portrait_Close(-1)
	Portrait_Unload(-1)

	//�J�����ʒu���Aor�����ʒu�ݒ�
	CallFunc("system:camera_reset")

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	SetFlag(SF_ALLMUTEKI,0)		//���G�n�e�e
	ResetStopFlag(STOPFLAG_PC)
	ResetStopFlag(STOPFLAG_EVENT)
//�I�����������܂�----------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//�����C���C�x���g�Z�N�V����

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function "EV_OpenChack"
{
	SetStopFlag(STOPFLAG_EVENT)
	SaveCamera()

	TalkPopup(UNDEF,0,3,STOPPER_PPOSX,STOPPER_PPOSY,0)
	{
		"#7C�Y���҂Ǝv�킵���l�����Ȃ�ł���B"		//�����@�X�g�b�p�[�p���b�Z�[�W
		"#7C���������Ă݂悤���H"
	}

	//���[�V�������I������܂őҋ@
	WaitAnimation2( "PLAYER1" ,-1 ,-1 ,ANI_WAIT ,1 )

	ResetMotion( "ALL" , 0 )
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	WaitPrompt()
	WaitCloseWindow()

	//�I����
	SetFlag(TF_MENU_SELECT,0)
	MenuReset()
	MenuType(MENUTYPE_POPUP)
	MenuAdd(1,"����������")
	MenuAdd(-1, "��ɂ���")
	MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 1)
	WaitMenu(0)
	MenuClose(10,0)

	//��������������������������������������������������
	//	�ː���������
	if (FLAG[TF_MENU_SELECT] == 1){

		FadeOut(FADE_BLACK,FADE_FAST)
		WaitFade()

		EventCue("mp1119:EV_M02S701")

	}
	//��������������������������������������������������
	//	�ˌ�ɂ���
	else {

		CrossFade(FADE_NORMAL)

		// PLAYER2��PLAYER3�̂ǂ��炩��PLAYER1�����苗������Ă�����
		// PLAYER1�̂��΂Ƀ��[�v����
		SetFlag( TF_CHECK_DISTANCE, 1 )
		SetFlag( TF_CHECK_DISTANCE2, 1 )
		if( WORK[WK_ISEXIST_PLAYER2] )
		{
			CheckChrDistance( TF_CHECK_DISTANCE, "PLAYER1", "PLAYER2", 0, STOPPER_WARPDIS )
		}
		if( WORK[WK_ISEXIST_PLAYER3] )
		{
			CheckChrDistance( TF_CHECK_DISTANCE2, "PLAYER1", "PLAYER3", 0, STOPPER_WARPDIS )
		}
	
		if( FLAG[TF_CHECK_DISTANCE]==0 || FLAG[TF_CHECK_DISTANCE2]==0)
		{
			ChrAlpha( "PLAYER2" , 0.0f , 0 )
			ChrAlpha( "PLAYER3" , 0.0f , 0 )
			ResetPartyPos()
		}

		if( FLAG[TF_CHECK_DISTANCE]==0 || FLAG[TF_CHECK_DISTANCE2]==0)
		{
			ExecuteCmd(3, ChrAlpha, "PLAYER2" , 1.0f , 10 )
			ExecuteCmd(4, ChrAlpha, "PLAYER3" , 1.0f , 10 )
			WaitThread(3)
			WaitThread(4)
		}

		//�Ĕz�u	
		SetChrPos("LEADER",891.67f,627.97f,10.56f)
		Turn("LEADER",101.94f,360.0f)

		ResetPartyPos()
		ResetFollowPoint()
	
		RestoreCamera(0,0)
		ResetCameraObserver(0)
		ResetCameraZPlane()

		WaitFade()

	}
	//��������������������������������������������������

	ResetStopFlag(STOPFLAG_EVENT)
}

//������������������������������������������������������������
//���f�B�i�ɏo�(mp1119)
//������������������������������������������������������������
function "EV_M02S700"		// �f�B�i�𔭌�����
{
//�J�n������������----------------------------------------------------

	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	SaveEventState()
	SaveCamera()

	ClearDebris()
	ResetMotion( "ALL" , 1 )
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("Hummel", CWK_DEFAULT_SKIPNODE_OFF, 1)

	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI )
	SetChrPos("ADOL", 858.51f, 627.49f, 10.20f)
	Turn("ADOL", -145.62f, 360.0f)
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)


	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI )
	SetChrPos("LAXIA", 859.54f, 627.34f, 10.17f)
	Turn("LAXIA", -146.98f, 360.0f)
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr("LAXIA" , "dina")

	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI )
	SetChrPos("SAHAD", 859.89f, 626.10f, 10.33f)
	Turn("SAHAD", -141.95f, 360.0f)
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr("SAHAD" , "dina")

	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI )
	SetChrPos("HUMMEL", 856.97f, 626.83f, 10.37f)
	Turn("HUMMEL", -140.69f, 360.0f)
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)

	MoveCameraAt( 0 , 861.422f , 631.661f , 12.308f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.241f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -7.974f , 0 )	// ��{�p
	RotateCamera( 0 , 131.339f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 3.000, 80.000 ,2.000 ,0.450 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetSkipScript("mp1119:EV_M02S700_ED")

//�J�n���������܂�-----------------------------------------------

	//�@�@�Z�H�J�̏o����������ďo�Ă���S�l�B
	//�@�@�ڂ̑O�̊C�݂��L�����Ă���i�ς�������B

	// �ړ�
	ExecuteCmd(3, MoveTo, "SAHAD", 862.38f, 630.35f, 9.72f, 0.1f, 0.22f)
	Wait(3)
	ExecuteCmd(2, MoveTo, "LAXIA", 861.71f, 631.52f, 9.63f, 0.1f, 0.22f)
	Wait(3)
	ExecuteCmd(1, MoveTo, "ADOL", 860.75f, 631.80f, 9.65f, 0.1f, 0.22f)
	Wait(3)
	ExecuteCmd(4, MoveTo, "HUMMEL", 859.52f, 631.67f, 9.75f, 0.1f, 0.22f)

	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 861.422f , 631.661f , 11.268f , 60 )

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()
	
	// �ړ��҂�
//	WaitThread(1)
//	WaitThread(2)

	// �J�����҂�
	WaitThread(1000)
	
	//Wait(10)

	// �J�b�gX ----------------------------------------------------------------------------------------

	CrossFade(FADE_NORMAL)

	// �J����
	MoveCameraAt( 0 , 861.472f , 631.589f , 11.528f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.721f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 6.351f , 0 )	// ��{�p
	RotateCamera( 0 , 348.672f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 150.000 ,2.000 ,0.450 ,0.700)

	// �J�����ړ�
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 322.895f  , 450 )

	// �t�F�[�h�҂�
	//Wait(FADE_NORMAL)

	WaitThread(3)
	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// ���荘
	Wait(15)
	PlayVoice(Y8V_1414,"SAHAD",100)	//���H�i�^��j

	// �T�n�h
	TalkPopup("SAHAD",0,1,0,0,0) {
		"#000e#000m���H�@�����́c�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	WaitThread(4)
	ChangeAnimation("HUMMEL", "ANI_EV_UDEGUMI_S", -1, 1)

	//	"HUMMEL"
	TalkPopup("HUMMEL",0,1,0,0,0) {
		"#000e#000m�ǂ����C�݂֏o���悤���ȁc�c"
		"�C��2�s��"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookSpd("LAXIA", 0.08f, 0.08f, 0.08f)// �������߂Ɏ����
	Look("LAXIA", -50.0f, 0f)

	//	"LAXIA"
	TalkPopup("LAXIA",0,2,0,0,0) {
		"#000e#000m���p���炷��Ɓc�c"
		"�����͓��̓��[�ɂȂ�͂��ł��B"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_E", -1, 1 )	// ���荘

	//�@�@���N�V���A���͂����񂵂āu�I�v�G���[�V�����B
	Look("LAXIA", 40.0f, 0f)
	Wait(40)
	EmotionEx("LAXIA", 0.00f, EMO_EX, 0, 5, 1, 1, 1.0f )	// �u�I�v
	LookSpd("LAXIA", LOOKSPD_DEFAULT, LOOKSPD_DEFAULT, LOOKSPD_DEFAULT)
	Wait(10)
	LookChr("LAXIA", "Dina")
	TurnToChr("LAXIA", "Dina", 8.0f)
	Wait(35)

	TalkPopup("LAXIA",0,2,0,0,0) {
		"#000e#000m�A�h���E�N���X�e�B���A"
		"�������ɒN������悤�ł��I"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�J�����A�X�N���[�����ĕl�ӂ�
	//�@�@�����s�����Ă���f�B�i��������B
	
	// �J������~
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	
	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 861.403f , 631.008f , 11.668f , 50 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.721f , 50 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 3.773f , 50 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 291.960f , 50 )
	
	
	TurnToChr("ADOL", "Dina", 8.0f)
	Look("ADOL", 30.0f, 0f)
	TurnToChr("SAHAD", "Dina", 8.0f)
	Look("SAHAD", 20.0f, 0f)
	Look("HUMMEL", 25.0f, 0f)
	Wait(20)

	// �J�����҂�
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	TalkPopup("HUMMEL",0,1,0,0,0) {
		"#000e#000m#0L�c�c�c�c�c�c�c�c�c�c�c�c�c�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	//�@�@�����ň�U���싖�B
	//�@�@�f�B�i�ɋ߂Â��ƃC�x���g���ĊJ����B

	//�I��������������----------------------------------------------------
	CallFunc("mp1119:EV_M02S700_ED")
}

function "EV_M02S700_ED"											//�C�x���g�X�L�b�v�p�ɏI��������ʂ�function�Ƃ��ėp�ӂ��܂��B
{
	SetSkipScript("")												//�I�������̓X�L�b�v�֎~

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�����X�^�[�𕜋A
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//�L�����N�^�[������
	CallFunc("system:reset_chrmot_ADOL")
	CallFunc("system:reset_chrmot_LAXIA")
	CallFunc("system:reset_chrmot_SAHAD")
	CallFunc("system:reset_chrmot_HUMMEL")

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam( -1 )

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�t���O����
	SetFlag( GF_02MP1119_LOOK_DINA , 1 )			// �f�B�i�𔭌�����
	//SetDiaryFlag( DF_JOIN_DINA, 1 )			//�����Ճ����F�f�B�i���~�o�����B
	////SetDiaryCharaFlag( DRCHA_DINA, DRCHA_FLAG_OPEN, 1 )		//���l�������F�������ɓo�^�i�f�B�i�j

	//SetFlag( GF_FAME_POINT, (FLAG[GF_FAME_POINT] + 2) )			//�f�B�i����	�����l+2

	CallFunc( "mp1119:init" )

	//�C�x���g��̍Ĕz�u�ʒu
	SetChrPos("LEADER", 866.08f, 633.70f, 9.19f)
	Turn("LEADER", -80.93f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//�J�����ʒu���Aor�����ʒu�ݒ�
	MoveCameraAt( 0 , 866.080f , 633.700f , 11.057f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 14.000f , 0 )	// ��{�p
	RotateCamera( 0 , -90.861f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	CallFunc("system:camera_reset")

	//�g���t�B�[����
	GetTrophy("TROPHY_SCENE_C2_VALLEY_END")		//�Â��N�H�J			�s�N�H�J�t�𔲂����B

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}

function "EV_M02S701"
{
//�J�n������������----------------------------------------------------
	SetStopFlag(STOPFLAG_EVENTIMPOSE)

	FadeOut(FADE_BLACK,0)
	WaitFade()
	SaveEventState()
	CallFunc("rng:0412")
	SetFlag(GF_TBOX_DUMMY062,1)
	CallFunc("mp1119:init")
	ResetStopFlag(STOPFLAG_EVENTIMPOSE)
	RestoreEventState()
	SetChrPos("Dina", -100000.0f, 0.0f, 0.0f)
	FadeIn(FADE_BLACK,FADE_NORMAL)
}


function "EV_M02S701_old"		// �f�B�i����������
{
//�J�n������������----------------------------------------------------

	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�				
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrWork("Dina", CWK_DEFAULT_SKIPNODE_OFF, 1)

	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI )
	SetChrPos("ADOL", 893.12f, 629.26f, 10.56f)
	Turn("ADOL", -102.36f, 360.0f)
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr("ADOL" , "dina")

	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI )
	SetChrPos("LAXIA", 894.21f, 628.15f, 10.56f)
	Turn("LAXIA", -105.02f, 360.0f)
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr("LAXIA" , "dina")

	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI )
	SetChrPos("SAHAD", 892.38f, 627.97f, 10.56f)
	Turn("SAHAD", -112.35f, 360.0f)
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr("SAHAD" , "dina")

	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI )
	SetChrPos("HUMMEL", 891.83f, 629.67f, 10.56f)
	Turn("HUMMEL", -90.02f, 360.0f)
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)

	SetChrInfoFlag( "Dina" , INFOFLAG_NOCHRATARI )
	SetChrPos("Dina", 898.21f, 629.92f, 10.56f)
	Turn("Dina", -151.21f, 360.0f)
	ChangeSubAnimation("Dina",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Dina",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("Dina",SUBMOT_EXT1,ANI_E_LOOKC,1)

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

//	//�J�����ݒ�
//	MoveCameraAt( 0 , 898.679f , 630.359f , 12.368f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 1.280f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , -2.142f , 0 )	// ��{�p
//	RotateCamera( 0 , 174.480f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 45.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B
	MoveCameraAt( 0 , 898.679f , 630.359f , 11.908f , 0 )	// �����_
	ChangeCameraDistance( 0 , 1.030f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -2.142f , 0 )	// ��{�p
	RotateCamera( 0 , 174.501f , 0 )				// �p�x
	ChangeCameraPers( 0 , 45.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B


	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,0.000 ,0.450 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetSkipScript("mp1119:EV_M02S701_ED")

//�J�n���������܂�-----------------------------------------------

	// �J�b�gX ----------------------------------------------------------------------------------------

	ExecuteCmd(1000, ChangeCameraDistance, INTERPOLATE_SPHERE, 1.280f, 60)		// �����_

//	//�J�����ݒ�
//	MoveCameraAt( 0 , 898.679f , 630.359f , 11.908f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 1.280f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , -2.142f , 0 )	// ��{�p
//	RotateCamera( 0 , 174.480f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 45.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	ChangeSubAnimation("Dina", SUBMOT_EYE, ANI_E_SAD, 1)	// ��

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	FadeBGM(60,30)

	WaitThread(1000)

	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"#4378V�́[���A�ǂ��Ȃ񂾂�R�R�c�c"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")
	
	ChangeAnimation( "Dina", "ANI_EV_BORI", -1, 1 )	// ������
	
	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"#4379V#061e#000m�񑩂��Ă����k��"
		"�����͂Ɓ[�����ɉ߂��Ă邵�c�c"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")
	
	
	// �J�b�gX -----------------------------------------------------------------------------------------

	//�@�@�u�c�u�c�ꂭ�f�B�i�ɋ߂Â��ăt���[���C������
	//�@�@�A�h���A���N�V���A�T�n�h�A�q���������B

	CrossFade(FADE_CROSS)

	MoveCameraAt( 0 , 894.601f , 626.577f , 12.508f , 0 )	// �����_
	ChangeCameraDistance( 0 , 2.940f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 5.021f , 0 )	// ��{�p
	RotateCamera( 0 , 348.845f , 0 )				// �p�x
	ChangeCameraPers( 0 , 40.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,0.000 ,0.450 ,0.500)
	
	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 897.009f , 629.162f , 11.988f , 70 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 2.940f , 70 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 3.875f , 70 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 339.678f , 70 )

	// �ړ�
	ExecuteCmd(1, MoveTo, "LAXIA", 896.45f, 629.26f, 10.56f, 0.1f, 0.21f)
	Wait(3)
	ExecuteCmd(2, MoveTo, "ADOL", 896.21f, 630.13f, 10.56f, 0.1f, 0.21f)
	Wait(3)
	ExecuteCmd(3, MoveTo, "SAHAD", 894.90f, 629.07f, 10.56f, 0.1f, 0.21f)
	Wait(3)
	ExecuteCmd(4, MoveTo, "HUMMEL", 894.72f, 630.93f, 10.56f, 0.1f, 0.21f)

	// �ړ��҂�
	WaitThread(1)
	WaitThread(2)

	// �J�����҂�
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	ChangeAnimation( "LAXIA", "ANI_EV_TEMUNE_S", -1, 1 )	// �苹����

	// ���N�V��
	TalkPopup("LAXIA",0,1,0,0,0) {
		"#000e#000m���́A���݂܂���c�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�f�B�i�Ɂu�I�v�G���[�V�����\���B
//	EmotionEx("Dina", 0.00f, EMO_EX, 0, 5, 1, 1, 1.0f )	// �u�I�v
	ChangeSubAnimation("Dina", SUBMOT_EYE, ANI_E_CLOSE_E, 1)
//	Wait(30)
	ChangeAnimation( "Dina", "ANI_EV_SUP_S", -1, 1 )	// �����A�y���̂�����

	EarthQuake( 0.02f , 0.02f , 10 )	// �c�h�ꕝ, ���h�ꕝ, ����

	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"#16S#070e#000m���ЂႠ�I�I"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	ChangeAnimation( "Dina", "ANI_EV_SUP_E", -1, 1 )	// �����A�y���̂�����
	WaitAnimation2("Dina", -1, 1, "ANI_EV_SUP_E", 0)

	LookChr("Dina", "LAXIA")
	Turn("Dina", 66.67f, 8.0f)
	Wait(10)

	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"#050e#000m#16S���A����I�H�@�r�b�N���������I"
		"���l2�s��"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	ChangeAnimation( "LAXIA", "ANI_EV_TEMUNE_E", -1, 1 )	// �苹����

	//	"LAXIA"
	TalkPopup("LAXIA",0,1,0,0,0) {
		"#000e#000m�������Ă��܂��āA���߂�Ȃ����B\p"
		"���Ȃ��͊m�������o���f�B�A����"
		"����Ă������ł���ˁH"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"#000e#000m���A���������ǁc�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�f�B�i�ɂo�`�G���[�V�����B
	EmotionEx("Dina", 0.00f, EMO_PA, 0, 5, 1, 1, 1.0f )	// �uPA�v
	Wait(35)

	ChangeAnimation( "Dina", "ANI_EV_TEMUNE_S", -1, 1 )	// �苹����

	//	���l���̏���
	TalkPopup("Dina",0,2,0,0,0) {
		"#000e#000m���A���Ȃ������A"
		"���������ď����ɂ��Ă��ꂽ�́H"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("ADOL", "LAXIA")
	LookChr("LAXIA", "ADOL")
	Wait(30)

	//�@�@��������킹��A�h���A���N�V���A�T�n�h�B
	//�@�@��ʃt�F�[�h�A�E�g�����ĈÓ]�̂܂܃��b�Z�[�W�\���B
	
	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()

	//	�e�L�X�g
	SetName("")
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0) {
		"#7C�A�h�������͈�ʂ��"
		"#7C�󋵂������ɐ��������c�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	// �J�b�gX -----------------------------------------------------------------------------------------

	//�@�@��ʃt�F�[�h�C�����āA�����o�[�Ĕz�u�B
	SetChrPos("ADOL", 896.33f, 630.07f, 10.56f)
	Turn("ADOL", 2.94f, 360.0f)

	SetChrPos("LAXIA", 895.73f, 628.21f, 10.56f)
	Turn("LAXIA", -122.75f, 360.0f)

	SetChrPos("SAHAD", 895.10f, 629.90f, 10.56f)
	Turn("SAHAD", -56.70f, 360.0f)

	SetChrPos("HUMMEL", 895.85f, 627.35f, 10.56f)
	Turn("HUMMEL", -148.29f, 360.0f)

	SetChrPos("Dina", 897.22f, 629.27f, 10.56f)
	Turn("Dina", 72.55f, 360.0f)

	ChangeAnimation("LAXIA", "ANI_WAIT", -1, 1)
	ChangeAnimation("HUMMEL", "ANI_EV_UDEGUMI", -1, 1)
	ChangeSubAnimation("Dina", SUBMOT_EYE, ANI_E_SAD, 1)	// ��

	LookChr("ADOL", "Dina")
	LookChr("LAXIA", "Dina")
	LookChr("SAHAD", "Dina")
	LookChr("HUMMEL", "Dina")
	LookChr("Dina", "LAXIA")

//	MoveCameraAt( 0 , 895.704f , 628.912f , 12.121f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 2.120f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , 5.349f , 0 )	// ��{�p
//	RotateCamera( 0 , 286.169f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	MoveCameraAt( 0 , 895.724f , 628.841f , 12.022f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 2.812f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , 5.347f , 0 )	// ��{�p
//	RotateCamera( 0 , 286.126f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

//	// �J�����ړ�
//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 895.631f , 629.163f , 12.121f , 80 )
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.232f , 80 )
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 5.347f , 80 )
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 286.109f , 80 )
//
//	//MoveCameraAt( 0 , 895.631f , 629.163f , 12.121f , 0 )	// �����_
//	//ChangeCameraDistance( 0 , 3.232f , 0 )		// ��{����
//	//ChangeCameraElevation( 0 , 5.346f , 0 )	// ��{�p
//	//RotateCamera( 0 , 286.109f , 0 )				// �p�x
//	//ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
//	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	//RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	//// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	MoveCameraAt( 0 , 895.631f , 629.163f , 12.121f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.232f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 5.347f , 0 )	// ��{�p
	RotateCamera( 0 , 286.109f , 0 )				// �p�x
	ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B


	FadeIn(FADE_BLACK, 45)
	WaitFade()

//	// �J�����҂�
//	WaitThread(1000)
//	WaitThread(1001)
//	WaitThread(1002)
//	WaitThread(1003)

	ChangeAnimation( "Dina", "ANI_EV_TEMUNE_E", -1, 1 )	// �苹����

	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"���l�����āc�c����ȎE���ȁc�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	WaitAnimation2("Dina", -1, 1, "ANI_EV_TEMUNE_E", 0)

	//�@�@�K�b�N�����Ȃ����f�B�i�B
	ChangeAnimation( "Dina", "ANI_EV_GAKKARI_S", -1, 1 )	// ��������
	LookReset("Dina")

	//	���l���̏���
	TalkPopup("Dina",0,2,0,0,0) {
		"#061e#000m�c�c�ǂ����Ă����̂�I"
		"���l2�s��2"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	//	"LAXIA"
	TalkPopup("LAXIA",0,1,0,0,0) {
		"#000e#000m���c�c"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	//	���l���̏���
	SetName("���l���̏���")
	TalkPopup("Dina",0,2,0,0,0) {
		"���̃f�B�i�l�̈ꐢ����������"
		"�古�k���������ɂ��Ă��ꂿ����āc�c"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	ChangeAnimation( "LAXIA", "ANI_EV_TEMUNE_S", -1, 1 )	// �苹����

	//	"LAXIA"
	TalkPopup("LAXIA",0,1,0,0,0) {
		"#000e#000m��A�悭������܂��񂪁A"
		"�S���͂��@�����܂��c�c"
	}
	WaitPrompt()
	WaitCloseWindow()

	// �J�b�gX ----------------------------------------------------------------------------------------

	// �N���X�t�F�[�h
	CrossFade(FADE_NORMAL)
	
	// �J����
	MoveCameraAt( 0 , 896.838f , 629.186f , 11.921f , 0 )	// �����_
	ChangeCameraDistance( 0 , 1.241f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -0.956f , 0 )	// ��{�p
	RotateCamera( 0 , 284.985f , 0 )				// �p�x
	ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	
	// �t�F�[�h�҂�
	Wait(FADE_NORMAL)


	ChangeAnimation( "Dina", "ANI_EV_GAKKARI_E", -1, 1 )	// ��������
	LookReset("Dina")
	Look("Dina", 0.0f, -10.0f)	// ���ނ�

	//	"Dina"
	TalkPopup("Dina",0,2,0,0,0) {
		"#4380V#011e#080m�ӁA�ӁA�ӁA�ӂӁc�c\p"
		"#4381V#080m�㓙����Ȃ��c�c"
		"����͂����ƃA�^�V�ւ̒����ˁI"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(15)
	
	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 896.838f , 629.186f , 11.921f , 340 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.241f , 340 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -7.831f , 340 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 313.642f , 340 )

	ChangeSubAnimation("Dina",SUBMOT_EYE,ANI_E_ANGER_CLOSE_E,1)

	VisualName("visual/chrname/cn_c111.itp", VN_NAMEVOICE, VN_CHRNAME_LB_X, VN_CHRNAME_LB_Y,VN_NPCNAME_TIME)	// �f�B�i
	Wait(60)

	//�������I����
	//��SE�������R�}���h�u���p
	SetFlag(TF_MENU_SELECT,0)
	MenuReset()
	MenuAdd( 1 , "" )
	MenuOpen( TF_MENU_SELECT , 0 ,0 , 0 , 0 , 0 , 0 )
	WaitMenu(VN_NPCNAME_SKIP) //�E�F�C�g���������l
	MenuClose(0,0)

	if(FLAG[TF_MENU_SELECT] == 1 )
	{
		CrossFade(FADE_FAST)
		VisualNameEnd()
		StopThread(1000)
		StopThread(1001)
		StopThread(1002)
		StopThread(1003)

		MoveCameraAt( 0 , 896.838f , 629.186f , 11.921f , 0 )	// �����_
		ChangeCameraDistance( 0 , 1.241f , 0 )		// ��{����
		ChangeCameraElevation( 0 , -7.831f , 0 )	// ��{�p
		RotateCamera( 0 , 313.642f , 0 )				// �p�x
		ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
		SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
		RollCamera( 0 , 0.0f , 0 )				// ���[����]
		// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

		Wait(FADE_FAST)
	}
	else
	{
		Wait(30)
	}

	Wait(10)
	Look("Dina", 0.0f, 0.0f)	// ���ނ��߂�

	//	"Dina"
	TalkPopup("Dina",0,2,0,0,0) {
		"#4382V#042e#020m�����Ȃ�����A���̕Y�����Ƃ���"
		"�����𐬌������Ă݂����I"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)

	// �J�b�gX ----------------------------------------------------------------------------------------

//	StopThread(1000)
//	StopThread(1001)
//	StopThread(1002)
//	StopThread(1003)

	// �N���X�t�F�[�h
	CrossFade(FADE_CROSS)
	
	// �J������~
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	
	ChangeSubAnimation("Dina",SUBMOT_MOUTH,ANI_M_SMILE,1)	
	
	// �J����
	MoveCameraAt( 0 , 895.813f , 629.225f , 12.081f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.161f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 10.503f , 0 )	// ��{�p
	RotateCamera( 0 , 283.279f , 0 )				// �p�x
	ChangeCameraPers( 0 , 35.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// �t�F�[�h�҂�
	Wait(FADE_CROSS)
	
	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// ���荘

	//	"SAHAD"
	TalkPopup("SAHAD",0,1,0,0,0) {
		"#000e#000m����Ⴀ�S�ӋC�͂����񂾂��A"
		"�����ƌ����Ă��ȁc�c\p"
		"���V��S���Y���҂�����A"
		"�N�����Ȃ񂩎����ĂȂ����H"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookChr("Dina", "SAHAD")

	//	"Dina"
	TalkPopup("Dina",0,2,0,0,0) {
		"#011e#000m���ꂪ�ǂ��������Č����́H"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)
	LookReset("Dina")
	ChangeAnimation( "Dina", "ANI_EV_JIDANDA", -1, 1 )	// �ǂ���

	EarthQuake( 0.02f , 0.02f , 10 )	// �c�h�ꕝ, ���h�ꕝ, ����

	//	"Dina"
	TalkPopup("Dina",0,2,0,0,0) {
		"#16S#030e#000m���̃f�B�i�l��"
		"#16S�h�����������Ȃ߂Ă񂶂�Ȃ����I"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�n�c���𓥂ނ悤�ɚV���؂�f�B�i�ɑ΂���
	//�@�@�A�h���A���N�V���A�T�n�h�ɗ�⊾�G���[�V�����B

	EmotionEx("ADOL", 0.00f, EMO_TARA, 0, 5, 1, 1, 1.0f )	// �u��⊾�v
	EmotionEx("LAXIA", 0.00f, EMO_TARA, 0, 5, 1, 1, 1.0f )	// �u��⊾�v
	EmotionEx("SAHAD", 0.00f, EMO_TARA, 0, 5, 1, 1, 1.0f )	// �u��⊾�v
	Wait(55)
	
	//�@�@��ʃt�F�[�h�A�E�g�A�Ó]�̂܂܈ȉ��̃��b�Z�[�W��\���B

	StopBGM(120)
	SetEnvSEPlayState(-1, 0)	//��SE�S��~

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	//	�e�L�X�g
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0) {
		"#7C�A�h�������͂�������"
		"#7C���������f�B�i���Ȃ��߂������c�c\p"
		"#7C�s��Ȗ�]�Ƌ�s�𕷂������Ȃ���A"
		"#7C�ޏ���Y�����ɑ���͂���̂ł������B"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)

	PlaySE(SE_PARTYIN, 100, 0, 0, 0, 1.0f, 0)	//���Ԃɉ����
	TalkPopup(UNDEF,0,5,0,0,0)
	{
		"#8S"
		"#-1W#4C�f�B�i���Y�����ɎQ�����邱�ƂɂȂ����I#10W" 
		"#8S"
	}
	Wait(10)
	WaitPrompt()
	WaitCloseWindow()

	//�@�@���싖�B

	//�I��������������----------------------------------------------------
	CallFunc("mp1119:EV_M02S701_ED")
}

function "EV_M02S701_ED"											//�C�x���g�X�L�b�v�p�ɏI��������ʂ�function�Ƃ��ėp�ӂ��܂��B
{
	SetSkipScript("")												//�I�������̓X�L�b�v�֎~

	//�C�x���g�O�̃L�������𕜋A											//���[�V�����͕��A���Ȃ��̂ňȉ��Ōʂɏ��������܂��B
	RestoreEventState()

	//�B�������̂𕜋A														//�K�v�Ȏ��Ɏ��s���Ă��������B
	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//�L�������[�V����������												//NPC��function�͂Ȃ��̂Ōʂɓ��́B
	CallFunc("system:reset_chrmot_ADOL")
	CallFunc("system:reset_chrmot_LAXIA")
	CallFunc("system:reset_chrmot_SAHAD")
	CallFunc("system:reset_chrmot_HUMMEL")
	CallFunc("system:reset_chrmot_Dina")

	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam( -1 )

	EventAreaEnable( "evc_M02S701" , 0 )
	SetChrPos("Dina",-100000.00f,00.00f,00.00f)

	//�t���O
	CallFunc("rng:0412")
    //SetFlag( GF_02MP1119_JOIN_DINA , 1 ) // Meet Dina
	SetFlag(GF_TBOX_DUMMY062,1)

	//�}�b�v�}�[�J�[
	DelMapMarker( SMI_SYMBOL,PAGE_F010,MARKER_EV_M02S701, 0, 0)

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

//	CallFunc("mp1119:init" )

//	SetChrPos("LEADER",897.47f,626.27f,10.56f)
//	Turn("LEADER",-114.45f,360.0f)
//	ResetPartyPos()
//	ResetFollowPoint()
//	Wait(1)
//
//	//�J�����ʒu���A
//	MoveCameraAt( 0 , 865.200f , 640.770f , 10.270f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , 14.000f , 0 )	// ��{�p
//	RotateCamera( 0 , -34.608f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 0.0f , 0 )				// ���[����]
//	CallFunc("system:camera_reset")

	SetFlag(TF_LOADING_TIPS_OFF, 1)	//NowLoading ���� Tips �\�����J�b�g

	StopBGM(60)
	FadeBGM(100,0)

	// �f�B�i�~�o��̓C�x���g�ŏW���֖߂�
	// �ȉ��̃T�u�C�x���g�ɂȂ�B
	LoadArg("map/mp1201/mp1201.arg")
	EventCue("mp1201:SubEV_Help_Trade")

	ResetStopFlag(STOPFLAG_EVENT)

//	FadeIn(FADE_BLACK, FADE_NORMAL)
//	WaitFade()


//�I�����������܂�----------------------------------------------------

}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//���T�u�C�x���g�Z�N�V����

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//������������������������������������������������������������
//���}�X�^�[�R���O�̃��b�Z�[�W����
//������������������������������������������������������������
function "Speedrun_Monkey2"
{
	//���N�G�X�g�B���� && !�u���E�Ő퓬���I��点���v

	//�@�@�}�X�^�[�R���O�ɘb��������ƁA�C�x���g�J�n�B
	//�@�@�}�X�^�[�R���O�̑O�ɁA�p�[�e�B�����o�[�S����z�u����B

	//	�ˁ��@�Ő퓬���I��点��

//�J�n������������----------------------------------------------------


	CallFunc("system:party_reset")
	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",791.63f,784.05f,3.31f)
	Turn("ADOL",93.56f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",790.31f,784.37f,3.33f)
	Turn("RICOTTA",100.00f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",791.63f,783.17f,3.35f)
	Turn("LAXIA",118.85f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",791.68f,785.41f,3.26f)
	Turn("SAHAD",85.92f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",793.06f,784.85f,3.26f)
	Turn("HUMMEL",91.36f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",792.78f,783.34f,3.32f)
		Turn("DANA",106.93f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",785.02f, 785.21f, 3.41f)
	Turn("Monkey",-78.27f,360.0f)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookReset( "Monkey" )

	LookChr("ADOL", "Monkey")
	LookChr("LAXIA", "Monkey")
	LookChr("SAHAD", "Monkey")
	LookChr("RICOTTA", "Monkey")
	LookChr("HUMMEL", "Monkey")
	LookChr("DANA", "Monkey")

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 789.293f , 785.708f , 5.415f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -3.352f , 0 )	// ��{�p
	RotateCamera( 0 , 42.798f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetFlag(TF_MENU_SELECT,0)
	SetSkipScript("mp1119:Speedrun_Monkey2_ED")

//�J�n���������܂�-----------------------------------------------

	Wait(10)

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	//	�ː퓬�\�ȃ^�C�~���O�����A���n�}���S�[���������Ă��Ȃ��ꍇ
	if( ALLITEMWORK[ICON3D_US_MANGO_S] == 0 )	//�u���n�}���S�[�v�������Ă��Ȃ� FLAG[GF_NPC_5_02_GOTO_BAHA] &&			//����ܕ��A�o�n�̓��Ɍ�����
	{
		//�@�@�����ڂ���Ď��U��B
		ChangeSubAnimation("Monkey", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
		HeadNo("Monkey" , 1 , 25)
		Wait(30)
		
		TalkPopup("RICOTTA",0,2,0,0,0)
		{
			"#000e#000m������[�����Ă�B"
			"�w��V�������҂͑���ɂ��ʁx\p"
			"�݂�ȁA�w���n�}���S�[�x�p�ӂ���I"
		}
		WaitPrompt()
		WaitCloseWindow()
		
		SetFlag(TF_MENU_SELECT,0)
	}
	//	�ː퓬�\�ȃ^�C�~���O�A�����n�}���S�[���������Ă���ꍇ
	else if( ALLITEMWORK[ICON3D_US_MANGO_S] )		//�u���n�}���S�[�v�������Ă��� FLAG[GF_NPC_5_02_GOTO_BAHA] &&		//����ܕ��A�o�n�̓��Ɍ�����
	{
		//�@�@�ėp�{�C�X�u���قفi�m��u��������ȁv�j�v���Đ����A
		//�@�@�ȉ��̏����B
		PlayVoice(Y8V_5663,"Monkey",100)
		
		//��������������������������������������������
		//	�ˏ���̂�
		if( !FLAG[GF_SPEEDRUN_SKILL_SAHAD_1ST] )	// ��荞�݃X�L���K���F�A���T�n�h�u�r�}�X�^�[�R���O�@�����b
		{
			TalkPopup("RICOTTA",0,2,0,0,0)
			{
				"#000e#000m�w���͕Ƀq�Q�̒j�A����Ɏ����悤�x"
				"�ƌ����Ă�B"
			}
			WaitPrompt()
			WaitCloseWindow()
			
			PlayVoice(Y8V_1411,"SAHAD",100)	//�K�n�n�i�T���߂ȏ΂��j
		
			TalkPopup("SAHAD",0,2,0,0,0)
			{
				"#000e#000m�K�n�n�A���Ă��Ƃ̓��V���ȁB"
			}
			WaitPrompt()
			WaitCloseWindow()
			
			SetFlag( GF_SPEEDRUN_SKILL_SAHAD_1ST, 1 )	// ��荞�݃X�L���K���F�A���T�n�h�u�r�}�X�^�[�R���O�@�����b
		}
		//��������������������������������������������

		//	�i���[�V����
		TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
		{
			"#7C������[��#2C�u#245I���n�}���S�[�v#7C�����サ�܂����H"
//			"#7C�����シ��ƁA���R�b�^��l��"
			"#7C�����シ��ƁA�T�n�h��l��"			//���󋵓I�ɃT�n�h�̊ԈႢ�Ǝv���܂��̂ŕύX�v���܂���
			"#7C  ������[�Ɛ퓬���s���܂��B"
		}
		WaitPrompt()
		WaitCloseWindow()

		//��������������������������������������������

		//�I����
		SetFlag(TF_MENU_SELECT,0)
		MenuReset()
		MenuType(MENUTYPE_POPUP)
//		MenuAdd(1,"�w���n�}���S�[�x�����シ��")
		MenuAdd(1,"#2C#245I���n�}���S�[#0C�����シ��")
		MenuAdd(2,"��߂Ă���")
		MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 0)
		WaitMenu(0)
		MenuClose(10,0)
		
		//��������������������������������������������
		//	�ˁw���n�}���S�[�x�����シ��
		if (FLAG[TF_MENU_SELECT] == 1)
		{
			//	�A�C�e�����n���b�Z�[�W
			TalkPopup(UNDEF, 0, 5, 0, 0, 0)
			{
				"#8S"
				"#-1W#4C������[��#2C�u#245I���n�}���S�[�v#4C�����サ���I#10W"
				"#8S"
			}
			Wait(10)
			WaitPrompt()
			WaitCloseWindow()
			
			StopBGM(60)
			//�@�@����ʈÓ]���āu�퓬�J�n�C�x���g�v�ɐڑ�
		}
		//	�˂�߂Ă���
		else if (FLAG[TF_MENU_SELECT] == 2)
		{
			//�@�@�����Ȃ��ő��싖�B
		}
		//��������������������������������������������
	}
	//	�ː퓬���ł��Ȃ��^�C�~���O
	//	  �u���@�Ő퓬���I��点���v&& !�u����ܕ��A�o�n�̓��Ɍ������v
	else
	{
		//�@�@�}�X�^�[�R���O���ڂ���Ď��U��B
		ChangeSubAnimation("Monkey", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
		HeadNo("Monkey" , 1 , 25)
		Wait(30)

		TalkPopup("RICOTTA",0,2,0,0,0)
		{
			"#000e#000m������[�����Ă�B"
			"�w�����}���ȁA�������Ղ��Ă���x\p"
			"�݂�ȁA�܂����߂ė���B"
		}
		WaitPrompt()
		WaitCloseWindow()

		SetFlag(TF_MENU_SELECT,0)
	}

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp1119:Speedrun_Monkey2_ED")
}
function "Speedrun_Monkey2_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//	�ˁw���n�}���S�[�x�����シ��

	if( FLAG[TF_MENU_SELECT] == 1 )
	{
		DeleteItem( ICON3D_US_MANGO_S, 1 )			// �w���n�}���S�[�x
			
		//�@�@����ʈÓ]���āu�퓬�J�n�C�x���g�v�ɐڑ�
		EventCue("mp1119:Speedrun_Monkey2_Battle")
	}
	//	�ː퓬���ł��Ȃ��^�C�~���O
	//	�˂�߂Ă���
	//�C�x���g�X�L�b�v
	else
	{
		//�@�@���싖��
		CallFunc("mp1119:init")

		//�C�x���g��̍Ĕz�u
		SetChrPos("LEADER",792.32f,784.01f,3.30f)
		Turn("LEADER",98.79f, 360.0f)
		ResetPartyPos()
		ResetFollowPoint()
		//Wait(1) //�����҂��p

		//�J�����ʒu���A
		//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
		//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
		//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
		//RotateCamera( 0 , 0.0f , 0 )				// �p�x
		//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
		//SetCameraZPlane( 0 , 0.0f )					// ZPlane
		//RollCamera( 0 , 0.0f , 0 )					// ���[����]

		RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
		CallFunc("system:camera_reset")

		ResetStopFlag(STOPFLAG_EVENT)

		FadeIn(FADE_BLACK,FADE_FAST)
		//WaitFade()
	}
//�I�����������܂�----------------------------------------------------
}
//������������������������������������������������������������
//���퓬�J�n�C�x���g
//������������������������������������������������������������
function "Speedrun_Monkey2_Battle"
{
	//���T�n�h�u�r�}�X�^�[�R���O

//�J�n������������----------------------------------------------------

	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",795.94f,783.62f,3.26f)
	Turn("SAHAD",99.11f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookChr( "SAHAD", "Monkey")
	SetChrWork( "SAHAD" , CWK_BATTLEMODE , 1 )

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",785.02f, 785.21f, 3.41f)
	Turn("Monkey",-78.27f,360.0f)
	ChangeAnimation( "Monkey" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookChr( "Monkey", "SAHAD" )

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",788.91f,792.34f,3.06f)
	Turn("ADOL",-9.52f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",788.10f,791.86f,3.09f)
	Turn("RICOTTA",-9.49f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",789.88f,792.42f,3.04f)
	Turn("LAXIA",-9.52f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",787.18f,792.51f,3.17f)
	Turn("HUMMEL",-9.48f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",790.67f,792.71f,3.02f)
		Turn("DANA",-9.52f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 792.945f , 785.087f , 5.167f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -4.078f , 0 )	// ��{�p
	RotateCamera( 0 , 38.179f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
//	SetSkipScript("mp1119:Speedrun_Monkey2_Battle_ED")

//�J�n���������܂�-----------------------------------------------

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	PlayBGM(BGM_BOSS_002, 0)

	//�@�@��ʃt�F�[�h�C�����āA�}�X�^�[�R���O�ƌ��������T�n�h�B
	//�@�@���Ԃ͎��͂ɂ���B

	//�@�@�}�X�^�[�R���O���Њd���[�V����������Đ퓬�J�n�B

	//MTD��SE�炳�Ȃ�
	//SetFlag( SF_NOUSE_MTDSE, 1 )

	ChangeAnimation( "Monkey", "ANI_UNI1", -1, 1 )
	Wait(10)
	PlayVoice(Y8V_5652, "Monkey", 100)	//���ق��������c�i�C�����𗭂߂� 
	Wait(35)

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	WaitAnimation2( "Monkey" , -1, 1, "ANI_UNI1",  0)

	//MTD��SE�炷
	//SetFlag( SF_NOUSE_MTDSE, 0 )

//	TalkPopup("UNDEF",0,0,0,0,0)
//	{
//		"#7C���C�x���g�퓬�p ��C�A�^�����ݒ�"
//	}
//	WaitPrompt()
//	WaitCloseWindow()

//�I��������������----------------------------------------------------
	CallFunc("mp1119:Speedrun_Monkey2_Battle_ED")
}
function "Speedrun_Monkey2_Battle_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�L�����N�^�[������
	CallFunc("system:reset_chrmot_ALL")

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	// �}�X�^�[�R���O����ʊO�Ɉړ�
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	// ���P�[�V��������ł��Ȃ��ꍇ�́A�������񃍃P�[�V����EB��OFF��
	if ( !FLAG[GF_LOCATION10] ) {		// ���P�[�V����010
		EventAreaEnable( "ev2_EV_LOCATION010" , 0 )
	}
		
	//NowLoading ���� Tips �\�����J�b�g
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	EventCue("mp1119:Retry_Speedrun_Monkey2_Battle")
}
// �퓬����
function "Retry_Speedrun_Monkey2_Battle"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//�T�n�h�ЂƂ� -----------------------------------
	SavePartyMember()							// ���݂̃p�[�e�B�Ґ����o����
	// �p�[�e�B�Ґ��\�󋵃o�b�N�A�b�v
	SetFlag(SF_ADOL_JOINOKBK, FLAG[SF_ADOL_JOINOK])
	SetFlag(SF_LAXIA_JOINOKBK, FLAG[SF_LAXIA_JOINOK])
	SetFlag(SF_SAHAD_JOINOKBK, FLAG[SF_SAHAD_JOINOK])
	SetFlag(SF_HUMMEL_JOINOKBK, FLAG[SF_HUMMEL_JOINOK])
	SetFlag(SF_RICOTTA_JOINOKBK, FLAG[SF_RICOTTA_JOINOK])
	SetFlag(SF_DANA_JOINOKBK, FLAG[SF_DANA_JOINOK])
	// �ЂƂ肾���ɂ���
	SetFlag(SF_ADOL_JOINOK, 0)
	SetFlag(SF_LAXIA_JOINOK, 0)
	SetFlag(SF_SAHAD_JOINOK, 1)
	SetFlag(SF_HUMMEL_JOINOK, 0)
	SetFlag(SF_RICOTTA_JOINOK, 0)
	SetFlag(SF_DANA_JOINOK, 0)
	SetPartyMember(PARTY_SAHAD, -1, -1)

	//�{�X�z�u�E�A�j��--------------------------------
	SetChrPos("mons_Monkey",785.02f, 785.21f, 3.41f)
	Turn("mons_Monkey",-78.27f,360.0f)
	ChangeAnimation("mons_Monkey", "ANI_WAIT", -1, 1)

	//PLAYER�z�u--------------------------------------
	SetChrPos("PLAYER1",795.94f,783.62f,3.26f)
	Turn("PLAYER1",99.11f,360.0f)
	//TurnToChr("PLAYER1" , "mons_Monkey" , 360.0f )
	//TurnToChr("mons_Monkey" , "PLAYER1" , 360.0f )

	//�J�����ݒ�--------------------------------------
	// arg�̐ݒ���㏑������
//	SetYs8Camera(7.0f, 60.0f, 10.0f, 0.0f, 0.0f)		//�c�c�{�X���[�`���쐬�҂̎w�肪����Γ���
	MoveCameraAt( 0 , 795.944f , 783.616f , 5.126f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 14.000f , 0 )	// ��{�p
	RotateCamera( 0 , 80.891f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	//�C�x���g�o�g���pCallFunc------------------------
	CallFunc("system:boss_start")						//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���̑�����--------------------------------------
	PlayBGM(BGM_BOSS_002, 15)	//�����ؔŗp��
	MapAnime("CT_EVENT","close")					//�c�c�������Ȃ��X�g�b�p�[�N��
	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 1)			// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j
	SetFlag( GF_QS400_KONG_LV, 1)					// �}�X�^�[�R���O�̃L�������[�h�i1=�T�n�h�j
	SetLevel( "mons_Monkey", 43 )					// �}�X�^�[�R���O��Lv.43
	
	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ResetStopFlag(STOPFLAG_EVENT)
	//------------------------------------------------

	//��������������������������������������������
	//	�ː퓬�ɏ���
	//		Speedrun_Monkey2_Win
	//	�˔s�k
	//		Speedrun_Monkey2_Lose
	//��������������������������������������������
}
// �퓬�s�k���C�x���g
function "Speedrun_Monkey2_Lose"
{
	//���T�n�h�u�r�}�X�^�[�R���O
	//	�˔s�k

//�퓬�I��������������-----------------------------------------------

	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)								//�c�c���G�n�m

	Wait(90)											//�c�c�{�X���S���[�V���������違�h���b�v�A�C�e�����E������
	StopBGM(90)
	Wait(60)

	//�C�x���g�o�g���pCallFunc-------------------------
	CallFunc("system:boss_end")							//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���������E�{�X����-------------------------------
	MapAnime("CT_EVENT","open")							//�c�c�������Ȃ��X�g�b�p�[����
	SetChrPos(mons_Monkey,-100000.00f,0.00f,0.00f)		//�c�c�{�X�������Ȃ��ʒu�ɔ�΂�
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))			//�c�c�U�R�Ȃ炱����

	//���㏈��-----------------------------------------
		////-----------------------------------
		//// �^�C���A�^�b�N��
		//if (FLAG[SF_TIMEATK])
		//{
		//	EndTimeAtk()		// �^�C���A�^�b�N�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		//}
		////-----------------------------------

	FadeOut(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 0)	// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j

//�퓬�I�����������܂�-----------------------------------------------
//�J�n������������-----------------------------------------------

//	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	// �p�[�e�B�Ґ��\�󋵂�߂�
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",792.32f,784.01f,3.30f)
	Turn("SAHAD",98.79f, 360.0f)
	ChangeAnimation( "SAHAD" , "ANI_EV_ZEEWAIT2", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookChr( "SAHAD", "Monkey")

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",785.02f, 785.21f, 3.41f)
	Turn("Monkey",-78.27f,360.0f)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookChr( "Monkey", "SAHAD" )

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",788.91f,792.34f,3.06f)
	Turn("ADOL",-9.52f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",788.10f,791.86f,3.09f)
	Turn("RICOTTA",-9.49f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",789.88f,792.42f,3.04f)
	Turn("LAXIA",-9.52f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",787.18f,792.51f,3.17f)
	Turn("HUMMEL",-9.48f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",790.67f,792.71f,3.02f)
		Turn("DANA",-9.52f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 789.214f , 784.854f , 4.919f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 0.902f , 0 )	// ��{�p
	RotateCamera( 0 , 39.859f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
//	SetSkipScript("mp1119:Speedrun_Monkey2_Lose_ED")
	
//�J�n���������܂�-----------------------------------------------
	
	FadeIn(FADE_WHITE,FADE_NORMAL)
	WaitFade()
	
	//�@�@�T�n�h���G�����Ă���B
	
	TalkPopup("SAHAD",0,1,0,0,0)
	{
		"#000e#000m���ւ��c�c�������Q�������B"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	//	�i���[�V����
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
	{
		"#7C������[�ƍĐ킵�����ꍇ�́A"
//		"#7C�Ăсw���n�}���S�[�x�����サ�Ă��������B"
		"#7C�Ă�#2C�u#245I���n�}���S�[�v#7C�����サ�Ă��������B"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	//�@�@�C�x���g�I���A���싖�B
	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp1119:Speedrun_Monkey2_Lose_ED")
}
function "Speedrun_Monkey2_Lose_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")	

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�t���O����
	SetFlag(SF_BOSS_BATTLE, 0)		//�{�X��I��

	// �}�X�^�[�R���O����ʊO�Ɉړ�
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	CallFunc("mp1119:init")

	//�C�x���g��̍Ĕz�u
	SetChrPos("LEADER",792.32f,784.01f,3.30f)
	Turn("LEADER",98.79f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//�J�����ʒu���A
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
	//RotateCamera( 0 , 0.0f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ���[����]

	RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	PlayBGM(BGM_1119, 0)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}
//������������������������������������������������������������
//���N�G�X�g�B���C�x���g
//������������������������������������������������������������
function "Speedrun_Monkey2_Win"
{
	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)		//���G�n�m

	Wait(30)
	StopBGM(120)
	Wait(90)

	CallFunc("system:boss_end")
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_remove")
	CallFunc("system:party_reset")
	SetStopFlag(STOPFLAG_EVENT)
	
	// adding this line to remove the invisible walls after the fight
	MapAnime("CT_EVENT","open")							//……逃げられないストッパー解除

	// changed CueEvent to CallFunc to prevent softlock
	CallFunc("mp1119:Speedrun_Monkey2_Win_ED")
}

function "Speedrun_Monkey2_Win_old"
{
	//���T�n�h�u�r�}�X�^�[�R���O
	//	�ː퓬�ɏ���

//�퓬�I��������������-----------------------------------------------

	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)								//�c�c���G�n�m

	Wait(90)											//�c�c�{�X���S���[�V���������違�h���b�v�A�C�e�����E������
	StopBGM(90)
	Wait(60)

	//�C�x���g�o�g���pCallFunc-------------------------
	CallFunc("system:boss_end")							//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���������E�{�X����-------------------------------
	MapAnime("CT_EVENT","open")							//�c�c�������Ȃ��X�g�b�p�[����
	SetChrPos(mons_Monkey,-100000.00f,0.00f,0.00f)		//�c�c�{�X�������Ȃ��ʒu�ɔ�΂�
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))			//�c�c�U�R�Ȃ炱����

	//���㏈��-----------------------------------------
		////-----------------------------------
		//// �^�C���A�^�b�N��
		//if (FLAG[SF_TIMEATK])
		//{
		//	EndTimeAtk()		// �^�C���A�^�b�N�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		//}
		////-----------------------------------

	FadeOut(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 0)	// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j

//�퓬�I�����������܂�-----------------------------------------------
//�J�n������������----------------------------------------------------

//	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

		// �p�[�e�B�Ґ��\�󋵂�߂�
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD", 792.32f,784.01f,3.30f)
	Turn("SAHAD", 98.79f, 360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",785.02f, 785.21f, 3.41f)
	Turn("Monkey",-78.27f,360.0f)
	ChangeAnimation( "Monkey" , "ANI_DEAD2", -1 , 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookReset("Monkey")

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",788.91f,792.34f,3.06f)
	Turn("ADOL",-9.52f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",788.10f,791.86f,3.09f)
	Turn("RICOTTA",-9.49f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",789.88f,792.42f,3.04f)
	Turn("LAXIA",-9.52f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",787.18f,792.51f,3.17f)
	Turn("HUMMEL",-9.48f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",790.67f,792.71f,3.02f)
		Turn("DANA",-9.52f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	LookChr("ADOL", "Monkey")
	LookChr("LAXIA", "Monkey")
	LookChr("SAHAD", "Monkey")
	LookChr("RICOTTA", "Monkey")
	LookChr("HUMMEL", "Monkey")
	LookChr("DANA", "Monkey")

	// �T�n�h�̃G�t�F�N�g�����[�h
	SetFlag(TF_MENU_SELECT, 0)
	if (WORK[WK_ISEXIST_PLAYER1] && WORK[WK_PLAYER1] == SAHAD)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER2] && WORK[WK_PLAYER2] == SAHAD)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER3] && WORK[WK_PLAYER3] == SAHAD)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER4] && WORK[WK_PLAYER4] == SAHAD)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}

	if (FLAG[TF_MENU_SELECT] == 0)
	{
		// �܂��ǂ܂�ĂȂ�
		LoadEffect("efx_c001.ite")
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )
	PlayBGM(BGM_1119, 0)

	//�J�����ݒ�
	MoveCameraAt( 0 , 788.664f , 786.475f , 4.671f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -1.141f , 0 )	// ��{�p
	RotateCamera( 0 , 53.149f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 4.000, 120.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetSkipScript("mp1119:Speedrun_Monkey2_Win_ED")

//�J�n���������܂�-----------------------------------------------

	Wait(10)

	FadeIn(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	//�@�@��ʃt�F�[�h�C�����āA
�@	//�@�@���G�����Ă���}�X�^�[�R���O�Ƃ��̑O�ɃT�n�h�B
	//�@�@���Ԃ͎��͂ɂ���B

	TalkPopup("SAHAD",0,1,0,0,0)
	{
		"#000e#000m�������A��������I\p"
		"���̂́c�c����Ȋ������H"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�T�n�h���N�����Ȃ������ɃQ�C�[���u���E����B
	CrossFade(FADE_CROSS)
	MoveCameraAt( 0 , 789.675f , 780.277f , 5.887f , 0 )	// �����_
	ChangeCameraDistance( 0 , 1.199f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 20.847f , 0 )	// ��{�p
	RotateCamera( 0 , 309.969f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	LookReset( "SAHAD" )
	SetChrPos("SAHAD",792.32f,784.01f,3.30f)
	Turn("SAHAD",6.41f,360.0f)
	Wait(FADE_CROSS)
	ChangeAnimation( "SAHAD", "ANI_EV_SETARM", -1, 1 )
	WaitAnimation2( "SAHAD" , -1, 1, "ANI_EV_SETARM",  0)
	ChangeAnimation( "SAHAD", "ANI_SP_C4", -1, 1 )	//���X�L��C4�F�Q�C���u���E�F�n��
	WaitAnimation2( "SAHAD" , -1, 1, "ANI_SP_C4",  0)
	Wait(20)

	//PlaySE(SE_TUTORIAL, 100, 0, 0, 0, 1.0f, 0)	//�`���[�g���A��
	PlaySE( SE_SKILLLEARN , 100 , 0,  0, 0, 1.0f, 0)

	//	�i���[�V����
//	TalkPopup(UNDEF,0,5,0,0,0)
//	{
//		""
//		"#4C�T�n�h�̓X�L��#2C�u�Q�C���u���E�v#4C���K�������I"
//	}
//	WaitPrompt()
//	WaitCloseWindow()
	
	Message("#4C�T�n�h�̓X�L��#2C�u�Q�C���u���E�v#4C���K�������I")
	WaitPrompt()
	Wait(10)

	PlayVoice(Y8V_1411,"SAHAD",100)	//�K�n�n�i�T���߂ȏ΂��j

	TalkPopup("SAHAD",0,2,0,0,0)
	{
		"#021e#080m�K�n�n�A�Ȃ��Ȃ������Z���B"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	Wait(10)

	//�@�@��ʃN���X�t�F�[�h�ŁA�T�n�h���Ĕz�u�����Ԃ������W�܂�B
	CrossFade(FADE_FAST)
	SetChrPos("SAHAD",790.31f,784.37f,3.33f)
	Turn("SAHAD",100.00f,360.0f)
	SetChrWork( "SAHAD" , CWK_BATTLEMODE , 0 )
	ChangeAnimation( "SAHAD", "ANI_WAIT", -1, 1 )	// �ҋ@
	LookChr("SAHAD", "Monkey")
	SetChrPos("ADOL",791.63f,784.05f,3.31f)
	Turn("ADOL",93.56f,360.0f)
	SetChrPos("RICOTTA",791.68f,785.41f,3.26f)
	Turn("RICOTTA",85.92f,360.0f)
	SetChrPos("LAXIA",791.63f,783.17f,3.35f)
	Turn("LAXIA",118.85f,360.0f)
	SetChrPos("HUMMEL",793.06f,784.85f,3.26f)
	Turn("HUMMEL",91.36f,360.0f)

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrPos("DANA",792.78f,783.34f,3.32f)
		Turn("DANA",106.93f,360.0f)
	}

	MoveCameraAt( 0 , 789.293f , 785.708f , 6.215f , 0 )	// �����_
	ChangeCameraDistance( 0 , 6.760f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -3.143f , 0 )	// ��{�p
	RotateCamera( 0 , 39.517f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 789.293f , 785.708f , 5.475f , 50 )

	Wait(FADE_CROSS)
	
	// �J�����҂�
	WaitThread(1000)

	//�@�@�}�X�^�[�R���O�������オ���ĉ�b���[�V�����B
	ChangeAnimation( "Monkey", "ANI_RESURRECT", -1, 1 )
	PlaySE(SE_MONKEY_01, 60, 0, 0, 0, 1.0f, 0)
	Wait(10)
	PlayVoice(Y8V_5664, "xxx", 100)	//���فI�i�����m��u���̒ʂ�I�v�j
	Wait(10)
	PlaySE(SE_MONKEY_02, 60, 0, 0, 0, 1.0f, 0)
	WaitAnimation2( "Monkey" , -1, 1, "ANI_RESURRECT",  0)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI_S", -1, 1 )
	WaitAnimation2( "Monkey" , -1, 1, "ANI_EV_UDEGUMI_S",  0)

	TalkPopup("RICOTTA",0,2,0,0,0)
	{
		"#000e#000m������[�����Ă�B"
		"�w�ł͂܂��ȁx\p"
		"�w���x�́g���A�Ȃ�l�h"
		"�@�ɂĉ�Ƃ��悤�x"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "SAHAD", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// ���荘

	PlayVoice(Y8V_1415,"SAHAD",100)	//���[��I�i���邭�j

	TalkPopup("SAHAD",0,2,0,0,0)
	{
		"#000e#000m������A���񂶂Ⴀ�ȁI"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�}�X�^�[�R���O���ޏꂷ�郂�[�V�����B�i�W�����v���Ȃ��������j
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI_E", -1, 1 )
	WaitAnimation2( "Monkey" , -1, 1, "ANI_EV_UDEGUMI_E",  0)
	//Turn("Monkey", 42.53f, 8.0f)
	Wait(10)
	ChangeAnimation( "Monkey", "ANI_EV_JUMP_S", -1, 1 )
	
	LookReset("ADOL")
	LookReset("LAXIA")
	LookReset("SAHAD")
	LookReset("HUMMEL")
	LookReset("RICOTTA")
	Wait(10)
	EarthQuake( 0.02f , 0.02f , 20 )	// �c�h�ꕝ, ���h�ꕝ, ����
	Blur(BLUR_TYPE_EXPAND, 0.2f, 30)	//�u���[

	if( FLAG[SF_DANA_JOINOK] ) {		// �_�[�i������
		LookReset("DANA")
	}

	//�@�@��ʈÓ]�B
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()
	SetChrPos("Monkey" , -100000.00f , 0.00f ,0.00f )

	Wait(20)

	//�@�@�C�x���g�I���A���싖�B

//�I��������������----------------------------------------------------
	CallFunc("mp1119:Speedrun_Monkey2_Win_ED")
}
function "Speedrun_Monkey2_Win_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")	

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	// �G�t�F�N�g��j������
	if (FLAG[TF_MENU_SELECT] == 0)
	{
		// �ǉ��œǂ�ł���ꍇ�̂ݔj��
		ReleaseEffect("efx_c001.ite")
	}

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�t���O����
	SetFlag( GF_SPEEDRUN_SKILL_SAHAD, 1 )		// ��荞�݃X�L���K���F�A���T�n�h�u�r�}�X�^�[�R���O����������
	SetFlag(SF_BOSS_BATTLE, 0)		//�{�X��I��
	if(FLAG[GF_TBOX_DUMMY111]) //if skill shuffle is on
    {
        CallFunc("rng:0581")
    }
	else
	{
		GetSkill(PARTY_SAHAD, SKILL_SAHAD_SP_C4, 1)	//�Q�C���u���E
	}
	
	//�}�[�J�[�폜�Ɛݒu
	DelMapMarker( SMI_SUBEVENT, PAGE_F010, MARKER_SPEEDRUN_SKILL1, 0, 0)	// ��荞�݃X�L���K���F���̏o���l�ɋ���}�X�^�[�R���O�p
	SetMapMarker( SMI_SUBEVENT, PAGE_F009, MARKER_SPEEDRUN_SKILL2, 1133.42f, 431.52f, 0.11f, 	1133.42f, 431.52f,	MARKER_SPEEDRUN_SKILL2, MN_F_MP1118,	0)	// ��荞�݃X�L���K���F���l�ɋ���}�X�^�[�R���O�p

	// �X�L��������ʊO�Ɉړ��i�C�x���g�X�L�b�v�����ꍇ�p�ɓ���Ă���܂��j
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	CallFunc("mp1119:init")

	//�C�x���g��̍Ĕz�u
	SetChrPos("LEADER",792.32f,784.01f,3.30f)
	Turn("LEADER",98.79f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//�J�����ʒu���A
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
	//RotateCamera( 0 , 0.0f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ���[����]

	RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}
