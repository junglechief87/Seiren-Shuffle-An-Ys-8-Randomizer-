#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"
#include "inc/music.h"
#include "inc/efx.h"
#include "inc/enemy/b003.h"

//----------------------------------------------------------------------------//
//                                                                            //
// �W�����_��������     �{�X��}�b�v                                        //
//                                                                            //
//----------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
// �������X�N���v�g
///////////////////////////////////////////////////////////////////////////////
//-------------------------------------------

function "init"
{
	CallFunc("rng:expMult")
	// �C�x���g�G���A����
	EventAreaEnable( "evb2_BossStart" , 0 )
	EventAreaEnable( "evb2_M03S290" , 0 )

	// �X�g�b�p�[����
	MapAnime("CT_boss", "open")		// �{�X�����߂�����

	// �C�x���g��������
	if( FLAG[SF_BOSS_BATTLE] )
	{
		//���g���C��f�o�b�O�{�X�W�����v����̃{�X��
		if( !FLAG[SF_TIMEATK] &&				// �^�C���A�^�b�N���ł͂Ȃ�
			FLAG[GF_SPEEDRUN_SKILL_DANA] &&		// ��荞�݃X�L���K���F�B���_�[�i�u�r�}�X�^�[�R���O����������
			!FLAG[GF_SPEEDRUN_SKILL_LAXIA] && FLAG[SF_LAXIA_JOINOK] && FLAG[GF_03MP4341_KILL_ANCIENT])	// ��荞�݃X�L���K���F�C�����N�V���u�r�}�X�^�[�R���O����������	
		{
			SetWork( WK_BGM , BGM_Nothing )
			EventCue("mp4341:Retry_Speedrun_Monkey4_Battle")
		}
		else
		{
			SetWork( WK_BGM , BGM_Nothing )
			EventCue("mp4341:EV_RetryBoss")
		}
	}
	else if( FLAG[SF_EVENT_ON] )
	{
		// ���{�X�J�n�܂��Ȃ璆�{�X�J�n����ׂ̃C�x���g�{�b�N�X�I���ɂ���
		if(!FLAG[GF_03MP4341_KILL_ANCIENT] ){	// �W�����_�����̒���ɓ�������
			SetWork( WK_BGM , BGM_Nothing )
			SetChrPos("b003" -100000.00f , 00.00f , 00.00f )
			EventAreaEnable( "evb2_BossStart" , 1 )
		}

	//��ʔz�u�t�@���N�V�����Ăяo��
		CallFunc("mp4341:NpcPosition")

	//�m�o�b�}�[�J�[�Z�b�g
		CallFunc("system:SetMarkerNPC")

		if (FLAG[GF_TBOX_DUMMY112] && FLAG[GF_03MP4341_KILL_ANCIENT]) {		// Release the Psyches mode check.
			EventCue("rng:0627")
		}
	}
}

//////////////////////////////////////////////////////////////////////
//����ʔz�u
//////////////////////////////////////////////////////////////////////
//��ʔz�u
function "NpcPosition"
{
	if( FLAG[GF_SPEEDRUN_SKILL_DANA] &&		// ��荞�݃X�L���K���F�B���_�[�i�u�r�}�X�^�[�R���O����������
		!FLAG[GF_SPEEDRUN_SKILL_LAXIA] && FLAG[SF_LAXIA_JOINOK] && FLAG[GF_03MP4341_KILL_ANCIENT])	// ��荞�݃X�L���K���F�C�����N�V���u�r�}�X�^�[�R���O����������
	{
		//�}�X�^�[�R���O
		SetChrPos("Monkey",380.40f, -8.23f, 759.63f)
		Turn("Monkey",-175.04f,360.0f)
		ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	}
}

//-------------------------------------------
// �{�X�탊�g���C
function "EV_RetryBoss"
{
	SetStopFlag(STOPFLAG_EVENT)

	//�X�L�b�vor���g���C
	if (FLAG[TF_EVSKIP] || FLAG[SF_LOADING] == 200)
	{
		FadeOut(FADE_BLACK,0)
		WaitFade()
	} else {
		FadeOut(FADE_WHITE,0)
		WaitFade()
	}

	//�{�X�z�u�E�A�j��--------------------------------
	SetChrPos("b003", 307.972f, -2.552f, 775.000f)
	Turn("b003",273.0f,360.0f)

	//PLAYER�z�u--------------------------------------
	SetChrPos("PLAYER1", 423.08f, -6.80f, 759.63f)
	TurnToChr("PLAYER1","b003",360.0f)

	//�J�����ݒ�--------------------------------------
	// arg�̐ݒ���㏑������
	//SetYs8Camera(B003_CAMERA_LAND_H_DIST, B003_CAMERA_LAND_H_FOV, B003_CAMERA_LAND_H_DIP, B003_CAMERA_LAND_H_ADDZ, B003_CAMERA_LAND_H_ADDZ)
	SetYs8Camera(B003_CAMERA_LAND_H_DIST, B003_CAMERA_LAND_H_FOV, B003_CAMERA_LAND_H_DIP, B003_CAMERA_LAND_H_ADDZ, B003_CAMERA_LAND_H_ADDZ)

	MoveCameraAt( 0 , 423.080f , -6.800f , 762.479f , 0 )	// �����_
	ChangeCameraDistance( 0 , 9.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 9.000f , 0 )	// ��{�p
	RotateCamera( 0 , 82.159f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	//�C�x���g�o�g���pCallFunc------------------------
	CallFunc("system:boss_start")

	//���̑�����--------------------------------------
	PlayBGM(BGM_BOSS_003, 0)
	MapAnime("CT_boss", "close")		// �{�X�����߂�����

	//�X�L�b�vor���g���C
	if (FLAG[TF_EVSKIP] || FLAG[SF_LOADING] == 200)
	{
		FadeIn(FADE_BLACK,FADE_FAST)

		if (FLAG[SF_TIMEATK])
		{
			// �^�C���A�^�b�N�̏ꍇ�̓{�X���o���Ă�����
			VisualName("visual/bossname/bn_b003.itp", VN_NAMEBOSS2, VN_BOSSNAME_LT_X, VN_BOSSNAME_LT_Y,VN_BOSSNAME_TIME)
		}

		WaitFade()
	} else {
		FadeIn(FADE_WHITE,FADE_FAST)

		if (FLAG[SF_TIMEATK])
		{
			// �^�C���A�^�b�N�̏ꍇ�̓{�X���o���Ă�����
			VisualName("visual/bossname/bn_b003.itp", VN_NAMEBOSS2, VN_BOSSNAME_LT_X, VN_BOSSNAME_LT_Y,VN_BOSSNAME_TIME)
		}

		WaitFade()
	}

	ResetStopFlag(STOPFLAG_EVENT)

	//------------------------------------------------
}

// �{�X���S�F�M�A�X�o�[��
function "EV_Boss_Dead"
{
	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)		//���G�n�m

	Wait(210)
	StopBGM(120)
	Wait(60)

	//�C�x���g�o�g���pCallFunc-------------------------
	// SF_BOSS_BATTLE�̂݃C�x���g���őΏ����ĉ�����
	CallFunc("system:boss_end")


	//���������E�{�X����-------------------------------
	MapAnime("CT_boss", "open")		// �{�X�����߂�����

	SetChrPos("b003",-100000.00f,0.00f,0.00f)

	//���㏈��-----------------------------------------
	// �^�C���A�^�b�N��
	if (FLAG[SF_TIMEATK])
	{
		EndTimeAtk()		// �^�C���A�^�b�N�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		ResetStopFlag(STOPFLAG_EVENT)
	}
	else if( FLAG[SF_EVENT_ON] )
	{
		EventCue("mp4341:EV_M03S280_ED")
		ResetStopFlag(STOPFLAG_EVENT)
	}
	else
	{
		// �{�X���b�V���H
		FadeIn(FADE_WHITE,FADE_FAST)
		WaitFade()

		ResetStopFlag(STOPFLAG_EVENT)
	}
	//------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////

//�����C���C�x���g�Z�N�V����

////////////////////////////////////////////////////////////////////////////////
function "EV_M03S270" 			//�����^�Ñ��o��
{
//�J�n������������----------------------------------------------------
	SetStopFlag(STOPFLAG_EVENTIMPOSE)

	FadeOut(FADE_BLACK,0)
	WaitFade()

	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetMapParam( -1 )
	StopEffect(-1,ALL,1)
	EventAreaEnable( "evb2_BossStart" , 0 )
	ResetStopFlag(STOPFLAG_EVENTIMPOSE)
	//FadeIn(FADE_BLACK,FADE_NORMAL)
	CallFunc("mp4341:EV_RetryBoss")
}

function "EV_M03S270_old" 			//�����^�Ñ��o��
{
//�J�n������������-----------------------------------------------

	CallFunc("system:event_begin_impose")

	SaveEventState()
	SaveCamera()

	//�����������s�v�Ȃ��̂��B��
	ClearDebris()
	ResetMotion( "ALL" , 1 )  
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))
	
	//�L�����N�^�[������
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("ADOL","ANI_WAIT", -1 , 1 )	
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKR,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("LAXIA","ANI_WAIT", -1 , 1 )	
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("SAHAD","ANI_WAIT", -1 , 1 )	
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SAD_CLOSE,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_TAME,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	ChangeAnimation("RICOTTA","ANI_WAIT", -1 , 1 )	
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKR,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI )

	ResetChrInfoFlag( "ev_b003" , INFOFLAG_INVISIBLE )
	SetChrWork("ev_b003", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ev_b003",385.44f,70.77f,807.99f)
	Turn("ev_b003",13.68f,360.0f)
	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_WALK", -1 , 1 )

	SetChrPos("ADOL",417.92f,-6.85f,759.63f)
	Turn("ADOL",92.27f,360.0f)
	LookReset("ADOL")

	SetChrPos("LAXIA",420.82f,-5.57f,759.63f)
	Turn("LAXIA",90.65f,360.0f)
	
	SetChrPos("SAHAD",421.11f,-7.11f,759.63f)
	Turn("SAHAD",99.13f,360.0f)
	
	SetChrPos("RICOTTA",424.65f,-6.72f,759.63f)
	Turn("RICOTTA",89.93f,360.0f)
	LookSpd("RICOTTA" , 0.08 , 0.08 , 0.08 )
	Look("RICOTTA" ,  25 , 0 )

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 80.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetSkipScript("mp4341:EV_M03S270_ED")

	SoundEfx( SEFX_EV_VALLEY, 15 )
	
//�J�n���������܂�-----------------------------------------------
	
//�@�@�{�X��}�b�v�ɓ������Ƃ���ŃC�x���g�J�n�B
	SetStopFlag(STOPFLAG_CINEMA)
	Wait(15)

	TalkMes("SAHAD","#1763V�ӂ��c�c�ӂ��c�c",
		"�����ԍ����Ƃ���܂œo���Ă����ȁB","")

	Wait(130)

	ExecuteCmd( 1, MoveTo, "ADOL" ,409.54f,-5.36f,759.63f, 0.1f , 0.15f )
	//SetChrPos("ADOL",409.54f,-5.36f,759.63f)
	//Turn("ADOL",87.19f,360.0f)

	ExecuteFunc( 12, "mp4341:EV_M03S270_ricotta_move")
	Wait(3)

	ExecuteCmd( 3, MoveTo, "LAXIA" ,410.44f,-4.52f,759.63f , 0.1f , 0.15f )
	//SetChrPos("LAXIA",410.44f,-4.52f,759.63f)
	//Turn("LAXIA",94.40f,360.0f)

	SetMotSpd("SAHAD" , -1 , 0.8)
	ExecuteCmd( 4, MoveTo, "SAHAD" ,411.83f,-6.20f,759.63f, 0.1f , 0.14f )
	//SetChrPos("SAHAD",411.83f,-6.20f,759.63f)
	//Turn("SAHAD",-175.26f,360.0f)

	//�J�����ݒ�
	MoveCameraAt( 0 , 420.962f , -6.310f , 760.984f , 0 )	// �����_
	ChangeCameraDistance( 0 , 4.440f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 10.153f , 0 )	// ��{�p
	RotateCamera( 0 , 267.815f , 0 )				// �p�x
	ChangeCameraPers( 0 , 30.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 1500.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,411.069f , -4.670f , 760.984f , 270 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.431f , 270)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.693f , 270 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 240.961f ,  270 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE , 0.0f, 110 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 411.069f , -4.670f , 760.984f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 5.431f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 4.693f , 0 )	// ��{�p
	//RotateCamera( 0 , 240.961f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 30.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ���[����]

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	Wait(70)
	ClosePrompt()
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)

	Look("LAXIA" , -15 , 0 )
	TalkMes("LAXIA","#0927V#020l#000e#000m�����A�Ő��ɏo�܂������A",
		"����܂ł��Ə����̂͂��ł��B","")
	Wait(150)
	ClosePrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	LookReset("LAXIA" )
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKL_E,1)

	//�@�@���R�b�^�Ɂu�I�v�G���[�V�����\����A
	//�@�@���͂����񂵂Ă���������グ��B


	WaitThread(3)
	WaitThread(4)

	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SAD_CLOSE_E,1)
	Turn("SAHAD",-175.26f,10.0f)
	LookChr("SAHAD" , "RICOTTA")
	Turn("LAXIA",-157.13f,8.0f)
	LookChr("LAXIA" , "RICOTTA")
	Turn("ADOL",149.54f,7.0f)
	LookChr("ADOL" , "RICOTTA")
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKR_E,1)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	TalkMes("LAXIA","#0928V#000m���R�b�^�����A�ǂ����܂����H","","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(30)

	CrossFade(FADE_CROSS)

	//SetChrPos("ADOL",409.81f,-5.77f,759.63f)
	//Turn("ADOL",-44.31f,360.0f)
	//
	//SetChrPos("LAXIA",410.52f,-4.53f,759.63f)
	//Turn("LAXIA",-96.98f,360.0f)

	//���V�[������
	SetMotSpd("SAHAD" , -1 , 1.0)
	SetMotSpd("RICOTTA" , -1 , 1.0)

	SetChrPos("ADOL",409.53f,-5.22f,759.63f)
	Turn("ADOL",102.76f,360.0f)
	SetChrPos("LAXIA",410.44f,-4.34f,759.63f)
	Turn("LAXIA",54.82f,360.0f)
	SetChrPos("SAHAD",411.83f,-5.51f,759.63f)
	Turn("SAHAD",-175.26f,360.0f)

	LookReset("ADOL")
	LookReset("LAXIA")
	LookReset("SAHAD")

	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SAD,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)

	MoveCameraAt( 0 , 416.607f , -4.507f , 760.886f , 0 )	// �����_
	ChangeCameraDistance( 0 , 1.342f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -7.490f , 0 )	// ��{�p
	RotateCamera( 0 , 290.880f , 0 )				// �p�x
	ChangeCameraPers( 0 , 30.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -10.3f , 0 )				// ���[����]

	Wait(15)

	LookReset("RICOTTA")
	Wait(10)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKL_E,1)

	Wait(30)

	LookSpd("RICOTTA" , 0.10 , 0.10 , 0.10 )
	Look("RICOTTA" ,  0 , 18 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKT_S,1)
	ChangeAnimation( "RICOTTA" , "ANI_EV_SUP_S", -1 , 1 )

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,416.697f , -4.541f , 760.836f, 30 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,1.842f , 30)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE ,  19.935f , 30 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE ,274.416f ,  30 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE , 0.0f, 110 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 416.697f , -4.541f , 760.836f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 1.842f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 19.935f , 0 )	// ��{�p
	//RotateCamera( 0 , 274.416f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 30.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , -10.3f , 0 )				// ���[����]

	Wait(5)
	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	TalkMes("RICOTTA","#2683V#030e#160m�󂩂牽�������#000m�I","","")
	WaitPrompt()
	WaitCloseWindow()
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)

	ResetStopFlag(STOPFLAG_CINEMA)

	Wait(15)

	PlaySE( SE_M03S270_01 , 100 , 0,  0, 0, 1.0f, 0)		//�����K

	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

//	CrossFade(FADE_CROSS)
//	PlaySE( SE_243 , 60, 0,  0, 0, 1.0f, 0)		//�����K
//
//	MoveCameraAt( 0 , 412.628f , -4.724f , 760.737f , 0 )	// �����_
//	ChangeCameraDistance( 0 , 2.242f , 0 )		// ��{����
//	ChangeCameraElevation( 0 , -11.767f , 0 )	// ��{�p
//	RotateCamera( 0 , 120.317f , 0 )				// �p�x
//	ChangeCameraPers( 0 , 38.000f , 0 )			// ����p
//	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	RollCamera( 0 , 1.1f , 0 )				// ���[����]
//
//	Wait(FADE_CROSS)
//
//	Wait(40)
//
//	//�@�@��󂩂�Ñ��̉s���e�������������Ă���B
//	//�@�@�A�h���A���N�V���A�T�n�h�Ɂu�I�v�G���[�V�����\���B
//	EmotionEx("ADOL", 0.02f,2,5,5,1,1,2.0f)	// �I
//	EmotionEx("SAHAD", 0.03f,2,5,5,1,1,1.7f)	// �I
//	EmotionEx("LAXIA", 0.03f,2,5,5,1,1,1.8f)	// �I
//
//	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_ANGER_S,1)
//	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SUP_S,1)
//	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_TAME_S,1)
//	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_ANGER_S,1)
//	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_OPEN_S,1)
//
//
//	Wait(60)

	CrossFade(FADE_CROSS)
	SetChrPos("RICOTTA",411.63f,-3.13f,759.63f)
	Turn("RICOTTA",84.05f,360.0f)
	LookChr("RICOTTA" , "ev_b003")

	SetChrInfoFlag( "ev_b003" , INFOFLAG_ANYTIMECALC )

	MoveCameraAt( 0 , 410.532f , -3.273f , 762.148f , 0 )	// �����_
	ChangeCameraDistance( 0 , 4.019f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -36.842f , 0 )	// ��{�p
	RotateCamera( 0 , 56.023f , 0 )				// �p�x
	ChangeCameraPers( 0 , 49.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	ExecuteFunc(100, "mp4341:EV_M03S270_boss_move" )

	ChangeAnimation( "ADOL" , "ANI_EV_STWAIT_S", -1 , 1 )
	ChangeAnimation( "LAXIA" , "ANI_EV_KAZETUYO_S", -1 , 1 )
//	ChangeAnimation( "RICOTTA" , "ANI_EV_SUP_S", -1 , 1 )
	SetMotSpd("SAHAD" , -1 , 1.5 )
	ChangeAnimation( "SAHAD" , "ANI_EV_BIBIRI_S", -1 , 1 )

	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_ANGER_S,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SHOUT_S,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_TAME_S,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_SHOUT_S,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_OPEN_S,1)

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 240.000 ,1.000 ,0.700 ,0.500)

//	Slow(0.7)

	VibrationPad(1001, 0 )		//�{�X���n�ėp
	PlayBGM(BGM_BOSS_003, 0)	//��
	PlaySE( SE_M03S270_04 , 100 , 0,  0, 0, 1.0f, 0)	//�͂�����
	PlaySE( SE_M03S270_03 , 50 , 0,  0, 0, 1.0f, 0)	//����

	Wait(10)

	EarthQuake( 0.02f , 0.03f  , 90 )

	Blur( BLUR_TYPE_EXPAND ,0.25f , 40 )

	Slow(1.0)

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,410.469f , -4.375f , 761.900f , 30 )		// �����_
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 4.599f , 30)		// ��{����
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -36.845f , 30 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE ,95.965f ,  30 )		// �p�x
	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,0.0f, 30 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 410.469f , -4.375f , 761.900f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 4.599f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -36.845f , 0 )	// ��{�p
	//RotateCamera( 0 , 95.965f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 49.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ���[����]

	Wait(10)
	EmotionEx("ADOL", 0.01f,2,5,5,1,1,1.3f)	// �I
	EmotionEx("SAHAD", 0.01f,2,5,5,1,1,1.2f)	// �I
	EmotionEx("LAXIA", 0.01f,2,5,5,1,1,1.3f)	// �I

	Wait(40)

	LookChr("ADOL" , "ev_b003")

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,410.469f , -4.375f , 761.603f , 110 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  4.019f , 110)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -18.770f  , 110 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE ,96.838f ,  110 )		// �p�x
	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE , 0.0f, 110 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 410.469f , -4.375f , 761.603f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 4.019f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -18.770f , 0 )	// ��{�p
	//RotateCamera( 0 , 96.838f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 49.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ���[����]

	FadeBGM(70,10)
	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	TalkMes("SAHAD","#1764V�Ђ��I�H","","")

	Wait(50)

	ClosePrompt()
	WaitCloseWindow()

	ResetStopFlag(STOPFLAG_CINEMA)

	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)

	Wait(50)

	CrossFade(FADE_FAST)
	StopThread(10)
	StopThread(11)
	StopThread(12)
	StopThread(100)

	Blur( BLUR_TYPE_AFTERIMAGE ,0.4f , 15 )
	PlaySE( SE_M03S270_04 , 100 , 0,  0, 0, 1.0f, 0)

	SetChrPos("ev_b003",358.26f,39.06f,770.78f)
	Turn("ev_b003",-88.28f,360.0f)
	RollChr( "ev_b003"	,10 , 0 )

	Look("ev_b003" , 40 , -15)

	ExecuteCmd(10,MoveRotate, "ev_b003" , 374.857f , -9.490f , 759.524f   , 90 , 0.5f , 1 ,12.0f ,0 , 0 )
	//SetChrPos("ev_b003",385.23f,31.07f,770.78f)
	//Turn("ev_b003",-59.66f,360.0f)
	//MoveCameraAt( 0 , 374.857f , -9.490f , 759.524f , 0 )	// �����_

	MoveCameraAt( 0 , 361.593f , 37.404f , 774.828f , 0 )	// �����_
	ChangeCameraDistance( 0 , 6.519f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 28.678f , 0 )	// ��{�p
	RotateCamera( 0 , 247.163f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 22.8f , 0 )				// ���[����]

	ChangeAnimation( "ADOL" , "ANI_EV_SETARM", -1 , 1 )
	SetMotSpd("SAHAD" , -1 , 1.0 )

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_COS ,397.412f , 40.390f , 774.605f , 105 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_COS ,  7.519f , 105)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_COS , 30.694f  , 85 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_COS , 200.352f ,  85)		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_COS , 0.0f, 85 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_COS ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 397.412f , 40.390f , 774.605f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 6.519f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 30.694f , 0 )	// ��{�p
	//RotateCamera( 0 , 212.752f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 15.3f , 0 )				// ���[����]
	//// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B


	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_WALK_RUN", -1 , 1 )
	PlaySE(SE_M03S270_02, 100, 0, 0, 0, 1.0f, 0)	//�͂΂���
	FadeIn(FADE_BLACK,FADE_CROSS)
	WaitFade()

	Wait(25)
	PlaySE(SE_M03S270_02, 100, 0, 0, 0, 1.0f, 0)	//�͂΂���
	Wait(20)

//	Slow(1.0)
	Blur( BLUR_TYPE_AFTERIMAGE ,0.5f , -1 )

	//SetMotSpd("ev_b003" , -1 , 1.55f)
	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE , 35.0f, 60 )		// ���[����]
	ExecuteCmd(12, RollChr , "ev_b003" , 60 ,60  )
	Wait(10)
	ExecuteCmd(11, MoveZ , "ev_b003" , -9.0  , 1 , INTERPOLATE_COS  , 50 )
	ExecuteCmd(12, PitchChr , "ev_b003" , -20 ,20  )

	Wait(25)

//	SetEnvSEPlayState(4341001,0)	//��SE�t�F�[�h�A�E�g
	FadeOut(FADE_BLACK,5)
	WaitFade()
	Wait(1)

	StopThread(10)
	StopThread(11)
	StopThread(12)
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)
	Blur( BLUR_TYPE_AFTERIMAGE ,0.5f , 0 )
	StopEffect( -2, "ev_b003" , 1 )

	SetMotSpd("ev_b003" , -1 , 1.0f)
	LookReset("ev_b003")
	SetChrPos("ev_b003",385.17f,60.43f,771.68f)
	TurnTo("ev_b003",418.17f,-125.39f,771.68f,360.0f)
	RollChr( "ev_b003"	,0 , 0 )
	PitchChr( "ev_b003"	,-15 , 0 )
	ChangeAnimation( "ev_b003" , "ANI_EV_GATK_L", -1 , 1 )

	MoveCameraAt( 0 , 409.012f , -5.734f , 761.307f , 0 )	// �����_
	ChangeCameraDistance( 0 , 4.019f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -7.799f , 0 )	// ��{�p
	RotateCamera( 0 , 36.493f , 0 )				// �p�x
	ChangeCameraPers( 0 , 58.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -8.5f , 0 )				// ���[����]

	Wait(15)

	PlaySE( SE_M03S270_05 , 100 , 0,  0, 0, 1.0f, 0)	//�͂�����
	PlaySE( SE_M03S270_03 , 50 , 0,  0, 0, 1.0f, 0)	//����
	Blur( BLUR_TYPE_AFTERIMAGE ,0.45f , -1 )
	ExecuteCmd( 12, PitchChr, "ev_b003"	, 0 , 10 )
	ExecuteCmd(11, MoveZ , "ev_b003" , -4.0  , 1 , INTERPOLATE_SPHERE  , 10 )
	ExecuteCmd( 10, MoveTo, "ev_b003" ,418.17f,-125.39f,771.68f, 0.1f , 11.00f )
	//SetChrPos("ev_b003",418.17f,-125.39f,771.68f)
	//Turn("ev_b003",-53.45f,360.0f)

	SetMotSpd("ADOL" , -1 , 0.5 )
	ChangeAnimation( "ADOL" , "ANI_GUARD", -1 , 1 )	
	FadeIn(FADE_BLACK,FADE_CROSS)
	WaitFade()

	Wait(5)

	Blur( BLUR_TYPE_AFTERIMAGE ,0.45f , 0 )
	Slow(0.10)

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,410.030f , -6.908f , 761.307f , 30 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  4.019f , 30)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -7.799f   , 30 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 131.976f ,  30 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.9f, 150 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 410.030f , -6.908f , 761.307f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 4.019f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -7.799f , 0 )	// ��{�p
	//RotateCamera( 0 , 131.976f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 58.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , -8.5f , 0 )				// ���[����]

	Wait(4)

	Slow(1.0)
	StopThread(11)
	StopThread(12)
	ExecuteCmd( 10, MoveTo, "ev_b003" ,418.17f,-125.39f,771.68f, 0.1f , 15.50f )
	ExecuteCmd(11, MoveZ , "ev_b003" , 4.0  , 1 , INTERPOLATE_SPHERE  , 10 )	
	ExecuteCmd( 12, PitchChr, "ev_b003"	, 15 , 10 )

	EarthQuake( 0.10f , 0.2f  , 40 )
	Blur( BLUR_TYPE_EXPAND ,0.4f , 40 )

	PlaySE( SE_M03S270_01 , 100 , 0,  0, 0, 1.0f, 0)		//���K

	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)
	WaitThread(10)

	Wait(20)

	CrossFade(FADE_FAST)
	StopThread(11)
	StopThread(12)
	LookSpd("ev_b003" , 0.08 , 0.08 , 0.08 )
	SetMotSpd("ADOL" , -1 , 1.0 )

	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_ANGER,1)
	ChangeAnimation( "LAXIA" , "ANI_EV_STWAIT", -1 , 1 )

	MoveCameraAt( 0 , 410.627f , -4.685f , 760.841f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.408f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 0.590f , 0 )	// ��{�p
	RotateCamera( 0 , 275.734f , 0 )				// �p�x
	ChangeCameraPers( 0 , 28.500f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -6.4f , 0 )				// ���[����]

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 80.000 ,1.000 ,0.700 ,0.500)

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,410.580f , -4.220f , 760.841f  , 70 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  2.958f  , 70)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 0.573f , 70 )		// ��{�p
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 97.398f ,  70 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.5f , 20 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 410.580f , -4.220f , 760.841f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 2.958f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 0.573f , 0 )	// ��{�p
	//RotateCamera( 0 , 275.734f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 28.500f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , -6.4f , 0 )				// ���[����]

	Wait(FADE_FAST)

	Wait(15)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

//	HeadNo("LAXIA" , 1 , 35 )

	ChangeAnimation( "LAXIA" , "ANI_EV_ST_TEYOKO", -1 , 1 )
	TalkMes("LAXIA","#0929V#042e#000m���A����́c�c",
			"#160m�����^�̌Ñ��#000m�I","")
	WaitPrompt()
	WaitCloseWindow()
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)

	ResetStopFlag(STOPFLAG_CINEMA)	//�����w�i��\��

	Wait(20)

	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)

//	Blur( BLUR_TYPE_AFTERIMAGE ,0.65f , 20 )
////	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,410.580f , -4.220f , 760.841f  , 110 )		// �����_
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE ,  2.578f  , 20)		// ��{����
////	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 0.573f , 110 )		// ��{�p
////	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 97.398f ,  20 )		// �p�x
////	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.5f , 20 )		// ���[����]
////	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p
//
//	//MoveCameraAt( 0 , 410.580f , -4.220f , 760.841f , 0 )	// �����_
//	//ChangeCameraDistance( 0 , 2.578f , 0 )		// ��{����
//	//ChangeCameraElevation( 0 , 0.555f , 0 )	// ��{�p
//	//RotateCamera( 0 , 275.734f , 0 )				// �p�x
//	//ChangeCameraPers( 0 , 28.500f , 0 )			// ����p
//	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	//RollCamera( 0 , -6.4f , 0 )				// ���[����]
//
//	SetStopFlag(STOPFLAG_CINEMA)
//	Wait(10)
//
//	ChangeAnimation( "LAXIA" , "ANI_EV_ST_TEYOKO", -1 , 1 )
//	TalkMes("LAXIA","#042e#160m�[�ő������������^�̑�^�Ñ��I#000m","","")
//	WaitPrompt()
//	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
//
//	WaitCloseWindow()
//	ResetStopFlag(STOPFLAG_CINEMA)	//�����w�i��\��
//
//	Wait(15)

	//�@�@�����ő�{�X�̓o�ꉉ�o��}���B

	FadeOut(FADE_BLACK,FADE_CROSS)
	WaitFade()
	StopThread(10)

	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_RUN", -1 , 1 )
	StopEffect( -2, "ev_b003" , 1 )

	//--------------------
	// Pos Key
	KeyAnimeCreate(KEYANIME_EXSKILLPOS, 4)
	KeyAnimeSet(0, 307.565, -81.695, 732.192, 14.918, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(82, 297.573, -24.072, 775.848, 14.918, 0.146, 0.801, 0.526, -0.042, 0.146, 0.801, 0.526, -0.042)
	KeyAnimeSet(109, 320.730, -9.591, 779.569, 11.118, 0.502, 0.622, 0.076, -0.078, 0.502, 0.622, 0.076, -0.078)
	KeyAnimeSet(139, 316.355, 16.111, 777.043, 12.667, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	
	// Rot Key
	KeyAnimeCreate(KEYANIME_EXSKILLROT, 4)
	KeyAnimeSet(0, -23.310, -7.500, 145.856, 58.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(82, -20.372, -7.500, 11.675, 58.000, -0.063, 0.000, -0.971, -0.000, -0.063, 0.000, -0.971, -0.000)
	KeyAnimeSet(109, -29.014, -7.500, 58.454, 58.000, -0.102, 0.000, 2.058, 0.000, -0.102, 0.000, 2.058, 0.000)
	KeyAnimeSet(139, -27.108, -7.500, 153.771, 58.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)

	Wait(5)

	SetChrPos("ev_b003",258.981f , -238.994f , 786.330f)
	Turn("ev_b003",90.00f,360.0f)
	RollChr("ev_b003" , 60 , 0 )
	PitchChr("ev_b003" , -15 , 0 )

	//���V�[������
	SetMotSpd("LAXIA" , SUBMOT_EYE , 1.0)
	SetChrPos("LAXIA",410.44f,-4.14f,759.63f)
	Turn("LAXIA",99.64f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_EV_STWAIT", -1 , 1 )

	SetChrPos("SAHAD",412.18f,-5.74f,759.63f)
	Turn("SAHAD",106.18f,360.0f)

	ChangeAnimation( "SAHAD" , "ANI_EV_STWAIT", -1 , 1 )
	
	MoveCameraAt( 0 , 307.565f , -81.695f , 732.192f , 0 )	// �����_
	ChangeCameraDistance( 0 , 14.918f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -23.310f , 0 )	// ��{�p
	RotateCamera( 0 , 145.856f , 0 )				// �p�x
	ChangeCameraPers( 0 , 58.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -7.5f , 0 )				// ���[����]

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 190.000 ,1.000 ,0.700 ,0.500)

	Wait(10)

	Slow(0.95)

	ExecuteCmd(10,MoveRotate, "ev_b003" ,258.880f , -118.757f , 786.330f  , 180.048f , 0.1f , 1  , 18.0f ,0 , 0 )
	Wait(10)

	ExecuteCmd(12,RollChr, "ev_b003"  ,0 , 75 )
	ExecuteCmd(13,PitchChr, "ev_b003"  ,0 , 75 )

	FadeIn(FADE_BLACK,FADE_CROSS)
	WaitFade()

	PlaySE( SE_M03S270_04 , 100 , 0,  800, 0, 1.0f, 0)	//�͂�����
	PlaySE( SE_M03S270_03 , 30 , 0,  0, 0, 1.0f, 0)	//����

	ExecuteCmd(1000, KeyAnimeCamera,1.0f, KEYANIME_EXSKILLPOS, KEYANIME_EXSKILLROT, 0)

//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,321.693f , -11.108f , 775.303f , 120 )		// �����_
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.801f  , 120)		// ��{����
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -34.205f , 120 )		// ��{�p
//	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 32.524f ,  120 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-1.8f , 120 )		// ���[����]
////	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p
//
//	//MoveCameraAt( 0 , 321.693f , -11.108f , 775.303f , 0 )	// �����_
//	//ChangeCameraDistance( 0 , 5.801f , 0 )		// ��{����
//	//ChangeCameraElevation( 0 , -34.205f , 0 )	// ��{�p
//	//RotateCamera( 0 , 32.524f , 0 )				// �p�x
//	//ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
//	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
//	//RollCamera( 0 , -1.8f , 0 )				// ���[����]

	Wait(20)

//	ExecuteCmd(12,RollChr, "ev_b003"  ,0 , 50 )
//	ExecuteCmd(13,PitchChr, "ev_b003"  ,0 , 50 )


	WaitThread(10)
	Blur( BLUR_TYPE_AFTERIMAGE ,0.5f , 15 )
	Slow(1.25)
	ExecuteCmd( 10, MoveTo, "ev_b003" ,309.27f,1.52f,775.02f, 0.1f , 5.80f )
	//SetChrPos("ev_b003",309.27f,1.52f,775.02f)


	PlaySE( SE_M03S270_05 , 100 , 0,  0, 0, 1.0f, 0)	//���Ԃ�
	ChangeAnimation( "ev_b003" , "ANI_EV_LANDING2", -1 , 1 )
	ExecuteCmd(11, MoveZ , "ev_b003" , 775.02f  , 0 , INTERPOLATE_SPHERE  , 30 )	
	//SetChrPos("ev_b003",309.27f,1.52f,775.02f)
	//Turn("ev_b003",-82.23f,360.0f)

	Wait(20)

	Slow(0.8)
	Wait(15)

	Slow(1.0)
	Wait(4)

	VibrationPad(1001, 0 )		//�{�X���n�ėp

	PlaySE( SE_M03S270_06 , 100 , 0,  0, 0, 1.0f, 0)		//���n
	EarthQuake( 0.4f , 0.6f , 60 )
	Blur( BLUR_TYPE_EXPAND ,0.45f , -1 )

	WaitThread(1000)

	Blur( BLUR_TYPE_EXPAND ,0.45f , 0 )

	// Key Release
	KeyAnimeRelease(KEYANIME_EXSKILLPOS)
	KeyAnimeRelease(KEYANIME_EXSKILLROT)

	//--------------------
	// Pos Key
	KeyAnimeCreate(KEYANIME_EXSKILLPOS, 3)
	KeyAnimeSet(0, 316.355, 16.111, 777.043, 12.667, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(80, 320.147, 14.287, 781.779, 7.237, -0.006, -0.114, 0.031, 0.036, -0.006, -0.114, 0.031, 0.036)
	KeyAnimeSet(190, 315.390, -3.440, 782.377, 18.855, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	
	// Rot Key
	KeyAnimeCreate(KEYANIME_EXSKILLROT, 3)
	KeyAnimeSet(0, -27.108, -7.500, 153.771, 58.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(80, -27.108, -7.500, 118.380, 58.000, -0.030, -0.000, -0.603, 0.000, -0.030, -0.000, -0.603, 0.000)
	KeyAnimeSet(190, -32.197, -7.500, 50.605, 58.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	
	//----------

	Wait(45)
	VisualName("visual/bossname/bn_b003.itp", VN_NAMEBOSS, VN_BOSSNAME_LB_X, VN_BOSSNAME_LB_Y,VN_BOSSNAME_TIME)


	ExecuteCmd(1000, KeyAnimeCamera,0.8f, KEYANIME_EXSKILLPOS, KEYANIME_EXSKILLROT, 0)
	LookChr("ev_b003" , "ADOL")

	Wait(78)
	Blur( BLUR_TYPE_AFTERIMAGE ,0.37f , 15 )


	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)

	Wait(40)

	CrossFade(FADE_NORMAL)
	Blur( BLUR_TYPE_AFTERIMAGE ,0.5f , 30 )

	SetChrPos("ev_b003",309.27f,1.52f,775.02f)
	Turn("ev_b003",-82.23f,360.0f)

	MoveCameraAt( 0 , 409.030f , -4.313f , 761.758f , 0 )	// �����_
	ChangeCameraDistance( 0 , 9.339f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -10.412f , 0 )	// ��{�p
	RotateCamera( 0 , 98.353f , 0 )				// �p�x
	ChangeCameraPers( 0 , 29.400f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 2.1f , 0 )				// ���[����]

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 80.000 ,1.000 ,0.700 ,0.500)

//	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,409.030f , -4.313f , 761.758f , 60 )		// �����_
//	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.119f , 60)		// ��{����
//	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 6.837f , 60 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 90.321f ,  400 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.5f , 60 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 140 )		// ����p

	//MoveCameraAt( 0 , 409.030f , -4.313f , 761.758f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 9.339f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -10.412f , 0 )	// ��{�p
	//RotateCamera( 0 , 85.321f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 34.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 2.1f , 0 )				// ���[����]

	Wait(FADE_NORMAL)

	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	//	"SAHAD"
	TalkMes("SAHAD","#1765V#000e#000m���A�߂��Ō���Ɖ��ăf�J�����c�c","","")
	WaitPrompt()
	WaitCloseWindow()

	//	"LAXIA"
	TalkMes("LAXIA","#0931V#000e#000m�����c�c���̃W�����_������",
		"��#2R���邶#R�Ƃ������Ƃ���ł��傤���B","")
	WaitPrompt()
	TalkMes("LAXIA","#0932V#000e#000m���̗l�q�ł͍����",
		"�������Ă��ꂻ���ɂ���܂���ˁB","")
	WaitPrompt()
	WaitCloseWindow()

	//	"RICOTTA"
	ChangeAnimation( "RICOTTA" , "ANI_EV_SETARM", -1 , 1 )
	TalkMes("RICOTTA","#2684V#000e#000m�����A�q��ɏ������I","","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

//	ChangeAnimation( "ADOL" , "ANI_EV_SETARM", -1 , 1 )
	ChangeAnimation( "LAXIA" , "ANI_EV_SETARM", -1 , 1 )
	ChangeAnimation( "SAHAD" , "ANI_EV_SETARM", -1 , 1 )

	WaitAnimation2( "SAHAD" , -1, 1, "ANI_EV_SETARM",  0)

	Wait(15)

	StopThread(1003)

	Blur( BLUR_TYPE_AFTERIMAGE ,0.3f , 15 )
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE ,325.954f , -6.432f , 779.717f , 110 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 9.639f , 110)		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -28.812f , 140 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE ,40.895f  ,  180 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.5f , 60 )		// ���[����]
	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,34.000f, 110)		// ����p

	//MoveCameraAt( 0 , 325.954f , -6.432f , 779.717f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 9.639f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -28.812f , 0 )	// ��{�p
	//RotateCamera( 0 , 40.895f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 34.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , -2.2f , 0 )				// ���[����]

	Wait(80)

	Slow(0.30)
	PlaySE(SE_M03S270_08, 99, 0, 0, 0, 1.0f, 0)	//�Њd
	Blur( BLUR_TYPE_AFTERIMAGE ,0.3f , -1 )
	ChangeAnimation( "ev_b003" , "ANI_EV_IKAKU", -1 , 1 )
	LookReset("ev_b003")

	Wait(15)

	Slow(0.75)
	Wait(5)

	PlaySE( SE_M03S270_01 , 100 , 0,  0, 0, 1.0f, 0)		//���K
	EarthQuake( 0.03f , 0.045f , 70 )
	Blur( BLUR_TYPE_AFTERIMAGE ,0.8f , -1 )

	Wait(25)


//�@�@�˃{�X�퓬��

	/////////////////////////////////////////////
	//�����싖���ɃJ�����ݒ�l���{�X�풆�ƍ��킹��ꍇ�́A
	//	�{�X��̐ݒ�C�x���g (EV_RetryBoss) �ňȉ��̖��߂������p���������B
	//	���ݒ肵�Ȃ��Ă��{�X������ɐݒ肵�܂����A�J�������J�ڂ���l�q���ڎ��ł����ԂƂȂ�܂��B
	//
	//	#include "inc/enemy/b003.h"
	//
	//	�E����ɒ��n������ԂŃX�^�[�g����ꍇ
	//		SetYs8Camera(B003_CAMERA_LAND_DIST, B003_CAMERA_LAND_FOV, B003_CAMERA_LAND_DIP, B003_CAMERA_LAND_ADDZ, B003_CAMERA_LAND_ADDZ)
	//	�E���̍���ɒ��n������ԂŃX�^�[�g����ꍇ
	//		SetYs8Camera(B003_CAMERA_LAND_H_DIST, B003_CAMERA_LAND_H_FOV, B003_CAMERA_LAND_H_DIP, B003_CAMERA_LAND_H_ADDZ, B003_CAMERA_LAND_H_ADDZ)
	//	�E��s��ԂŃX�^�[�g����ꍇ
	//		SetYs8Camera(B003_CAMERA_FLY_DIST, B003_CAMERA_FLY_FOV, B003_CAMERA_FLY_DIP, B003_CAMERA_FLY_ADDZ, B003_CAMERA_FLY_ADDZ)
	/////////////////////////////////////////////

//�@�@��ʃt�F�[�h�A�E�g�B
	FadeOut(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	Blur( BLUR_TYPE_AFTERIMAGE ,0.7f , 0 )
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)

	Wait(30)


//�I��������������----------------------------------------------------
	CallFunc("mp4341:EV_M03S270_ED")
}

function "EV_M03S270_ED"											//�C�x���g�X�L�b�v�p�ɏI��������ʂ�function�Ƃ��ėp�ӂ��܂��B
{
	SetSkipScript("")												//�I�������̓X�L�b�v�֎~
	RestoreEventState()

	ResetChrInfoFlag( "ev_b003" , INFOFLAG_ANYTIMECALC )
	SetChrPos("ev_b003",-100000.00f, 00.00f, 00.00f )
	EventAreaEnable( "evb2_BossStart" , 0 )

	//�L�����N�^�[������
	CallFunc("system:reset_chrmot_ADOL")
	CallFunc("system:reset_chrmot_LAXIA")
	CallFunc("system:reset_chrmot_SAHAD")
	CallFunc("system:reset_chrmot_RICOTTA")

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	// �ʏ�
	if ( !FLAG[SF_GALLERY_EVENT] )
	{
		//�}�[�J�[
		DelMapMarker( SMI_SYMBOL, PAGE_MP433x, MARKER_EV_M03S270, 0,0)	//�����^�Ñ��o��

		SoundEfx( SEFX_VALLEY, 15 )

		SetFlag( GF_GALL_EV_03_08, 1 )		 // M03S270:�����^�Ñ��o��
				
		//�G�t�F�N�g��~
		StopEffect(-1,ALL,1)

		EventCue("mp4341:EV_RetryBoss")
		ResetStopFlag(STOPFLAG_EVENTIMPOSE)
	}
	// �C�x���g�M�������[��
	else
	{
		FadeBGM(100,15)
		SoundEfx( SEFX_DEFAULT, 15 )
		SetEnvSEPlayState(-1, 0)	//��SE�S��~
		GalleryEvEnd(0)		// �C�x���g�M�������[�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		ResetStopFlag(STOPFLAG_EVENTIMPOSE)
	}

//�I�����������܂�----------------------------------------------------
}


function "EV_M03S270_ricotta_move"
{
	SetMotSpd("RICOTTA" , -1 , 0.95)
	ExecuteCmd( 2, MoveTo, "RICOTTA" ,416.49f,-4.53f,759.63f, 0.1f , 0.178f )
	//SetChrPos("RICOTTA",411.63f,-3.13f,759.63f)
	//Turn("RICOTTA",84.05f,360.0f)
	//SetChrPos("RICOTTA",416.49f,-4.53f,759.63f)
	//Turn("RICOTTA",105.42f,360.0f)

	Wait(140)

	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKR_E,1)
	Look("RICOTTA" ,  -45 , 15 )

	WaitThread(2)
	EmotionEx("RICOTTA", 0.00f,2,5,5,1,1,1.6f)	// �I
	Wait(40)

	Look("RICOTTA" ,  -45 , 0 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_ANGER_S,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKL_S,1)

	LookChr("ADOL" , "RICOTTA")
}

function "EV_M03S270_boss_move"
{
	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_RUN", -1 , 1 )


	ExecuteCmd( 10, MoveTo, "ev_b003" ,321.63f,-117.98f,807.99f, 0.1f , 13.00f )
	//SetChrPos("ev_b003",356.04f,-54.61f,807.99f)
	//Turn("ev_b003",18.91f,360.0f)
	//SetChrPos("ev_b003",321.63f,-117.98f,807.99f)
	//Turn("ev_b003",13.19f,360.0f)

	ExecuteCmd( 12, RollChr, "ev_b003"	,30 , 30 )


	WaitThread(10)
	StopThread(12)
	Wait(5)

	SetChrPos("ev_b003",282.81f,-163.90f,843.71f)
	Turn("ev_b003",145.02f,360.0f)
	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_WALK", -1 , 1 )
	RollChr( "ev_b003" , 20 , 0 )

	Wait(10)

	ExecuteCmd(10,MoveRotate, "ev_b003" ,409.53f,-5.22f,759.63f  , -240 , 1.0f , 1  , 60.0f ,0 , 0 )

//	ExecuteCmd( 11, MoveTo, "ev_b003" ,118.50f,176.34f,843.71f, 0.1f , 10.00f )
//	//SetChrPos("ev_b003",118.50f,176.34f,843.71f)
//	//Turn("ev_b003",125.83f,360.0f)

	ExecuteCmd( 12, RollChr, "ev_b003"	,50 , 60 )

	Wait(45)
	ExecuteCmd( 12, PitchChr, "ev_b003"	,-15 , 30 )
//	ChangeAnimation( "ev_b003" , "ANI_EV_AIR_RUN", -1 , 1 )

	WaitThread(11)
	WaitThread(12)

}

function "EV_M03S280" 			//�����^�Ñ��{�X��I��
{
//�J�n������������-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENTIMPOSE)
	ResetStopFlag(STOPFLAG_CINEMA)
	
	FadeOut(FADE_WHITE,0)
	WaitFade()

	SaveEventState()
	SaveCamera()

	//�����������s�v�Ȃ��̂��B��
	ResetMotion( "ALL" , 1 )  
	StopEffect(-1,ALL,1)
	StopEmotion( "ALL" )
	ResetMoveVec("PARTYALL")

	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))
	
	//�L�����N�^�[������
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",404.62f,-6.89f,759.62f)
	Turn("ADOL",150.27f,360.0f)

	ChangeAnimation("ADOL","ANI_EV_ZEEWAIT_N", -1 , 1 )	
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_OPEN,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKL,1)
	LookReset("ADOL")
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI )
	Look("ADOL" , -15 , 10 )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",403.42f,-7.15f,759.62f)
	Turn("LAXIA",-126.81f,360.0f)
	ChangeAnimation("LAXIA","ANI_EV_ZEEWAIT_N", -1 , 1 )	
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_SAD_CLOSE,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("LAXIA")
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",406.21f,-6.47f,759.63f)
	Turn("SAHAD",123.95f,360.0f)
	ChangeAnimation("SAHAD","ANI_EV_ZEEWAIT_N", -1 , 1 )	
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_SAD_CLOSE,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_TAME,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("SAHAD")
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI )
	Look("SAHAD" , -25 , 25 )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",405.69f,-5.18f,759.63f)
	Turn("RICOTTA",63.51f,360.0f)
	ChangeAnimation("RICOTTA","ANI_EV_ZEEWAIT_N", -1 , 1 )	
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_SAD_CLOSE,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset("RICOTTA")
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI )

	SetChrPos("ev_b003",384.000f,5.900f,751.890f)
	Turn("ev_b003",0.0f,360.0f)
	

	SetChrInfoFlag("ADOL" , INFOFLAG_INVISIBLE)
	SetChrInfoFlag("LAXIA" , INFOFLAG_INVISIBLE)
	SetChrInfoFlag("SAHAD" , INFOFLAG_INVISIBLE)
	SetChrInfoFlag("RICOTTA" , INFOFLAG_INVISIBLE)

	
	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )
	StopBGM(30)

	// Key Release
	KeyAnimeRelease(KEYANIME_EXSKILLPOS)
	KeyAnimeRelease(KEYANIME_EXSKILLROT)

	//--------------------
	// Pos Key
	KeyAnimeCreate(KEYANIME_EXSKILLPOS, 3)
	KeyAnimeSet(0, 383.804, -0.445, 764.878, 12.969, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(80, 382.389, 5.482, 767.578, 8.465, 0.006, 0.129, -0.061, -0.037, 0.006, 0.129, -0.061, -0.037)
	KeyAnimeSet(134, 384.600, 16.805, 756.764, 8.010, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)

	// Rot Key
	KeyAnimeCreate(KEYANIME_EXSKILLROT, 3)
	KeyAnimeSet(0, -19.257, -33.400, 35.235, 55.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	KeyAnimeSet(80, 18.204, 19.897, -33.418, 55.000, 0.526, 0.164, -0.260, 0.000, 0.526, 0.164, -0.260, 0.000)
	KeyAnimeSet(134, 51.247, -11.370, 0.330, 55.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000)
	//----------


	//�J�����ݒ�
	MoveCameraAt( 0 , 383.804f , -0.445f , 764.878f , 0 )	// �����_
	ChangeCameraDistance( 0 , 12.969f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -19.257f , 0 )	// ��{�p
	RotateCamera( 0 , 35.235f , 0 )				// �p�x
	ChangeCameraPers( 0 , 55.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -33.4f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 140.000 ,0.000 ,0.550 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	Wait(20)

	//�X�L�b�v����
	SetSkipScript("mp4341:EV_M03S280_ED")

	SoundEfx( SEFX_EV_VALLEY, 15 )

//�J�n���������܂�-----------------------------------------------

	ChangeAnimation( "ev_b003" , "ANI_EV_DEAD", -1 , 1 )
	FadeIn(FADE_WHITE,FADE_NORMAL)
	Wait(10)
	ExecuteCmd(1000, KeyAnimeCamera, 1.0f, KEYANIME_EXSKILLPOS, KEYANIME_EXSKILLROT, 0 )
	PlaySE(SE_M03S280_01, 70, 0, 0, 0, 1.0f, 0)

	Wait(38)
	Blur(BLUR_TYPE_EXPAND,0.45f, 50)	//�f�����H
	PlaySE(SE_M03S280_02, 100, 0, 0, 0, 1.0f, 0)

	Wait(40)
	PlaySE(SE_M03S280_04, 60, 0, 300, 0, 1.0f, 0)

	WaitThread(1000)
	PlaySE(SE_M03S280_03, 40, 0, 500, 0, 1.0f, 0)

	// Key Release
	KeyAnimeRelease(KEYANIME_EXSKILLPOS)
	KeyAnimeRelease(KEYANIME_EXSKILLROT)

	Wait(45)

	StopSE(SE_M03S280_03, 2000)

//�@�@���ő�������Ȃǔ敾�������Ă��郁���o�[�����B

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	PlaySE(SE_M03S280_05, 30, 0, 300, 0, 1.0f, 0)
	Wait(30)
	Wait(20)

	ResetChrInfoFlag("ADOL" , INFOFLAG_INVISIBLE)
	ResetChrInfoFlag("LAXIA" , INFOFLAG_INVISIBLE)
	ResetChrInfoFlag("SAHAD" , INFOFLAG_INVISIBLE)
	ResetChrInfoFlag("RICOTTA" , INFOFLAG_INVISIBLE)

	MoveCameraAt( 0 , 406.531f , -5.496f , 760.810f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.420f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -5.417f , 0 )	// ��{�p
	RotateCamera( 0 , 279.178f , 0 )				// �p�x
	ChangeCameraPers( 0 , 43.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -8.5f , 0 )				// ���[����]

	ExecuteCmd(1001, MoveCameraAt, INTERPOLATE_SPHERE , 406.580f , -5.799f , 761.033f , 250 )		// �����_
	ExecuteCmd(1002, ChangeCameraDistance, INTERPOLATE_SPHERE , 3.970f , 250 )		// ��{����
	ExecuteCmd(1003, ChangeCameraElevation, INTERPOLATE_SPHERE , -5.395f , 250 )		// ��{�p
	ExecuteCmd(1004, RotateCamera, INTERPOLATE_SPHERE , 279.178f ,  250 )		// �p�x
//	ExecuteCmd(1005, RollCamera, INTERPOLATE_SPHERE , 2.8f , 250 )		// ���[����]
//	ExecuteCmd(1006, ChangeCameraPers, INTERPOLATE_SPHERE ,39.000f, 250 )		// ����p

	//MoveCameraAt( 0 , 406.580f , -5.799f , 761.033f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 3.970f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -5.395f , 0 )	// ��{�p
	//RotateCamera( 0 , 279.178f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 43.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , -8.5f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B


	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 1.000, 20.000 ,0.000 ,0.550 ,0.500)

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	Wait(10)
	
	SetStopFlag(STOPFLAG_CINEMA)
	Wait(10)

	TalkMes("SAHAD","#1766V#000m���A�������̂��c�c","","")
	WaitPrompt()
	WaitCloseWindow()

	//	"RICOTTA"
	TalkMes("RICOTTA","#2685V#000m���R�b�^�A�������ɃN�^�N�^�c�c","","")
	WaitPrompt()
	WaitCloseWindow()

	Wait(20)

	CrossFade(FADE_FAST)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)
	StopThread(1004)
	StopThread(1005)

	MoveCameraAt( 0 , 403.723f , -7.350f , 761.058f , 0 )	// �����_
	ChangeCameraDistance( 0 , 3.020f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -1.523f , 0 )	// ��{�p
	RotateCamera( 0 , 150.385f , 0 )				// �p�x
	ChangeCameraPers( 0 , 26.800f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , -2.5f , 0 )				// ���[����]

	Look("ADOL" , -25 , 0 )
	ChangeAnimation( "ADOL" , "ANI_EV_ZEEWAIT_N_E", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKL_E,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_OPEN_E,1)

	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )

	Wait(FADE_FAST)

	WaitAnimation2( "ADOL" , -1, 1, "ANI_EV_ZEEWAIT_N_E",  0)
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_CLOSE_E,1)

	ChangeAnimation( "LAXIA" , "ANI_EV_ZEEWAIT_N_E", -1 , 1 )

	//	"LAXIA"
	TalkMes("LAXIA","#0933V#000m�ł��A����Łc�c","","")
	WaitPrompt()
	WaitCloseWindow()

	WaitAnimation2( "LAXIA" , -1, 1, "ANI_EV_ZEEWAIT_N_E",  0)

	LookSpd("LAXIA",0.08f,0.08f,0.08f)
	LookChr("LAXIA" , "ADOL")

	TalkMes("LAXIA","#5888V#012e�A�h���A����֌������܂��傤�B","","")
	WaitPrompt()

	LookSpd("ADOL" , 0.10, 0.10, 0.10)
	LookChr("ADOL" , "LAXIA")

	ChangeAnimation( "LAXIA" , "ANI_EV_TEBURI", -1 , 1 )
	TalkMes("LAXIA","#0934V#000m���̖k�����ǂ��Ȃ��Ă���̂��c�c",
		"�悤�₭������͂��ł��B","")
	WaitPrompt()
	WaitCloseWindow()
	ResetStopFlag(STOPFLAG_CINEMA)

	//�@�@�A�h���A�������[�V������������ɑ��싖�B
	HeadYes("ADOL" , 1 , 25 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_CLOSE_S,1)
	Wait(20)
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_CLOSE_E,1)
	Wait(25)

	CrossFade(FADE_FAST)
	LookReset("LAXIA")
	LookReset("ADOL")

	MoveCameraAt( 0 , 402.753f , -6.671f , 761.209f , 0 )	// �����_
	ChangeCameraDistance( 0 , 4.500f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -4.862f , 0 )	// ��{�p
	RotateCamera( 0 , 66.972f , 0 )				// �p�x
	ChangeCameraPers( 0 , 46.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 402.580f , -7.077f , 761.209f , 120 )		// �����_
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 4.500f, 120 )		// ��{����
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -4.862f , 120 )		// ��{�p
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 66.972f ,  120 )		// �p�x
//	ExecuteCmd(1004, RollCamera, INTERPOLATE_SPHERE ,-7.5f , 60 )		// ���[����]
//	ExecuteCmd(1005, ChangeCameraPers, INTERPOLATE_SPHERE ,34.000f, 110)		// ����p

	//MoveCameraAt( 0 , 402.580f , -7.077f , 761.209f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 4.500f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , -4.862f , 0 )	// ��{�p
	//RotateCamera( 0 , 66.972f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 46.000f , 0 )			// ����p
	//SetCameraZPlane( 0.100f , 600.000f )			// ZPlane
	//RollCamera( 0 , 0.0f , 0 )				// ���[����]

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 3.000, 90.000 ,1.000 ,0.700 ,0.500)

	Turn("ADOL",87.38f,7.0f)

	Wait(30)

	Turn("LAXIA",132.45f,8.0f)
	ChangeAnimation( "LAXIA" , "ANI_EV_WAIT2_S", -1 , 1 )
	Look("LAXIA" , -40 , 10 )

	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	WaitThread(1004)

//�@�@��ʃt�F�[�h�A�E�g�B
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp4341:EV_M03S280_ED")
}

function "EV_M03S280_ED"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,FADE_FAST)

	RestoreEventState()
	SetSkipScript("")

	//�L�����N�^�[������
	CallFunc("system:reset_chrmot_ADOL")
	CallFunc("system:reset_chrmot_LAXIA")
	CallFunc("system:reset_chrmot_SAHAD")
	CallFunc("system:reset_chrmot_RICOTTA")

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	SetChrPos("ev_b003" , -100000.0f ,0 ,0 )

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�t���O����
	SetFlag(SF_SETRAMSAVE,1)		//���g���C�Z�[�u
	SetFlag( SF_BOSS_BATTLE, 0 )
	SetFlag( GF_03MP4341_KILL_ANCIENT, 1 )			// �����^�Ñ��{�X��I��
	if(FLAG[GF_TBOX_DUMMY111]) //if skill shuffle is on
    {
        CallFunc("rng:0560")
		CallFunc("rng:0561")
    }

	CallFunc("mp4341:init")

	//�C�x���g��̍Ĕz�u�ʒu
	SetChrPos("PLAYER1",396.46f,-8.90f,759.63f)
	Turn("PLAYER1",92.24f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )
	PlayBGM(BGM_4341, 0)
	SoundEfx( SEFX_VALLEY, 15 )

	//�J�����ʒu���Aor�����ʒu�ݒ�

	MoveCameraAt( 0 , 396.460f , -8.903f , 762.480f , 0 )	// �����_
	ChangeCameraDistance( 0 , 9.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 9.000f , 0 )	// ��{�p
	RotateCamera( 0 , 83.283f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 1500.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	CallFunc("system:camera_reset")
	
	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//���T�u�C�x���g�Z�N�V����

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//������������������������������������������������������������
//���}�X�^�[�R���O�̃��b�Z�[�W����
//������������������������������������������������������������
function "Speedrun_Monkey4"
{
	//���N�G�X�g�B���� && !�u���E�Ő퓬���I��点���v

	//�@�@�}�X�^�[�R���O�ɘb��������ƁA�C�x���g�J�n�B
	//�@�@�}�X�^�[�R���O�̑O�ɁA�p�[�e�B�����o�[�S����z�u����B

	//	�ˁ��B�Ő퓬���I��点��

//�J�n������������----------------------------------------------------

	CallFunc("system:party_reset")
	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",385.25f,-10.87f,759.63f)
	Turn("ADOL",120.11f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA", 384.36f,-10.36f,759.63f)
	Turn("RICOTTA", 120.11f, 360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",384.86f,-11.78f,759.63f)
	Turn("LAXIA",128.85f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",386.05f,-10.09f,759.63f)
	Turn("SAHAD",114.88f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",386.90f,-11.12f,759.63f)
	Turn("HUMMEL",112.99f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",386.05f,-11.93f,759.63f)
		Turn("DANA",123.05f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",380.40f, -8.23f, 759.63f)
	Turn("Monkey",-57.79f,360.0f)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookReset( "Monkey" )

	LookChr("ADOL", "Monkey")
	LookChr("LAXIA", "Monkey")
	LookChr("SAHAD", "Monkey")
	LookChr("RICOTTA", "Monkey")
	LookChr("HUMMEL", "Monkey")
	LookChr("DANA", "Monkey")

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 383.834f , -9.298f , 761.643f , 0 )	// �����_
	ChangeCameraDistance( 0 , 5.800f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -4.354f , 0 )	// ��{�p
	RotateCamera( 0 , 30.728f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 200.000 ,1.000 ,0.700 ,0.500)

	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetFlag(TF_MENU_SELECT,0)
	SetSkipScript("mp4341:Speedrun_Monkey4_ED")

//�J�n���������܂�-----------------------------------------------

	Wait(10)

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	//	�ː퓬�\�ȃ^�C�~���O�����A���n�}���S�[���������Ă��Ȃ��ꍇ
	if(	ALLITEMWORK[ICON3D_US_MANGO_S] == 0 )	//�u���n�}���S�[�v�������Ă��Ȃ�  FLAG[GF_NPC_5_04_GOTO_HOLLOW] &&		//����ܕ��C��󓴂֌�����
	{
		//�@�@�����ڂ���Ď��U��B
		ChangeSubAnimation("Monkey", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
		HeadNo("Monkey" , 1 , 25)
		Wait(30)
		
		TalkPopup("RICOTTA",0,2,0,0,0)
		{
			"#000e#000m������[�����Ă�B"
			"�w��V�������҂͑���ɂ��ʁx\p"
			"�݂�ȁA�w���n�}���S�[�x�p�ӂ���I"
		}
		WaitPrompt()
		WaitCloseWindow()
		
		SetFlag(TF_MENU_SELECT,0)
	}
	//	�ː퓬�\�ȃ^�C�~���O�A�����n�}���S�[���������Ă���ꍇ
	else if( 	ALLITEMWORK[ICON3D_US_MANGO_S] )		//�u���n�}���S�[�v�������Ă��� FLAG[GF_NPC_5_04_GOTO_HOLLOW] &&	//����ܕ��C��󓴂֌�����
	{
		//�@�@�ėp�{�C�X�u���قفi�m��u��������ȁv�j�v���Đ����A
		//�@�@�ȉ��̏����B
		PlayVoice(Y8V_5663,"Monkey",100)
		
		//��������������������������������������������
		//	�ˏ���̂�
		if( !FLAG[GF_SPEEDRUN_SKILL_LAXIA_1ST] )	// ��荞�݃X�L���K���F�C�����N�V���u�r�}�X�^�[�R���O�@�����b
		{
			TalkPopup("RICOTTA",0,2,0,0,0)
			{
				"#000e#000m�w���͊��n�}���S�[�̂悤��"
				"�@�����������Ȕ��F�̖��A����Ɏ����悤�x"
				"�ƌ����Ă�B"
			}
			WaitPrompt()
			WaitCloseWindow()
			
			ChangeAnimation( "LAXIA", "ANI_EV_TEMUNE_S", -1, 1 )	// �苹����
			
			TalkPopup("LAXIA",0,2,0,0,0)
			{
				"#000e#000m��A�킽�����̂��Ƃł����H"
			}
			WaitPrompt()
			WaitCloseWindow()
			
			SetFlag( GF_SPEEDRUN_SKILL_LAXIA_1ST, 1 )	// ��荞�݃X�L���K���F�C�����N�V���u�r�}�X�^�[�R���O�@�����b
		}
		//��������������������������������������������

		//	�i���[�V����
		TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
		{
			"#7C������[��#2C�u#245I���n�}���S�[�v#7C�����サ�܂����H"
			"#7C�����シ��ƁA���N�V����l��"
			"#7C  ������[�Ɛ퓬���s���܂��B"
		}
		WaitPrompt()
		WaitCloseWindow()

		//�I����
		SetFlag(TF_MENU_SELECT,0)
		MenuReset()
		MenuType(MENUTYPE_POPUP)
//		MenuAdd(1,"�w���n�}���S�[�x�����シ��")
		MenuAdd(1,"#2C#245I���n�}���S�[#0C�����シ��")
		MenuAdd(2,"��߂Ă���")
		MenuOpen( TF_MENU_SELECT , -1 , ADOLMENU_PPOSY , -2 , -2 , 10 , 0)
		WaitMenu(0)
		MenuClose(10,0)
		
		//��������������������������������������������
		//	�ˁw���n�}���S�[�x�����シ��
		if (FLAG[TF_MENU_SELECT] == 1)
		{
			//	�A�C�e�����n���b�Z�[�W
			TalkPopup(UNDEF, 0, 5, 0, 0, 0)
			{
				"#8S"
				//"#7C������[��#2C#245I���n�}���S�[#7C�����サ���I"
				"#-1W#4C������[��#2C�u#245I���n�}���S�[�v#4C�����サ���I"
				"#8S"
			}
			WaitPrompt()
			WaitCloseWindow()
			StopBGM(60)
			//�@�@����ʈÓ]���āu�퓬�J�n�C�x���g�v�ɐڑ�
		}
		//	�˂�߂Ă���
		else if (FLAG[TF_MENU_SELECT] == 2)
		{
			//�@�@�����Ȃ��ő��싖�B
		}
		//��������������������������������������������
	}
	//	�ː퓬���ł��Ȃ��^�C�~���O
	//	  �u���B�Ő퓬���I��点���v&& !�u����ܕ��C��󓴂֌������v
	else
	{
		//�@�@�}�X�^�[�R���O���ڂ���Ď��U��B
		ChangeSubAnimation("Monkey", SUBMOT_EYE, ANI_E_CLOSE_S, 1)
		HeadNo("Monkey" , 1 , 25)
		Wait(30)

		TalkPopup("RICOTTA",0,0,0,0,0)
		{
			"#000e#000m������[�����Ă�B2"
			"�w�����}���ȁA�������Ղ��Ă���x\p"
			"�݂�ȁA�܂����߂ė���B"
		}
		WaitPrompt()
		WaitCloseWindow()

		SetFlag(TF_MENU_SELECT,0)
	}

	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp4341:Speedrun_Monkey4_ED")
}
function "Speedrun_Monkey4_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//	�ˁw���n�}���S�[�x�����シ��
	if( FLAG[TF_MENU_SELECT] == 1 )
	{
		DeleteItem( ICON3D_US_MANGO_S, 1 )			// �w���n�}���S�[�x
			
		//�@�@����ʈÓ]���āu�퓬�J�n�C�x���g�v�ɐڑ�
		EventCue("mp4341:Speedrun_Monkey4_Battle")
	}

	//	�ː퓬���ł��Ȃ��^�C�~���O
	//	�˂�߂Ă���
	//�C�x���g�X�L�b�v
	else
	{
		//�@�@���싖��
		CallFunc("mp4341:init")

		//�C�x���g��̍Ĕz�u
		SetChrPos("LEADER",386.67f,-10.23f,759.63f)
		Turn("LEADER",107.03f, 360.0f)
		ResetPartyPos()
		ResetFollowPoint()
		//Wait(1) //�����҂��p

		//�J�����ʒu���A
		//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
		//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
		//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
		//RotateCamera( 0 , 0.0f , 0 )				// �p�x
		//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
		//SetCameraZPlane( 0 , 0.0f )					// ZPlane
		//RollCamera( 0 , 0.0f , 0 )					// ���[����]

		RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
		CallFunc("system:camera_reset")

		ResetStopFlag(STOPFLAG_EVENT)

		FadeIn(FADE_BLACK,FADE_FAST)
		//WaitFade()
	}
//�I�����������܂�----------------------------------------------------
}
//������������������������������������������������������������
//���퓬�J�n�C�x���g
//������������������������������������������������������������
function "Speedrun_Monkey4_Battle"
{
	//�����N�V���u�r�}�X�^�[�R���O

//�J�n������������----------------------------------------------------

	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",390.75f,-11.89f,759.63f)
	Turn("LAXIA",111.11f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookChr( "LAXIA", "Monkey")
	SetChrWork( "LAXIA" , CWK_BATTLEMODE , 1 )

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",380.40f, -8.23f, 759.63f)
	Turn("Monkey",-57.79f,360.0f)
	ChangeAnimation( "Monkey" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookChr( "Monkey", "LAXIA" )

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",393.81f,-9.84f,759.63f)
	Turn("ADOL",93.43f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",393.89f,-8.94f,759.63f)
	Turn("RICOTTA",93.43f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",393.96f,-10.79f,759.63f)
	Turn("SAHAD",93.85f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",394.25f,-7.81f,759.63f)
	Turn("HUMMEL",93.72f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",394.41f,-11.66f,759.63f)
		Turn("DANA",103.10f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 387.912f , -10.210f , 760.750f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 7.034f , 0 )	// ��{�p
	RotateCamera( 0 , 35.763f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 200.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
//	SetSkipScript("mp4341:Speedrun_Monkey4_Battle_ED")

//�J�n���������܂�-----------------------------------------------

	PlayBGM(BGM_BOSS_002, 0)

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	//�@�@��ʃt�F�[�h�C�����āA�}�X�^�[�R���O�ƌ����������N�V���B
	//�@�@���Ԃ͎��͂ɂ���B

	//�@�@�}�X�^�[�R���O���Њd���[�V����������Đ퓬�J�n�B
	ChangeAnimation( "Monkey", "ANI_UNI1", -1, 1 )
	Wait(10)
	PlayVoice(Y8V_5652, "Monkey", 100)	//���ق��������c�i�C�����𗭂߂� 
	Wait(35)

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	WaitAnimation2( "Monkey" , -1, 1, "ANI_UNI1",  0)


//�I��������������----------------------------------------------------
	CallFunc("mp4341:Speedrun_Monkey4_Battle_ED")
}
function "Speedrun_Monkey4_Battle_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�L�����N�^�[������
	CallFunc("system:reset_chrmot_ALL")

	// �}�X�^�[�R���O����ʊO�Ɉړ�
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	//NowLoading ���� Tips �\�����J�b�g
	SetFlag(TF_LOADING_TIPS_OFF, 1)

	CallFunc("system:camera_reset")

	EventCue("mp4341:Retry_Speedrun_Monkey4_Battle")

	ResetStopFlag(STOPFLAG_EVENT)
}
// �퓬����
function "Retry_Speedrun_Monkey4_Battle"
{
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK,0)
	WaitFade()

	//���N�V���ЂƂ� -----------------------------------
	SavePartyMember()							// ���݂̃p�[�e�B�Ґ����o����
	// �p�[�e�B�Ґ��\�󋵃o�b�N�A�b�v
	SetFlag(SF_ADOL_JOINOKBK, FLAG[SF_ADOL_JOINOK])
	SetFlag(SF_LAXIA_JOINOKBK, FLAG[SF_LAXIA_JOINOK])
	SetFlag(SF_SAHAD_JOINOKBK, FLAG[SF_SAHAD_JOINOK])
	SetFlag(SF_HUMMEL_JOINOKBK, FLAG[SF_HUMMEL_JOINOK])
	SetFlag(SF_RICOTTA_JOINOKBK, FLAG[SF_RICOTTA_JOINOK])
	SetFlag(SF_DANA_JOINOKBK, FLAG[SF_DANA_JOINOK])
	// �ЂƂ肾���ɂ���
	SetFlag(SF_ADOL_JOINOK, 0)
	SetFlag(SF_LAXIA_JOINOK, 1)
	SetFlag(SF_SAHAD_JOINOK, 0)
	SetFlag(SF_HUMMEL_JOINOK, 0)
	SetFlag(SF_RICOTTA_JOINOK, 0)
	SetFlag(SF_DANA_JOINOK, 0)
	SetPartyMember(PARTY_LAXIA, -1, -1)

	//�{�X�z�u�E�A�j��--------------------------------
	SetChrPos("mons_Monkey",380.40f, -8.23f, 759.63f)
	Turn("mons_Monkey",-75.56f,360.0f)
	ChangeAnimation("mons_Monkey", "ANI_WAIT", -1, 1)

	//PLAYER�z�u--------------------------------------
	SetChrPos("PLAYER1",390.75f,-11.89f,759.63f)
	Turn("PLAYER1",111.11f,360.0f)
	//TurnToChr("PLAYER1" , "mons_Monkey" , 360.0f )
	//TurnToChr("mons_Monkey" , "PLAYER1" , 360.0f )

	//�J�����ݒ�--------------------------------------
	// arg�̐ݒ���㏑������
//	SetYs8Camera(7.0f, 60.0f, 10.0f, 0.0f, 0.0f)		//�c�c�{�X���[�`���쐬�҂̎w�肪����Γ���
	MoveCameraAt( 0 , 390.044f , -10.695f , 761.494f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 14.000f , 0 )	// ��{�p
	RotateCamera( 0 , 76.368f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	//�C�x���g�o�g���pCallFunc------------------------
	CallFunc("system:boss_start")						//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���̑�����--------------------------------------
	PlayBGM(BGM_BOSS_002, 15)	//�����ؔŗp��
	MapAnime("CT_boss", "close")		// �{�X�����߂�����
	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 1)			// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j
	SetFlag( GF_QS400_KONG_LV, 3)					// �}�X�^�[�R���O�̃L�������[�h�i3=���N�V���j
	SetLevel( "mons_Monkey", 52 )					// �}�X�^�[�R���O��Lv.52
	
	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	ResetStopFlag(STOPFLAG_EVENT)
	//------------------------------------------------

	//��������������������������������������������
	//	�ː퓬�ɏ���
	//		Speedrun_Monkey4_Win
	//	�˔s�k
	//		Speedrun_Monkey4_Lose
	//��������������������������������������������
}
// �퓬�s�k���C�x���g
function "Speedrun_Monkey4_Lose"
{
	//�����N�V���u�r�}�X�^�[�R���O
	//	�˔s�k

//�퓬�I��������������-----------------------------------------------

	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)								//�c�c���G�n�m

	Wait(90)											//�c�c�{�X���S���[�V���������違�h���b�v�A�C�e�����E������
	StopBGM(90)
	Wait(60)

	//�C�x���g�o�g���pCallFunc-------------------------
	CallFunc("system:boss_end")							//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���������E�{�X����-------------------------------
	MapAnime("CT_boss", "open")							//�c�c�������Ȃ��X�g�b�p�[�����B
	SetChrPos(mons_Monkey,-100000.00f,0.00f,0.00f)		//�c�c�{�X�������Ȃ��ʒu�ɔ�΂�
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))			//�c�c�U�R�Ȃ炱����

	//���㏈��-----------------------------------------
		////-----------------------------------
		//// �^�C���A�^�b�N��
		//if (FLAG[SF_TIMEATK])
		//{
		//	EndTimeAtk()		// �^�C���A�^�b�N�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		//}
		////-----------------------------------

	FadeOut(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 0)	// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j

//�퓬�I�����������܂�-----------------------------------------------
//�J�n������������-----------------------------------------------

//	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	// �p�[�e�B�Ґ��\�󋵂�߂�
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",386.67f,-10.23f,759.63f)
	Turn("LAXIA",107.03f, 360.0f)
	ChangeAnimation( "LAXIA" , "ANI_EV_ZEEWAIT2", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookChr( "LAXIA", "Monkey")

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",380.40f, -8.23f, 759.63f)
	Turn("Monkey",-57.79f,360.0f)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI", -1, 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookChr( "Monkey", "LAXIA" )

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",393.81f,-9.84f,759.63f)
	Turn("ADOL",93.43f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",393.89f,-8.94f,759.63f)
	Turn("RICOTTA",93.43f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",393.96f,-10.79f,759.63f)
	Turn("SAHAD",93.85f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",394.25f,-7.81f,759.63f)
	Turn("HUMMEL",93.72f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",394.41f,-11.66f,759.63f)
		Turn("DANA",103.10f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )

	//�J�����ݒ�
	MoveCameraAt( 0 , 383.678f , -7.977f , 761.444f , 0 )	// �����_
	ChangeCameraDistance( 0 , 6.500f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -11.849f , 0 )	// ��{�p
	RotateCamera( 0 , 39.175f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 200.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
//	SetSkipScript("mp4341:Speedrun_Monkey4_Lose_ED")
	
//�J�n���������܂�-----------------------------------------------
	
	FadeIn(FADE_WHITE,FADE_NORMAL)
	WaitFade()
	
	//�@�@���N�V�����G�����Ă���B

	TalkPopup("LAXIA",0,0,0,0,0)
	{
		"#000e#000m�܂��������܂łƂ́c�c"
		"�킽�����̊��s�ł��B"
	}
	WaitPrompt()
	WaitCloseWindow()

	//	�i���[�V����
	TalkPopup(UNDEF,0,3,SYSTEM_PPOSX,SYSTEM_PPOSY,0)
	{
		"#7C������[�ƍĐ킵�����ꍇ�́A"
//		"#7C�Ăсw���n�}���S�[�x�����サ�Ă��������B"
		"#7C�Ă�#2C�u#245I���n�}���S�[�v#7C�����サ�Ă��������B"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�C�x���g�I���A���싖�B
	FadeOut(FADE_BLACK,FADE_FAST)
	WaitFade()

//�I��������������----------------------------------------------------
	CallFunc("mp4341:Speedrun_Monkey4_Lose_ED")
}
function "Speedrun_Monkey4_Lose_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")	

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�t���O����
	SetFlag(SF_BOSS_BATTLE, 0)		//�{�X��I��

	// �}�X�^�[�R���O����ʊO�Ɉړ�
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	CallFunc("mp4341:init")

	//�C�x���g��̍Ĕz�u
	SetChrPos("LEADER",386.67f,-10.23f,759.63f)
	Turn("LEADER",107.03f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//�J�����ʒu���A
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
	//RotateCamera( 0 , 0.0f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ���[����]

	RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	PlayBGM(BGM_4341, 0)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}
//������������������������������������������������������������
//���N�G�X�g�B���C�x���g
//������������������������������������������������������������
function "Speedrun_Monkey4_Win"
{
	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)		//���G�n�m

	Wait(30)
	StopBGM(120)
	Wait(90)

	CallFunc("system:boss_end")
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_remove")
	CallFunc("system:party_reset")
	SetStopFlag(STOPFLAG_EVENT)
	
	// adding this line to remove the invisible walls after the fight
	MapAnime("CT_EVENT","open")							//……逃げられないストッパー解除

	// changed CueEvent to CallFunc
	CallFunc("mp4341:Speedrun_Monkey4_Win_ED")
}
function "Speedrun_Monkey4_Win_old"
{
	//�����N�V���u�r�}�X�^�[�R���O
	//	�ː퓬�ɏ���

//�퓬�I��������������-----------------------------------------------

	//���GON�E�F�X�I��������---------------------------
	SetFlag(SF_ALLMUTEKI,1)								//�c�c���G�n�m

	Wait(90)											//�c�c�{�X���S���[�V���������違�h���b�v�A�C�e�����E������
	StopBGM(90)
	Wait(60)

	//�C�x���g�o�g���pCallFunc-------------------------
	CallFunc("system:boss_end")							//�c�c�C�x���g�o�g���p�̐F�X�ȏ������s��function

	//���������E�{�X����-------------------------------
	MapAnime("CT_boss", "open")							//�c�c�������Ȃ��X�g�b�p�[�����B
	SetChrPos(mons_Monkey,-100000.00f,0.00f,0.00f)		//�c�c�{�X�������Ȃ��ʒu�ɔ�΂�
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))			//�c�c�U�R�Ȃ炱����

	//���㏈��-----------------------------------------
		////-----------------------------------
		//// �^�C���A�^�b�N��
		//if (FLAG[SF_TIMEATK])
		//{
		//	EndTimeAtk()		// �^�C���A�^�b�N�I���i�X�N���v�g���狭���I�ɔ����Ă��낢�돈�����Ă����j
		//}
		////-----------------------------------

	FadeOut(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	SetFlag( GF_SPEEDRUN_SKILL_BATTLE, 0)	// ��荞�݃X�L���K���F�퓬���Ǘ��p�i1���퓬���j

//�퓬�I�����������܂�-----------------------------------------------
//�J�n������������----------------------------------------------------

//	CallFunc("system:event_begin")

	//�C�x���g�J�n�O���̕ۑ�
	SaveEventState()
	SaveCamera()

	// �p�[�e�B�Ґ��\�󋵂�߂�
	SetFlag(SF_ADOL_JOINOK, FLAG[SF_ADOL_JOINOKBK])
	SetFlag(SF_LAXIA_JOINOK, FLAG[SF_LAXIA_JOINOKBK])
	SetFlag(SF_SAHAD_JOINOK, FLAG[SF_SAHAD_JOINOKBK])
	SetFlag(SF_HUMMEL_JOINOK, FLAG[SF_HUMMEL_JOINOKBK])
	SetFlag(SF_RICOTTA_JOINOK, FLAG[SF_RICOTTA_JOINOKBK])
	SetFlag(SF_DANA_JOINOK, FLAG[SF_DANA_JOINOKBK])

	//�L����������Ԃ̐ݒ�
	RestorePartyMember()						// �p�[�e�B�����o�[��߂�

	//�p�[�e�B��Ԃ̃��Z�b�g
	CallFunc("system:party_reset")

	//���̏������E�s�v�Ȃ��̂��B��
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//�L����������Ԃ̐ݒ�
	SetChrWork("LAXIA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("LAXIA",390.75f,-11.89f,759.63f)
	Turn("LAXIA",111.11f,360.0f)
	ChangeAnimation( "LAXIA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("LAXIA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("LAXIA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "LAXIA" , INFOFLAG_NOCHRATARI)
	LookReset( "LAXIA" )

	//�}�X�^�[�R���O
	SetChrWork("Monkey", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Monkey",380.37f, -9.16f, 759.63f)
	Turn("Monkey",-72.00f,360.0f)
	ChangeAnimation( "Monkey" , "ANI_DEAD2", -1 , 1 )
	ChangeSubAnimation("Monkey",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("Monkey",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("Monkey",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "Monkey" , INFOFLAG_NOCHRATARI)
	LookReset("Monkey")

	SetChrWork("ADOL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ADOL",393.81f,-9.84f,759.63f)
	Turn("ADOL",93.43f,360.0f)
	ChangeAnimation( "ADOL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("ADOL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("ADOL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "ADOL" , INFOFLAG_NOCHRATARI)
	LookReset( "ADOL" )

	SetChrWork("RICOTTA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("RICOTTA",393.89f,-8.94f,759.63f)
	Turn("RICOTTA",93.43f,360.0f)
	ChangeAnimation( "RICOTTA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("RICOTTA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("RICOTTA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "RICOTTA" , INFOFLAG_NOCHRATARI)
	LookReset( "RICOTTA" )

	SetChrWork("SAHAD", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("SAHAD",393.96f,-10.79f,759.63f)
	Turn("SAHAD",93.85f,360.0f)
	ChangeAnimation( "SAHAD" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("SAHAD",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("SAHAD",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "SAHAD" , INFOFLAG_NOCHRATARI)
	LookReset( "SAHAD" )

	SetChrWork("HUMMEL", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("HUMMEL",394.25f,-7.81f,759.63f)
	Turn("HUMMEL",93.72f,360.0f)
	ChangeAnimation( "HUMMEL" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("HUMMEL",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("HUMMEL",SUBMOT_EXT1,ANI_E_LOOKC,1)
	SetChrInfoFlag( "HUMMEL" , INFOFLAG_NOCHRATARI)
	LookReset( "HUMMEL" )

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
		SetChrPos("DANA",394.41f,-11.66f,759.63f)
		Turn("DANA",103.10f,360.0f)
		ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
		ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
		ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
		SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)
		LookReset( "DANA" )
	}

	LookChr("ADOL", "Monkey")
	LookChr("LAXIA", "Monkey")
	LookChr("SAHAD", "Monkey")
	LookChr("RICOTTA", "Monkey")
	LookChr("HUMMEL", "Monkey")
	LookChr("DANA", "Monkey")

	// ���N�V���̃G�t�F�N�g�����[�h
	SetFlag(TF_MENU_SELECT, 0)
	if (WORK[WK_ISEXIST_PLAYER1] && WORK[WK_PLAYER1] == LAXIA)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER2] && WORK[WK_PLAYER2] == LAXIA)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER3] && WORK[WK_PLAYER3] == LAXIA)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}
	else if (WORK[WK_ISEXIST_PLAYER4] && WORK[WK_PLAYER4] == LAXIA)
	{
		// ���ɓǂݍ��ݍς�
		SetFlag(TF_MENU_SELECT, 1)
	}

	if (FLAG[TF_MENU_SELECT] == 0)
	{
		// �܂��ǂ܂�ĂȂ�
		LoadEffect("efx_c002.ite")
	}

	//BGM�ݒ聟
	//PlayBGM( BGM_FIELD_101 , XX )
	PlayBGM(BGM_4341, 0)

	//�J�����ݒ�
	MoveCameraAt( 0 , 388.867f , -10.350f , 760.254f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 6.167f , 0 )	// ��{�p
	RotateCamera( 0 , 39.707f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// ��ʊE�[�x�̐ݒ�
	SetDoF(0, LERP_LINEAR, 5.000, 200.000 ,1.000 ,0.700 ,0.500)
	// �O���A�̐ݒ�
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//�X�L�b�v����
	SetSkipScript("mp4341:Speedrun_Monkey4_Win_ED")

//�J�n���������܂�-----------------------------------------------

	Wait(10)

	FadeIn(FADE_WHITE,FADE_NORMAL)
	WaitFade()

	//�@�@��ʃt�F�[�h�C�����āA
	//�@�@���G�����Ă���}�X�^�[�R���O�Ƃ��̑O�Ƀ��N�V���B
	//�@�@���Ԃ͎��͂ɂ���B

	TalkPopup("LAXIA",0,1,0,0,0)
	{
		"#000e#000m�����A���Ƃ��Ȃ�܂������B\p"
		"�m����قǂ͂��̂悤�Ɂc�c"
		"�m��3�s��"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@���N�V�������̏�Ń��s�b�h�e���y�X�g�𔭓�����
	CrossFade(FADE_CROSS)
	MoveCameraAt( 0 , 389.079f , -9.820f , 760.502f , 0 )	// �����_
	ChangeCameraDistance( 0 , 7.000f , 0 )		// ��{����
	ChangeCameraElevation( 0 , 7.677f , 0 )	// ��{�p
	RotateCamera( 0 , 279.856f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]

	LookReset( "LAXIA" )
	Wait(FADE_CROSS)

	ChangeAnimation( "LAXIA", "ANI_EV_SETARM", -1, 1 )
	WaitAnimation2( "LAXIA" , -1, 1, "ANI_EV_SETARM",  0)
	ChangeAnimation( "LAXIA", "ANI_SP_A1", -1, 1 )	//��A1�F���s�b�h�e���y�X�g�F�n��
	WaitAnimation2( "LAXIA" , -1, 1, "ANI_SP_A1",  0)
	Wait(20)

	//PlaySE(SE_TUTORIAL, 100, 0, 0, 0, 1.0f, 0)	//�`���[�g���A��
	PlaySE( SE_SKILLLEARN , 100 , 0,  0, 0, 1.0f, 0)

	//	�i���[�V����
//	TalkPopup(UNDEF,0,5,0,0,0)
//	{
//		""
//		"#4C���N�V���̓X�L��#2C�u���s�b�h�e���y�X�g�v#4C���K�������I"
//	}
//	WaitPrompt()
//	WaitCloseWindow()

	Message("#4C���N�V���̓X�L��#2C�u���s�b�h�e���y�X�g�v#4C���K�������I")
	WaitPrompt()
	Wait(10)

	PlayVoice(Y8V_0374,"LAXIA",100)	//�ӂӁi���΁j

	TalkPopup("LAXIA",0,0,0,0,0)
	{
		"#080e#080m�ӂӁA�Ȃ�قǁB"
		"����͑f���炵���Z�ł��ˁI"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)

	//�@�@��ʃN���X�t�F�[�h�ŁA���N�V�����Ĕz�u�����Ԃ������W�܂�B	��������
	CrossFade(FADE_FAST)
	SetChrPos("LAXIA", 384.36f,-10.36f,759.63f)
	Turn("LAXIA", 120.11f, 360.0f)
	SetChrWork( "LAXIA" , CWK_BATTLEMODE , 0 )
	ChangeAnimation( "LAXIA", "ANI_WAIT", -1, 1 )	// �ҋ@
	LookChr("LAXIA", "Monkey")
	SetChrPos("ADOL",385.25f,-10.87f,759.63f)
	Turn("ADOL",120.11f,360.0f)
	SetChrPos("RICOTTA",384.86f,-11.78f,759.63f)
	Turn("RICOTTA",128.85f,360.0f)
	SetChrPos("SAHAD",386.05f,-10.09f,759.63f)
	Turn("SAHAD",114.88f,360.0f)
	SetChrPos("HUMMEL",386.90f,-11.12f,759.63f)
	Turn("HUMMEL",112.99f,360.0f)

	//	�˃_�[�i������ꍇ
	if( FLAG[SF_DANA_JOINOK] )		// �_�[�i������
	{
		SetChrPos("DANA",386.05f,-11.93f,759.63f)
		Turn("DANA",123.05f,360.0f)
	}

	MoveCameraAt( 0 , 383.834f , -9.298f , 762.263f , 0 )	// �����_
	ChangeCameraDistance( 0 , 5.800f , 0 )		// ��{����
	ChangeCameraElevation( 0 , -4.354f , 0 )	// ��{�p
	RotateCamera( 0 , 30.728f , 0 )				// �p�x
	ChangeCameraPers( 0 , 60.000f , 0 )			// ����p
	SetCameraZPlane( 0.100f , 3000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ���[����]
	// ResetCameraZPlane()	// �C�x���g�I�����ɌĂяo���ĉ������B�}�b�v���̐ݒ�ɖ߂��܂��B

	// �J�����ړ�
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , 383.834f , -9.298f , 761.643f , 50 )

	Wait(FADE_CROSS)

	// �J�����҂�
	WaitThread(1000)

	//�@�@�}�X�^�[�R���O�������オ���ĉ�b���[�V�����B
	ChangeAnimation( "Monkey", "ANI_RESURRECT", -1, 1 )
	PlaySE(SE_MONKEY_01, 60, 0, 0, 0, 1.0f, 0)
	Wait(10)
	PlayVoice(Y8V_5664, "xxx", 100)	//���فI�i�����m��u���̒ʂ�I�v�j
	Wait(10)
	PlaySE(SE_MONKEY_02, 60, 0, 0, 0, 1.0f, 0)
	WaitAnimation2( "Monkey" , -1, 1, "ANI_RESURRECT",  0)
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI_S", -1, 1 )
	WaitAnimation2( "Monkey" , -1, 1, "ANI_EV_UDEGUMI_S",  0)

	TalkPopup("RICOTTA",0,0,0,0,0)
	{
		"#000e#000m������[�����Ă�B3"
		"�w���ށA�������x\p"
		"�w���x�́g�킵���Ȃ�啽���h"
		"�@�ɂĉ�Ƃ��悤�x"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("LAXIA", 1, 25)	// �L����, ���Ȃ�����, ����
	Wait(10)

	TalkPopup("LAXIA",0,2,0,0,0)
	{
		"#000e#000m�����A���肪�Ƃ��������܂��B"
	}
	WaitPrompt()
	WaitCloseWindow()

	//�@�@�}�X�^�[�R���O���ޏꂷ�郂�[�V�����B�i�W�����v���Ȃ��������j
	ChangeAnimation( "Monkey", "ANI_EV_UDEGUMI_E", -1, 1 )
	WaitAnimation2( "Monkey" , -1, 1, "ANI_EV_UDEGUMI_E",  0)

	//Turn("Monkey", 27.48f, 8.0f)
	Wait(10)
	ChangeAnimation( "Monkey", "ANI_EV_JUMP_S", -1, 1 )
	
	LookReset("ADOL")
	LookReset("LAXIA")
	LookReset("SAHAD")
	LookReset("HUMMEL")
	LookReset("RICOTTA")
	Wait(10)
	EarthQuake( 0.02f , 0.02f , 20 )	// �c�h�ꕝ, ���h�ꕝ, ����
	Blur(BLUR_TYPE_EXPAND, 0.2f, 30)	//�u���[

	if( FLAG[SF_DANA_JOINOK] ) {		// �_�[�i������
		LookReset("DANA")
	}
	WaitAnimation2( "Monkey" , -1, 1, "ANI_EV_JUMP_S",  0)
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	Wait(20)

	//�@�@��ʈÓ]�B
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	//�@�@�C�x���g�I���A���싖�B

//�I��������������----------------------------------------------------
	CallFunc("mp4341:Speedrun_Monkey4_Win_ED")
}
function "Speedrun_Monkey4_Win_ED"
{
	//�I�������̓X�L�b�v�֎~
	SetSkipScript("")

	//�C�x���g�O�̃L�������𕜋A
	RestoreEventState()

	//�B�������̂𕜋A�B
	ResetChrPos((CHRTYPE_MONS | RESET_POS))
//	ResetChrPos((CHRTYPE_MONS | RESET_STATUS))
//	ResetChrPos((CHRTYPE_MONS | RESET_AISTATE))

	//�L�������[�V����������
	CallFunc("system:reset_chrmot_ALL")	

	//�p�[�e�B�L���������
	ReleaseEventPartyChr()

	// �G�t�F�N�g��j������
	if (FLAG[TF_MENU_SELECT] == 0)
	{
		// �ǉ��œǂ�ł���ꍇ�̂ݔj��
		ReleaseEffect("efx_c002.ite")
	}

	//�}�b�v�p�����[�^�[���Z�b�g
	ResetMapParam(-1)

	//�t���O����
	SetFlag( GF_SPEEDRUN_SKILL_LAXIA, 1 )		// ��荞�݃X�L���K���F�C�����N�V���u�r�}�X�^�[�R���O����������
	SetFlag(SF_BOSS_BATTLE, 0)		//�{�X��I��
	if(FLAG[GF_TBOX_DUMMY111]) //if skill shuffle is on
    {
        CallFunc("rng:0583")
    }
	else
	{
		GetSkill(PARTY_LAXIA, SKILL_LAXIA_SP_A1, 1)	//���s�b�h�e���y�X�g
	}
	//�}�[�J�[�폜�Ɛݒu
	DelMapMarker( SMI_SUBEVENT, PAGE_MP433x, MARKER_SPEEDRUN_SKILL3, 0, 0)	// ��荞�݃X�L���K���F�W�����_�����ɋ���}�X�^�[�R���O�p
	SetMapMarker( SMI_SUBEVENT, PAGE_F034, MARKER_SPEEDRUN_SKILL4, -108.19f, 1078.36f, 42.24f, 	-108.19f, 1078.36f,	MARKER_SPEEDRUN_SKILL4, MN_F_MP6112,	0)	// ��荞�݃X�L���K���F�p���K�C�A�啽���ɋ���}�X�^�[�R���O�p

	// �}�X�^�[�R���O����ʊO�Ɉړ��i�C�x���g�X�L�b�v�����ꍇ�p�ɓ���Ă���܂��j
	SetChrPos("Monkey" , -100000.00f  , 0.00f ,0.00f )

	CallFunc("mp4341:init")

	//�C�x���g��̍Ĕz�u
	SetChrPos("LEADER",386.67f,-10.23f,759.63f)
	Turn("LEADER",107.03f, 360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //�����҂��p

	//�J�����ʒu���A
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// �����_
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// ��{����
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// ��{�p
	//RotateCamera( 0 , 0.0f , 0 )				// �p�x
	//ChangeCameraPers( 0 , 0.0f , 0 )			// ����p
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ���[����]

	RestoreCamera(0, 0)		//����L�J�����ʒu���w�肷��ꍇ�͕s�v
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//�I�����������܂�----------------------------------------------------
}
