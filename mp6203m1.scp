#include "inc/mons.h"
#include "inc/def.h"
#include "inc/flag.h"
#include "inc/se.h"
#include "inc/scr_inc.h"
#include "inc/3dicon.h"
#include "inc/skilldef.h"
#include "inc/vo.h"
#include "inc/music.h"
#include "inc/efx.h"
#include "inc/temp/mp6401m.h"

//----------------------------------------------------------------------------//
//                                                                            //
// 王都西街区（荒廃）  			                                              //
//                                                                            //
//----------------------------------------------------------------------------//
///////////////////////////////////////////////////////////////////////////////
// 初期化スクリプト
///////////////////////////////////////////////////////////////////////////////
//-------------------------------------------

function "init"
{
	CallFunc("rng:expMult")
	//遠景不必要ノード削除◆マップ作業者用
	MapHide( "@BG2_etania" , 0 )
	MapHide( "BG2_grandtemple" , 0 )

	//大樹の色制御
	MapAnime(gim_taiju , normal )

	// イベントエリア設定制御
	EventAreaEnable( "SubEV_Past_06_West" , 0 )		// 過去編Ⅵ：【サブイベント：西街区→中央区にいけない】イベントエリア無効化
	EventAreaEnable( "Stopper_Past_06_01" , 0 )		// 過去編Ⅵ：【ストッパー：西街区→中央区へ行けない】イベントエリア無効化
	EventAreaEnable( "Stopper_Past_06_11" , 0 )		// 過去編Ⅵ：【ストッパー：西街区→西街区民家へ入れない】イベントエリア無効化

	if( FLAG[SF_EVENT_ON] )
	{
//		MapAnime("dragon_gate_all_A1","open")	//◆仮処理

		//一般配置ファンクション呼び出し
		CallFunc("mp6203m1:NpcPosition")

		// 雪
		Set3DParticle(PARTICLE_TYPE_SNOW, 0.0f,0.0f,-0.1f, 0.1f,0.0f,0.2f, 0.0f,0.0f,0.0f, 0.0f,0.0f,0.0f, 180.0f, 0.0f)

		// イベントエリア制御
		if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
		{
			if( !FLAG[GF_SUBEV_PAST_06_WEST] )		// 過去編Ⅵ：【サブイベント：西街区→中央区にいけない】を見た
			{
				EventAreaEnable( "SubEV_Past_06_West" , 1 )		// 過去編Ⅵ：【サブイベント：西街区→中央区にいけない】
			}
		}
		
		// ストッパー制御
		if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
		{
			EventAreaEnable( "Stopper_Past_06_11" , 1 )		// 過去編Ⅵ：【ストッパー：西街区→西街区民家へ入れない】

			if( FLAG[GF_SUBEV_PAST_06_WEST] )		// 過去編Ⅵ：【サブイベント：西街区→中央区にいけない】を見た
			{
				EventAreaEnable( "Stopper_Past_06_01" , 1 )		// 過去編Ⅵ：【ストッパー：西街区→中央区へ行けない】
			}
		}
	}
}


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//■配置制御セクション

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function "NpcPosition"
{
	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )				//▼過去編Ⅵセレンの園へ向かう
	{
		//----------------大僧院前--------------------
		SetChrPos("Olga",-537.66f	862.38f	2.75f)
		Turn("Olga",-26.03f,360.0f)
		ChangeAnimation( "Olga", "ANI_EV_UDEGUMI", -1, 1 )

		SetChrPos("Shenna",-537.14f	860.98f	2.75f)
		Turn("Shenna",158.95f,360.0f)

		SetChrPos("Sister_6_A01",-533.31f	852.61f	2.75f)
		Turn("Sister_6_A01",-91.97f,360.0f)
		ChangeAnimation( "Sister_6_A01", "ANI_EV_TEMUNE", -1, 1 )
		Look("Sister_6_A01" , 0 , 20 )

		SetChrPos("Sister_6_A02",-532.75f	851.40f	2.75f)
		Turn("Sister_6_A02",-147.48f,360.0f)
		Look("Sister_6_A02" , 0 , -5 )

		SetChrPos("Citizen_6_A01",-531.78f	852.63f	2.75f)
		Turn("Citizen_6_A01",59.47f,360.0f)
		Look("Citizen_6_A01" , 0 , -20 )

		SetChrPos("Jirul",-531.40f	840.22f	3.84f)
		Turn("Jirul",-120.87f,360.0f)
		ChangeAnimation( "Jirul", "ANI_EV_TATEHIZA", -1, 1 )
		Look("Jirul" , 0 , 30 )

		SetChrPos("Kajura",-537.53f	831.61f	5.64f)
		Turn("Kajura",172.62f,360.0f)
		ChangeAnimation( "Kajura", "ANI_EV_ZETUBOU", -1, 1 )

		//----------------その他--------------------
		SetChrInfoFlag( "Matos" , INFOFLAG_NOMAPATARICHECK )
		SetChrInfoFlag( "Matos" , INFOFLAG_NOGRAVITY )
		SetChrPos("Matos",-516.71f	882.76f	1.50f)
		Turn("Matos",28.18f,360.0f)
		ChangeAnimation("Matos","ANI_EV_SIT_C", -1 , 1 )	
		Look("Matos" , 0 , -30 )

		SetChrPos("Citizen_6_A02",-495.45f	863.81f	1.43f)
		Turn("Citizen_6_A02",-128.67f,360.0f)
		//free

		SetChrPos("Citizen_6_A03",-437.55f	838.13f	1.43f)
		Turn("Citizen_6_A03",-60.15f,360.0f)
		Look("Citizen_6_A03" , 0 , -20 )

		SetChrPos("Citizen_6_A04",-435.90f	838.69f	1.43f)
		Turn("Citizen_6_A04",36.93f,360.0f)
		ChangeAnimation( "Citizen_6_A04", "ANI_EV_UDEGUMI", -1, 1 )
		Look("Citizen_6_A04" , 0 , -20 )

	}
	else if( FLAG[GF_PAST_EPISODE_5_GO_VALLAY] )		//▼過去編Ⅴ王家の谷へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_4_2_GO_OUT] )			//▼過去編Ⅳ-２王宮の外へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_4_GO_CASTLE] )		//▼過去編Ⅳ王宮前へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_3_GO_BAHA] )			//▼過去編Ⅲバハの塔へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_2_GO_SOUTHGATE] )		//▼過去編Ⅱ南門へ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_1_GO_CAMP] )			//▼過去編Ⅰアドルがいたポイントへ向かう
	{
	}
	else if( FLAG[GF_PAST_EPISODE_D3_WALK_CAPITAL] )	//▼ダーナ編③王都を歩く
	{
	}
	else if( FLAG[GF_PAST_EPISODE_D1A_TEM] )			//▼ダーナ編①Ａ寺院内を歩く
	{
	}
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//■一般会話セクション

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//──────────────────────────────
//	【オルガ祭司長】
//──────────────────────────────
function "Talk_Olga"
{

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：シェンナと話す
		//	モーション	：
		//───────────────
		//　　★ＧＦ初回
		if( !FLAG[GF_1STTALK_PAST_6_OLGA] )
		{
			//────────  一般・開始処理(過去編)  ──────────
			SetStopFlag(STOPFLAG_TALK2)
			//───────────────
			//	場所		：王都中央区（過去）・西エリア
			//───────────────
			//	配置・カメラ：奥のベンチで休む
			//	モーション	：
			//───────────────
			SaveCamera()
MoveCameraAt( 0 , -538.059f , 862.577f , 4.408f , 0 )	// 注視点
ChangeCameraDistance( 0 , 0.554f , 0 )		// 基本距離
ChangeCameraElevation( 0 , 11.887f , 0 )	// 基本仰角
RotateCamera( 0 , 242.719f , 0 )				// 角度
ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
RollCamera( 0 , 0.0f , 0 )				// ロール回転
// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

			//キャラ初期動作の記述
			LookSpd("this", 1.0f, 1.0f, 1.0f)
			LookTo("this",-538.18f	862.29f	3.95f)	// 首

			SetChrPos("Olga",-537.34f,862.42f,2.75f)
			Turn("Olga",97.74f,360.0f)

			ChangeSubAnimation("this",SUBMOT_EYE,ANI_E_ANGER_CLOSE,1)

			CallFunc("system:talkevent_begin")		//TALK_BEGIN
			LookSpd("this", LOOKSPD_DEFAULT, LOOKSPD_DEFAULT, LOOKSPD_DEFAULT)
			//───────────────────────────────

			//	オルガ祭司長
			TalkPopup("this",0,0,0,0,0)
			{
				"#000m王宮が門を閉ざして数ヶ月……\p"
				"王宮2行目"
				"女王の布告は何度かあったが、"
				"サライとは会えていない……"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeSubAnimation("this",SUBMOT_EYE,ANI_E_ANGER_CLOSE_E,1)
			LookTo("this",-538.46f	862.72f	4.35f)	// 首を正面に向ける
			PlayVoice(Y8V_5314,"this",100)	//ふむ（平常のテンション）

			TalkPopup("this",0,0,0,0,0)
			{
				"……もはや王都は"
				"我々の支援なしでは立ち行くまい。\p"
				"お前は行ってくれ、ダーナ。"
				"くれぐれも連中#4R ・ ・#Rに見つかるなよ？"	//（連中を・で強調）"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	"DANA"
			TalkPopup("LEADER",0,3,350,236,0)		//一人称ダーナ：右
			{
				"#000e#000mうん、大丈夫。\p"
				"オルガちゃん……"
				"色々ありがとうね。"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	オルガ祭司長
			TalkPopup("this",0,0,0,0,0)
			{
				"#011e#081m……フッ、何を今更。\p"
				"私はお前についていくと決めたのだぞ。"
				"この程度の苦労は想定内だ。\p"
				"#012e#031e#220mさあ“お転婆巫女”の本領、"
				"さっさと発揮してこい！"
			}
			WaitPrompt()
			WaitCloseWindow()

			//	"DANA"
			TalkPopup("LEADER",0,3,350,236,0)		//一人称ダーナ：右
			{
				"#000e#000mあはは、うん！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( GF_1STTALK_PAST_6_OLGA, 1 )
			CallFunc("system:talkevent_end_ps")		//TALK_END
			SetChrPos("Olga",-537.66f	862.38f	2.75f)
			Turn("Olga",-26.03f,360.0f)
		}
		else
		{
			//　　★ＧＦ以降
			SetStopFlag(STOPFLAG_TALK)
			CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

			LookChr("this","LEADER")

			//	オルガ祭司長
			TalkPopup("this",0,0,0,0,0)
			{
				"王都西側の橋は使えまい。\p"
				"王都西側2行目"
				"王家の谷へは寺院の"
				"山門を抜けて向かうがいい。\p"
				"朗報を待っているぞ。"
				"……行ってこい、ダーナ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【修道女シェンナ】
//──────────────────────────────
function "Talk_Shenna"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：オルガと話している
		//	モーション	：
		//───────────────
		if( !FLAG[TF_SHENNA_TALK] )
		{

			//	修道女シェンナ
			TalkPopup("this",0,0,0,0,0)
			{
				"市民の手当てや保護を"
				"最優先に行っている所です。"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("this","ANI_EV_TEBURI", -1 , 1 )
			PlayVoice(Y8V_5760,"this",100)	//巫女様…（呆れ／不思議そう）

			TalkPopup("this",0,0,0,0,0)
			{
				"巫女様、こちらは心配ありませんよ！\p"
				"このオルガ様の右腕、"
				"優秀なシェンナがついていますから！"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_SHENNA_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	修道女シェンナ
			TalkPopup("this",0,0,0,0,0)
			{
				"悪い知らせばかりですけど……"
				"めげてなんていられません。\p"
				"後輩たちも頑張っていますしね。"
				"後輩4行目"
			}
			WaitPrompt()
			WaitCloseWindow()

			ChangeAnimation("this","ANI_EV_TEBURI", -1 , 1 )

			TalkPopup("this",0,0,0,0,0)
			{
				"どうかこちらはお任せを！"
				"私たちで持ちこたえてみせますから！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【修道女】
//──────────────────────────────
function "Talk_Sister_6_A01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：下の女性と話している
		//	モーション	：膝付き
		//───────────────
		//　　振り返らない
		//	修道女
		TalkPopup("this",0,0,0,0,0)
		{
			"……どうか落ち着いて、"
			"いま治癒の術を試してみますから。\p"
			"（なんてこと……肺が真っ黒……"
			"　……でも応急処置だけでも……）"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Sister_6_A01" , 0 , 20 )
}


//──────────────────────────────
//	【女性】
//──────────────────────────────
function "Talk_Citizen_6_A01"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：修道女と話している
		//	モーション	：跪く
		//───────────────
		//	女性
		TalkPopup("this",0,0,0,0,0)
		{
			"ごほ、ごほ……\p"
			"せきが止まらないんです……"
			"だれか、助けて……"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Citizen_6_A01" , 0 , -20 )

}


//──────────────────────────────
//	【修道女】
//──────────────────────────────
function "Talk_Sister_6_A02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：ジルルと話している
		//	モーション	：膝付き
		//───────────────
		//　　振り向かない

		ChangeAnimation("this","ANI_EV_TEBURI", -1 , 1 )

		//	修道女
		TalkPopup("this",0,0,0,0,0)
		{
			"しっかりなさってください、"
			"ここを動いては駄目ですよ。\p"
			"いま、毛布を取ってきますから……！"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Sister_6_A02" , 0 , -5 )
}


//──────────────────────────────
//	【ジルル老大人】
//──────────────────────────────
function "Talk_Jirul"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：座りこんであらぬ方向を見ている
		//	モーション	：
		//───────────────
		//　　振り向かない
		if( !FLAG[TF_JIRUL_TALK] )
		{
			//	ジルル老大人
			TalkPopup("this",0,0,0,0,0)
			{
				"太陽は……太陽はどこじゃ……！\p"
				"わしの目には、もう……"
				"世界が見えん…………"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_JIRUL_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//　　※カメラ切り替えなし
			//	ジルル老大人
			TalkPopup("this",0,0,0,0,0)
			{
				"ああ、エタニアよ……"
				"永久の王国よ……っ！"
			}
			WaitPrompt()
			WaitCloseWindow()
		}

	}

	ResetStopFlag(STOPFLAG_TALK)
	
	Look("Jirul" , 0 , 30 )
}


//──────────────────────────────
//	【カジュラ】
//──────────────────────────────
function "Talk_Kajura"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	LookChr("this","LEADER")

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・僧院前
		//───────────────
		//	配置・カメラ：一番奥で座りこんでいる
		//	モーション	：座りこむ
		//───────────────
		//	カジュラ
		TalkPopup("this",0,0,0,0,0)
		{
			"お年寄りや体の弱い人から"
			"次々に亡くなっているの……\p"
			"もう大僧院もいっぱいで入れないし……\p"
			"ああ、寒い……寒いよう……"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}



//──────────────────────────────
//	【衛士マトス】
//──────────────────────────────
function "Talk_Matos"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）
		//───────────────
		//	配置・カメラ：民家前の瓦礫に座り込む
		//	モーション	：力なく座り込む
		//───────────────
		if( !FLAG[TF_MATOS_TALK] )
		{
			//	衛士マトス
			TalkPopup("this",0,0,0,0,0)
			{
				"上からの指令はデタラメばかり……\p"
				"王宮は門を閉ざしたまま"
				"我々すら入れない……"
			}
			WaitPrompt()
			WaitCloseWindow()

			//　　首を振る
			HeadNo("this" , 1 , 35)
			Wait(45)

			TalkPopup("this",0,0,0,0,0)
			{
				"もう、何をすればいいのやら……"
			}
			WaitPrompt()
			WaitCloseWindow()

			Wait(10)

			//	衛士マトス
			TalkPopup("this",0,0,0,0,0)
			{
				"……ただ一つ、心配なのは"
				"ラステルの事です。\p"
				"あの子はまだ若い……"
				"立ち直れるだろうか……"
			}
			WaitPrompt()
			WaitCloseWindow()
			SetFlag( TF_MATOS_TALK, 1 )
		}
		else
		{
			//　　★繰り返し
			//	衛士マトス
			TalkPopup("this",0,0,0,0,0)
			{
				"あの子はまだ若い……"
				"それだけに、心配だが……"
			}
			WaitPrompt()
			WaitCloseWindow()
		}
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Matos" , 0 , -30 )
}


//──────────────────────────────
//	【青年】
//──────────────────────────────
function "Talk_Citizen_6_A02"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・中央付近
		//───────────────
		//	配置・カメラ：
		//	モーション	：フリームーブ
		//───────────────
		//	青年
		TalkPopup("this",0,0,0,0,0)
		{
			"冷静になれだの、"
			"異変はすぐ収まるだの……\p"
			"女王の布告なんざクソくらえだ……！\p"
			"どこにそんな根拠がある！？"
			"この状況を見ろってんだ！！"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
}


//──────────────────────────────
//	【男】
//──────────────────────────────
function "Talk_Citizen_6_A03"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：下の男と話す
		//	モーション	：
		//───────────────
		//　　振り向かない
		//	男
		TalkPopup("this",0,0,0,0,0)
		{
			"また南の火山が噴火したってよ……\p"
			"南の火山2行目"
			"国が１つ焼き尽くされて"
			"今も燃えてるそうだ……"
			"地獄そのものだぜ……"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Citizen_6_A03" , 0 , -20 )
}


//──────────────────────────────
//	【男】
//──────────────────────────────
function "Talk_Citizen_6_A04"
{
	SetStopFlag(STOPFLAG_TALK)
	CallFunc("system:talk_begin_zoom")		//TALK_ZOOM

	if( FLAG[GF_PAST_EPISODE_6_GO_GARDEN] )			//▼過去編Ⅵセレンの園へ向かう
	{
		//▼過去編Ⅵセレンの園へ向かう
		//───────────────
		//	場所		：王都西街区（過去）・入り口付近
		//───────────────
		//	配置・カメラ：上の男と話す
		//	モーション	：
		//───────────────
		//　　振り向かない
		//	男
		TalkPopup("this",0,0,0,0,0)
		{
			"まだマシだ……"
			"北じゃ、麦一粒を巡って"
			"殺しあってるらしいからな。\p"
			"列強国すら崩壊したって噂だ……"
			"あるのは絶望だけさ……"
		}
		WaitPrompt()
		WaitCloseWindow()
	}

	ResetStopFlag(STOPFLAG_TALK)
	Look("Citizen_6_A04" , 0 , -20 )
}



////////////////////////////////////////////////////////////////////////////////

//■メインイベントセクション

////////////////////////////////////////////////////////////////////////////////

//──────────────────────────────
//▼【過去編Ⅵ】セレンの園へ向かうことにする(mpmp6202m1)
//──────────────────────────────

function "EV_M06S050"			//セレンの園へ向かうことにする(mpmp6202m1)
{
	//開始処理ここから-----------------------------------------------
	SetStopFlag(STOPFLAG_EVENT)
	FadeOut(FADE_BLACK, 0)
	WaitFade()

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//過去Ⅵ　開始処理呼び出し
	CallFunc("system:BackTo_EPISODE_6")
	SetFlag(GF_PAST_EPISODE_6B_REARRIVE, 0)	//▽過去編ⅥＢ再訪時
	SetFlag(SF_PAST_AGAIN, 0)		//初回はメニューから帰還を禁止

	CallFunc("fxxxm:init")	//ヒモロギ表示用

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	//ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	CallFunc("mp6203m1:init")

	//キャラ初期状態の設定				
	SetChrWork("Olga", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("Olga",-570.68f, 871.11f, 1.43f)
	Turn("Olga",-129.66f,360.0f)
	ChangeAnimation("Olga", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("Olga", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("Olga", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("Olga", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("Olga")
	SetChrInfoFlag("Olga", INFOFLAG_NOCHRATARI)

	SetChrInfoFlag("DANA", INFOFLAG_NOCHRATARI)
	SetChrInfoFlag("DANA", INFOFLAG_NOATARI)	// アタリ無視
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA",-580.63f, 869.63f, 1.25f)
	Turn("DANA",-94.13f,360.0f)
	ChangeAnimation("DANA", "ANI_WAIT", -1, 1)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_WAIT, 1)
	ChangeSubAnimation("DANA", SUBMOT_EXT1, ANI_E_LOOKC, 1)
	LookReset("DANA")

	SetChrPos("ev_merchant",-561.24f, 878.03f, 1.43f)	// 商人風の男
	Turn("ev_merchant",10.25f,360.0f)
	SetChrWork("ev_merchant", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("ev_citizenM",-561.64f, 876.16f, 1.43f)	// 臆病そうな男
	Turn("ev_citizenM",-154.35f,360.0f)
	SetChrWork("ev_citizenM", CWK_DEFAULT_SKIPNODE_OFF, 1)

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

//	// 雪
//	Set3DParticle(PARTICLE_TYPE_SNOW, 0.0f,0.0f,-0.1f, 0.1f,0.0f,0.2f, 0.0f,0.0f,0.0f, 0.0f,0.0f,0.0f, 180.0f, 0.0f)	//initで実行

	//カメラ設定
	MoveCameraAt( 0 , -464.414f , 830.374f , 40.190f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.021f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -12.238f , 0 )	// 基本仰角
	RotateCamera( 0 , 2.537f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。


	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 5.00, 700.000 ,0.000 ,0.450 ,0.500)

	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300, 1.000, 1.000, 0.600, 0.000, 1.000)	//イベント毎に調整

	//スキップ許可
	SetSkipScript("mp6203m1:EV_M06S050_ED")

	//開始処理ここまで-----------------------------------------------

	//　　画面フェードインして、ヒモロギに
	//　　支えられながらも半壊した王宮を見せる。

	// カット1 ----------------------------------------------------------------------------------------

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -464.414f , 830.374f , 26.074f , 125 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.021f , 125 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -9.659f , 125 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 16.004f , 125 )

	// フェードイン
	FadeIn(FADE_BLACK, FADE_NORMAL)
	WaitFade(F)

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	
	Wait(20)	
	// カット2 -----------------------------------------------------------------------------------------

	//　　カメラ切り替えて、王都任意の街区。
	//　　雪がヒラヒラと舞う中を人々が行き交っており、
	//　　彼らの会話が聞こえてくるような演出。

	// クロスフェード
	CrossFade(FADE_NORMAL)

	// カメラ
	MoveCameraAt( 0 , -560.327f , 873.948f , 4.687f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 5.021f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -1.329f , 0 )	// 基本仰角
	RotateCamera( 0 , 262.026f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -560.217f , 875.785f , 3.367f , 90 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 5.021f , 90 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -1.901f , 90 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 260.309f , 90 )

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)
	
	// 臆病そうな男
	TalkPopup("ev_citizenM",0,2,0,0,0) {
		"──何だって！？"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_citizenM", "ANI_EV_TEBURI", -1, 1 )	// 手振り

	// 臆病そうな男
	TalkPopup("ev_citizenM",0,2,0,0,0) {
		"それじゃ、流星を呼び寄せたのは"
		"あのダーナ様だってのか？"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_merchant", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組

	// 商人風の男
	TalkPopup("ev_merchant",0,2,0,0,0) {
		"#011e#000m真相は分からんさ……\p"
		"#012e#000mだが、それを信じたヤツらが"
		"巫女を捕縛しようとしているらしい。\p"
		"凶星を呼び寄せた魔女は許すまじ──"
		"そう触れ回ってるみたいだぜ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_citizenM", "ANI_EV_TEKOSI_S", -1, 1 )	// 手腰当て
	HeadNo("ev_citizenM", 1, 25)	// キャラ, 回数, 速さ

	// 臆病そうな男
	TalkPopup("ev_citizenM",0,2,0,0,0) {
		"全く、どうしてこんなことに……\p"
		"それに王家はいつまで"
		"この状況を放っておくつもりなんだ？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット3 -----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_CROSS)
	
	// カメラ
	MoveCameraAt( 0 , -560.921f , 876.939f , 3.567f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.381f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -0.182f , 0 )	// 基本仰角
	RotateCamera( 0 , 302.425f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
	
	// フェード待ち
	Wait(FADE_CROSS)
	
	ChangeAnimation( "ev_merchant", "ANI_EV_UDEGUMI_E", -1, 1 )	// 腕組
	// 商人風の男
	TalkPopup("ev_merchant",0,2,0,0,0) {
		"あんた、知らないのかい？\p"
		"名君と謳われたサライ女王は"
		"王宮から姿を消しちまったって噂だ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_citizenM", "ANI_EV_TEKOSI_E", -1, 1 )	// 手腰当て

	// 臆病そうな男
	TalkPopup("ev_citizenM",0,1,0,0,0) {
		"そ、それは本当なのか？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// うなずきセット
	HeadYes("ev_merchant" , 1 , 25 )

	// 商人風の男
	TalkPopup("ev_merchant",0,2,0,0,0) {
		"#011e王家が国を棄てて自分たちだけ"
		"逃げ出したって話もあるくらいだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "ev_merchant", "ANI_EV_TEBURI", -1, 1 )	// 手振り

	// 商人風の男
	TalkPopup("ev_merchant",0,2,0,0,0) {
		"#012eもう何も当てにすることはできんさ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	Look("ev_citizenM", 0.0f, -10.0f)	// うつむく

	// 臆病そうな男
	TalkPopup("ev_citizenM",0,1,0,0,0) {
		"何てこった……\p"
		"近頃は治安も悪くなる一方だし、"
		"空は暗雲に閉ざされたまま……"
	}
	WaitPrompt()
	WaitCloseWindow()

	// うなずきセット
	HeadYes("ev_merchant" , 1 , 25 )

	// 商人風の男
	TalkPopup("ev_merchant",0,0,0,0,0) {
		"#011eああ、気温もどんどん下がってるし、"
		"不作で食料も手に入らないときた。\p"
		"#012e#000m栄光のエタニア王国が"
		"一体どうしてこんなことに……"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	Wait(10)

	// カット4 -----------------------------------------------------------------------------------------

	//　　住人たちの会話している場所から
	//　　画面スクロールさせて路地裏を映し出す。
	//　　周囲を警戒しながらダーナを呼び寄せるオルガ。

	// クロスフェード
//	CrossFade(FADE_NORMAL)

	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()
	
	// カメラ
	MoveCameraAt( 0 , -570.455f , 873.539f , 3.331f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.081f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -0.468f , 0 )	// 基本仰角
	RotateCamera( 0 , 278.632f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	ChangeAnimation( "ev_merchant" , "ANI_WAIT", -1 , 1 )
	ChangeAnimation( "ev_citizenM" , "ANI_WAIT", -1 , 1 )

	ExecuteCmd(5, MoveTo, "ev_merchant", -507.84f,879.44f,1.43f, 0.1f, 0.185f)
	ExecuteCmd(6, MoveTo, "ev_citizenM", -508.08f,879.36f,1.43f, 0.1f, 0.175f)

	//SetChrPos("ev_merchant",-507.84f,879.44f,1.43f)
	//Turn("ev_merchant",-92.29f,360.0f)
	//SetChrPos("ev_citizenM",-508.08f,879.36f,1.43f)
	//Turn("ev_citizenM",-154.35f,360.0f)

	Wait(15)
	
	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -571.578f , 871.810f , 3.011f , 85 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.081f , 85)
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 1.251f , 85 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 274.042f , 85 )

	FadeIn(FADE_BLACK,FADE_NORMAL)
	WaitFade()

	Wait(30)
	Look("Olga", -20.0f, 0.0f)	// ←（＾＾）
	Wait(30)
	Look("Olga", 40.0f, 0.0f)	// （＾＾）→
	Wait(30)
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	FadeBGM(70,10)

	LookReset("Olga")
	Turn("Olga", 95.33f, 8.0f)

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#5389V#000e#000m……ダーナ、こっちだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	Wait(10)
	
	// カット5 -----------------------------------------------------------------------------------------

	//　　ダーナがオルガのところまで駆け寄って来る。
	
	// クロスフェード
	CrossFade(FADE_FAST)
	
	StopThread(5)
	StopThread(6)	
	SetChrPos("ev_merchant", -100000.0f, 0.0f, 0.0f)
	SetChrPos("ev_citizenM", -100000.0f, 0.0f, 0.0f)

	// カメラ
	MoveCameraAt( 0 , -571.209f , 871.039f , 2.527f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.941f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 4.423f , 0 )	// 基本仰角
	RotateCamera( 0 , 112.449f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	LookChr("Olga", "DANA")

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -571.209f , 871.039f , 3.067f , 100 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.461f , 100 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 4.710f , 100 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 143.954f , 100 )
	
	// 移動
	//SetMotSpd("DANA" ,-1 , 0.7f )	// モーションスピード変更
	ExecuteCmd(1, MoveTo, "DANA", -572.08f, 870.84f, 1.43f, 0.1f, 0.55f)
	LookChr("DANA", "Olga")
	
	Wait(20)
	
	// ダーナ
	TalkPopup("DANA",0,3,330,80,0) {
		"#3417V#000e#000mオルガちゃん！"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	// 移動待ち
	WaitThread(1)
	
	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	SetMotSpd("DANA" ,-1 , 1.0f )	// モーションスピード戻す

	ChangeAnimation( "Olga", "ANI_EV_TEBURI", -1, 1 )	// 手振り

	// オルガ
	TalkPopup("Olga",0,1,0,0,0) {
		"#000e#000m追手は撒いたようだな？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// うなずきセット
	HeadYes("DANA" , 1 , 25 )

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#011e#000mうん、何とかね。\p"
		"#012e#080m子供の頃、路地裏に"
		"出入りしてたのが役に立ったかな。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	ChangeAnimation( "Olga", "ANI_EV_RYOTEKOSI_S", -1, 1 )	// 両手腰

	// オルガ
	TalkPopup("Olga",0,1,0,0,0) {
		"#000e#000mやれやれ、今となっては"
		"お前の奔放さに感謝だな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA", "ANI_EV_HOHOKAKI", -1, 1 )	// 頬かき
	PlayVoice(Y8V_3004,"DANA",100)	//あはは…（苦笑）

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#101e#080mあはは……"
		"それで調査のほうは？"
	}
	WaitPrompt()
	WaitCloseWindow()

	FadeBGM(100,30)

	// カット6 -----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_CROSS)
	
	// カメラ
	MoveCameraAt( 0 , -571.479f , 870.911f , 2.947f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.701f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -5.890f , 0 )	// 基本仰角
	RotateCamera( 0 , 320.437f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -571.479f , 870.911f , 2.947f , 600 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 1.701f , 600 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , -5.317f , 600 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 301.527f , 600 )

	// フェード待ち
	Wait(FADE_CROSS)

	ChangeAnimation( "Olga", "ANI_EV_RYOTEKOSI_E", -1, 1 )	// 両手腰

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#000e#000m今朝方、文献を解読していた"
		"同志から新たに連絡があってな……\p"
		"予想以上に時間がかかったが"
		"《セレンの園》の場所が判明した。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ダーナに「！」エモーション。
	EmotionEx("DANA", 0.00f, EMO_EX, 0, 5, 1, 1, 0.8f )	// 「！」
	Wait(40)

	// ダーナ
	TalkPopup("DANA",0,1,0,0,0) {
		"#000e#000m《セレンの園》……"
		"ようやく掴めたんだね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// うなずきセット
	HeadYes("Olga" , 1 , 25 )
	ChangeSubAnimation("Olga", SUBMOT_EYE, ANI_E_CLOSE_S, 1)

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#000mああ、神に背いた先住民が"
		"世界の摂理に干渉するため築いた庭園……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Olga", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#012e#000mラクリモサを止める手がかりが"
		"子供が歌う童謡の中にあったとはな。\p"
		"#061e#000m我々はもうそこに希望を託すしか……"
	}
	WaitPrompt()
	WaitCloseWindow()

	// ダーナ
	TalkPopup("DANA",0,1,0,0,0) {
		"#000e#000mそれで庭園は一体どこに？"
	}
	WaitPrompt()
	WaitCloseWindow()

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#062e#000mお前が予想した通りだ。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	ChangeAnimation( "Olga", "ANI_EV_UDEGUMI_E", -1, 1 )	// 腕組
	
	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"永年に渡って禁域とされてきた地──"
		"#052e#000mそう、《王家の谷》だ。\p"
		"王家には《セレンの園》の存在が"
		"どうやら口伝で伝わっていたらしい。\p"
		"あの地を必要以上に警備していたのも"
		"そのせいかもしれんな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット7 -----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_CROSS)

	// カメラ停止
	StopThread(1000)
	StopThread(1001)
	StopThread(1002)
	StopThread(1003)

	// カメラ
	MoveCameraAt( 0 , -571.237f , 870.930f , 2.867f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.181f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 11.873f , 0 )	// 基本仰角
	RotateCamera( 0 , 57.444f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// フェード待ち
	Wait(FADE_CROSS)

	ChangeAnimation( "DANA", "ANI_EV_TEMUNE_S", -1, 1 )	// 手胸当て

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#000e#000mやっぱり……"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Olga", "ANI_EV_TEBURI", -1, 1 )	// 手振り

	// オルガ
	TalkPopup("Olga",0,1,0,0,0) {
		"#000e#000mサライは王族だけに当然"
		"このことを知っていたはずだ。\p"
		"姿を消しただけでなく、"
		"これほど重要なことをなぜ……"
	}
	WaitPrompt()
	WaitCloseWindow()

	LookReset("DANA")
	Wait(10)
	HeadNo("DANA", 1, 25)	// キャラ, 回数, 速さ

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#061e#000m……わからないよ。"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	ChangeAnimation( "DANA", "ANI_EV_TEMUNE_E", -1, 1 )	// 手胸当て
	LookChr("DANA", "Olga")
	
	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#062e#000mそれよりも今はとにかく"
		"《セレンの園》へ急ごう。"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("Olga", 1, 25)	// キャラ, うなずき回数, 速さ

	// オルガ
	TalkPopup("Olga",0,1,0,0,0) {
		"#000e#000mあ、ああ、そうだな。\p"
		"その《セレンの園》なんだが、"
		"墓所の最奥にあるとのことだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組
	LookRoll("DANA", 10.0f)	// かしげる

	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"#000e#000m墓所の最奥？"
		"壁画のあった場所かな……"
	}
	WaitPrompt()
	WaitCloseWindow()
	
	LookRoll("DANA", 0.0f)	// かしげる戻す
	
	// ダーナ
	TalkPopup("DANA",0,2,0,0,0) {
		"でも、アドルさんの時代に"
		"それらしきものはなかったけど……"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("Olga", 1, 25)	// キャラ, うなずき回数, 速さ

	// オルガ
	TalkPopup("Olga",0,1,0,0,0) {
		"#000e#000mああ、もしかすると何らかの"
		"原因で消失するのかもしれんな。\p"
		"とにかく、この時代においては"
		"きちんと残っているはずだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "DANA", "ANI_EV_UDEGUMI_E", -1, 1 )	// 腕組

	// ダーナ
	TalkPopup("DANA",0,0,0,0,0) {
		"#011e#000mとにかく残された時間が"
		"どれくらいなのかも分からない。\p"
		"#012e#000m前回は衛士さんたちに止められたけど、"
		"今度こそ墓所へ向かうね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	// カット8 -----------------------------------------------------------------------------------------

	// クロスフェード
	CrossFade(FADE_FAST)
	
	// カメラ
	MoveCameraAt( 0 , -571.493f , 871.049f , 2.867f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 2.181f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -5.852f , 0 )	// 基本仰角
	RotateCamera( 0 , 243.070f , 0 )				// 角度
	ChangeCameraPers( 0 , 40.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。
	
	// フェード待ち
	Wait(FADE_FAST)

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#011e#000m皮肉なことだが、王家の権威が"
		"失墜した今なら侵入しやすいだろう。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Olga", "ANI_EV_UDEGUMI_S", -1, 1 )	// 腕組

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#012e#000mただ、少し前に暴動があって"
		"王都西側の橋が落ちてしまった。\p"
		"王家の谷へは寺院の山門前から"
		"向かう他に道はないそうだ。"
	}
	WaitPrompt()
	WaitCloseWindow()

	HeadYes("DANA", 1, 25)	// キャラ, うなずき回数, 速さ

	// ダーナ
	TalkPopup("DANA",0,1,0,0,0) {
		"#000e#000mわかった、それじゃあ"
		"寺院のほうはよろしくね。"
	}
	WaitPrompt()
	WaitCloseWindow()

	ChangeAnimation( "Olga", "ANI_EV_UDEGUMI_E", -1, 1 )	// 腕組

	// オルガ
	TalkPopup("Olga",0,2,0,0,0) {
		"#000e#000mああ、気をつけてな。"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　ここでダーナ操作許可。
	//　　※山門までの道のりと王家の墓所の途中ルートはカット？
	//　　　マップが正式確定したところでシナリオ改訂予定。


	FadeOut(FADE_BLACK, FADE_NORMAL)
	WaitFade()


	//終了処理ここから----------------------------------------------------
	CallFunc("mp6203m1:EV_M06S050_ED")
}

function "EV_M06S050_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_DANA")
	CallFunc("system:reset_chrmot_Olga")

	SetChrPos("Olga", -100000.0f, 0.0f, 0.0f)
	SetChrPos("ev_merchant", -100000.0f, 0.0f, 0.0f)
	SetChrPos("ev_citizenM", -100000.0f, 0.0f, 0.0f)

	ResetChrInfoFlag("DANA", INFOFLAG_NOATARI)	// アタリ無視

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//エフェクトの停止
	StopEffect(-1,ALL,1)

	//マップパラメーターリセット
	ResetMapParam(-1)

	//フラグ処理
	SetFlag(GF_06MP6202M_GOTO_GARDEN, 1)
	SetFlag( SF_WARP_DISABLED, 1 )		//ワープ禁止
	SetFlag(SF_SETRAMSAVE,1)		//リトライセーブ
	//SetDiaryCharaFlag( DRCHA_HUDDLA, DRCHA_FLAG_OPEN, 1 )	//★人物メモ：合流時に登録（ヒドゥラ）
	//SetDiaryCharaFlag( DRCHA_MINOS, DRCHA_FLAG_OPEN, 1 )	//★人物メモ：合流時に登録（ミノス）
	//SetDiaryCharaFlag( DRCHA_NESTOLE, DRCHA_FLAG_OPEN, 1 )	//★人物メモ：合流時に登録（ネストール）

	// 人物メモを切り替える・ウーラ（１）
	//SetDiaryCharaFlag( DRCHA_URRA, DRCHA_FLAG_OPEN, 1 )		//★人物メモ：合流時に登録（ウーラ）
	//SetDiaryCharaFlag( DRCHA_URRA2, DRCHA_FLAG_OPEN, 0 )	//★人物メモ：合流時に登録（ウーラ）

	CallFunc("mp6203m1:init")

	//マップマーカー
	SetMapMarker( SMI_DANA_SYMBOL ,PAGE_MP6350m, MARKER_EV_M06S061, 907.60f, 0.02f, -97.07f, 907.60f, 0.02f,MARKER_EV_M06S061,MN_D_MP6350m,0)		//メイン：過去Ⅵ　セレンの園に到着する２

	//イベント後の再配置
	SetChrPos("LEADER",-569.33f, 872.50f, 1.43f)
	Turn("LEADER",-112.02f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	MoveCameraAt( 0 , -569.330f , 872.503f , 3.299f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 7.000f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 14.000f , 0 )	// 基本仰角
	RotateCamera( 0 , -68.024f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	CallFunc("system:camera_reset")

	VisualName("visual/portrait/ep_0160.itp",VN_NAMEMAP2,-1,-1,VN_MAPNAME_TIME)//過去Ⅵ

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK, FADE_FAST)
	//WaitFade()

	//終了処理ここまで----------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////

//■サブイベントセクション

////////////////////////////////////////////////////////////////////////////////
//──────────────────────────────
//	【サブイベント：西街区→中央区にいけない】
//──────────────────────────────
function "SubEV_Past_06_West"
{

//開始処理ここから----------------------------------------------------

	CallFunc("system:event_begin")

	//イベント開始前情報の保存
	SaveEventState()
	SaveCamera()

	//パーティ状態のリセット
	CallFunc("system:party_reset")

	//環境の初期化・不要なものを隠す
	ClearDebris()
	//ResetChrPos((CHRTYPE_MONS | REMOVE_POS))
	ResetChrPos((CHRTYPE_NPC | REMOVE_POS))

	//キャラ初期状態の設定
	SetChrWork("DANA", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("DANA",-445.58f,866.22f,1.68f)
	Turn("DANA",-140.93f,360.0f)
	ChangeAnimation( "DANA" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("DANA",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_MOUTH,ANI_M_WAIT,1)
	ChangeSubAnimation("DANA",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookReset( "DANA" )
	SetChrInfoFlag( "DANA" , INFOFLAG_NOCHRATARI)

	//BGM設定◆
	//PlayBGM( BGM_FIELD_101 , XX )

	//カメラ設定
	MoveCameraAt( 0 , -445.420f , 866.668f , 3.241f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 0.827f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 7.546f , 0 )	// 基本仰角
	RotateCamera( 0 , 183.472f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	// 被写界深度の設定
	SetDoF(0, LERP_LINEAR, 4.000, 300.000 ,1.000 ,0.700 ,0.500)
	// グレアの設定
	SetGlare(0, LERP_LINEAR, 0.700, 1.300 ,1.000 ,1.000 ,0.600 ,0.000 ,1.000)

	//スキップ許可
	SetSkipScript("mp6203m1:SubEV_Past_06_West_ED")

//開始処理ここまで-----------------------------------------------

	FadeIn(FADE_BLACK,FADE_FAST)
	WaitFade()

	//　　ダーナが階段を上がろうとしてはっとする。
	EmotionEx("DANA", 0.00f, EMO_PA, 0, 5, 1, 1, 1.0f )	// 「PA」
	Look("DANA", 0 , 10)
	ChangeSubAnimation("DANA", SUBMOT_EYE, ANI_E_SUP_S, 1)	// 目
	ChangeSubAnimation("DANA", SUBMOT_MOUTH, ANI_M_OPEN_S, 1)	// 口
	Wait(35)

	//　　カメラスクロールすると、駆けてきた男たちの足元が映る状態に。
	CrossFade(FADE_NORMAL)
	
	MoveCameraAt( 0 , -437.664f , 879.066f , 10.310f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 4.227f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , 16.101f , 0 )	// 基本仰角
	RotateCamera( 0 , 4.050f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	SetChrWork("man1", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("man1",-435.90f, 880.46f, 11.08f)
	Turn("man1",-106.74f,360.0f)
	ChangeAnimation( "man1" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("man1",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("man1",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("man1",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr( "man1", "man2" )
	SetChrInfoFlag( "man1" , INFOFLAG_NOCHRATARI)

	SetChrWork("man2", CWK_DEFAULT_SKIPNODE_OFF, 1)
	SetChrPos("man2",-434.19f, 880.85f, 11.08f)
	Turn("man2",74.74f,360.0f)
	ChangeAnimation( "man2" , "ANI_WAIT", -1 , 1 )
	ChangeSubAnimation("man2",SUBMOT_EYE,ANI_E_WAIT,1)
	ChangeSubAnimation("man2",SUBMOT_MOUTH,ANI_M_WAIT,1)
//	ChangeSubAnimation("man2",SUBMOT_EXT1,ANI_E_LOOKC,1)
	LookChr( "man2", "man1" )
	SetChrInfoFlag( "man2" , INFOFLAG_NOCHRATARI)

	// カメラ移動
	ExecuteCmd(1000, MoveCameraAt, INTERPOLATE_SPHERE , -435.765f , 881.125f , 11.130f , 55 )
	ExecuteCmd(1001, ChangeCameraDistance, INTERPOLATE_SPHERE , 4.228f , 55 )
	ExecuteCmd(1002, ChangeCameraElevation, INTERPOLATE_SPHERE , 10.944f , 55 )
	ExecuteCmd(1003, RotateCamera, INTERPOLATE_SPHERE , 357.174f , 55 )

	// カメラ待ち
	WaitThread(1000)
	WaitThread(1001)
	WaitThread(1002)
	WaitThread(1003)

	//	声
	SetName("声")
	TalkPopup("man1",0,0,0,0,0)
	{
		"#000e#000mオイ、巫女は見つかったか！？"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")

	//	声
	SetName("声")
	TalkPopup("man2",0,0,0,0,0)
	{
		"#000e#000mいや、いない……"
		"この辺りだと思ったんだが……\p"
		"クソッ、魔女め……！"
		"絶対に引きずり出してやる……！"
	}
	WaitPrompt()
	WaitCloseWindow()
	SetName("")
	
	Wait(10)

	//　　少し物陰に身を寄せて・・・エモーションを出している
	//　　ダーナにカメラを戻す。
	CrossFade(FADE_CROSS)
	
	MoveCameraAt( 0 , -444.772f , 860.657f , 2.816f , 0 )	// 注視点
	ChangeCameraDistance( 0 , 1.681f , 0 )		// 基本距離
	ChangeCameraElevation( 0 , -10.058f , 0 )	// 基本仰角
	RotateCamera( 0 , 315.471f , 0 )				// 角度
	ChangeCameraPers( 0 , 60.000f , 0 )			// 視野角
	SetCameraZPlane( 0.500f , 20000.000f )			// ZPlane
	RollCamera( 0 , 0.0f , 0 )				// ロール回転
	// ResetCameraZPlane()	// イベント終了時に呼び出して下さい。マップ側の設定に戻します。

	SetChrPos("DANA",-444.15f,860.11f,1.43f)
	Turn("DANA",-160.25f,360.0f)
	Look("DANA", -10.0f, 20.0f)	// （＾＾）↑→
	
	Wait(FADE_CROSS)
	
	Wait(10)

	EmotionEx("DANA", 0.00f, EMO_3DOT, 0, 5, 1, 1, 1.0f)	//…
	Wait(52)

	TalkPopup("DANA",0,1,360,180,0)
	{
		"#000e#000m（……仕方ない、時間は惜しいけど"
		"　別の道を探そう。）"
	}
	WaitPrompt()
	WaitCloseWindow()

	//　　イベント終了、操作許可。
	FadeOut(FADE_BLACK,FADE_NORMAL)
	WaitFade()

//終了処理ここから----------------------------------------------------
	CallFunc("mp6203m1:SubEV_Past_06_West_ED")
}
function "SubEV_Past_06_West_ED"
{
	//終了処理はスキップ禁止
	SetSkipScript("")

	//イベント前のキャラ情報を復帰
	RestoreEventState()

	//隠したものを復帰。
//	ResetChrPos((CHRTYPE_MONS | RESET_POS | RESET_AISTATE))

	//キャラモーション初期化
	CallFunc("system:reset_chrmot_ALL")

	//パーティキャラを解放
	ReleaseEventPartyChr()

	//マップパラメーターリセット
	ResetMapParam(-1)

	//フラグ立て
	SetFlag( GF_SUBEV_PAST_06_WEST, 1 )		// 過去編Ⅵ：【サブイベント：西街区→中央区にいけない】を見た
	SetChrPos("man1", -100000.00f, 0.00f, 0.00f)	// イベント用の男を画面外に移動
	SetChrPos("man2", -100000.00f, 0.00f, 0.00f)	// イベント用の男を画面外に移動
	//マーカー設置
	SetMapMarker( SMI_DANA_SYMBOL, PAGE_MF002, MARKER_SUBEV_PAST06_1,	-357.77f,905.15f,0.00f, 	-357.77f,905.15f,	MARKER_SUBEV_PAST06_1, MN_F_MP6202M,	0)	// 過去編Ⅵ：「【サブイベント：東街区でダリオス執政官と会う】」の場所用

	CallFunc("mp6203m1:init")
	EventAreaEnable( "Stopper_Past_06_01" , 1 )		// 過去編Ⅵ：【ストッパー：西街区→中央区へ行けない】イベントエリア

	//イベント後の再配置
	SetChrPos("LEADER",-444.75f,858.82f,1.43f)
	Turn("LEADER",36.80f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	//カメラ位置復帰
	//MoveCameraAt( 0 , 0.0f , 0.0f , 0.0f , 0 )	// 注視点
	//ChangeCameraDistance( 0 , 0.0f , 0 )		// 基本距離
	//ChangeCameraElevation( 0 , 0.0f , 0 )		// 基本仰角
	//RotateCamera( 0 , 0.0f , 0 )				// 角度
	//ChangeCameraPers( 0 , 0.0f , 0 )			// 視野角
	//SetCameraZPlane( 0 , 0.0f )					// ZPlane
	//RollCamera( 0 , 0.0f , 0 )					// ロール回転

	RestoreCamera(0, 0)		//※上記カメラ位置を指定する場合は不要
	CallFunc("system:camera_reset")

	ResetStopFlag(STOPFLAG_EVENT)

	FadeIn(FADE_BLACK,FADE_FAST)
	//WaitFade()

//終了処理ここまで----------------------------------------------------
}

////////////////////////////////////////////////////////////////////////////////

//■ストッパー・ＬＰセクション

////////////////////////////////////////////////////////////////////////////////
//──────────────────────────────
//	【ストッパー：西街区→中央区へ行けない】
//──────────────────────────────
function "Stopper_Past_06_01"
{

	//　　サブイベント後、もう一度接触するとストッパー。

//開始処理ここから----------------------------------------------------
	SetStopFlag(STOPFLAG_SIMPLEEVENT2)
	ResetStopFlag(STOPFLAG_NOCHARACLIP)
	SaveCamera()

	ResetMotion( "PARTYALL" , 0 )
	StopEffect(-1,PARTYALL,1)
	StopEmotion( "PARTYALL" )
	ResetMoveVec("PARTYALL")
//開始処理ここまで-----------------------------------------------

	//▼過去編Ⅵセレンの園へ向かう
	TalkPopup("LEADER",0,0,0,0,0)
	{
		"#000e#000m（この道は危険だね……）\p"
		"（時間は惜しいけど……"
		"　別の道を探そう。）2"
	}
	WaitPrompt()
	WaitCloseWindow()

//終了処理ここから----------------------------------------------------
	CrossFade(FADE_CROSS)
	SetStopFlag(STOPFLAG_NOCHARACLIP)

	//イベント後の再配置
	SetChrPos("LEADER",-446.58f,864.69f,1.43f)
	Turn("LEADER",36.80f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	RestoreCamera(0,0)
	ResetCameraObserver(0)
	ResetCameraZPlane()
	Wait(FADE_CROSS)

	ResetStopFlag(STOPFLAG_SIMPLEEVENT2)
//終了処理ここまで----------------------------------------------------
}

function "Stopper_Past_06_11"
{

	//　　サブイベント後、もう一度接触するとストッパー。

//開始処理ここから----------------------------------------------------
	SetStopFlag(STOPFLAG_SIMPLEEVENT2)
	ResetStopFlag(STOPFLAG_NOCHARACLIP)
	SaveCamera()

	ResetMotion( "PARTYALL" , 0 )
	StopEffect(-1,PARTYALL,1)
	StopEmotion( "PARTYALL" )
	ResetMoveVec("PARTYALL")
//開始処理ここまで-----------------------------------------------

	//▼過去編Ⅵセレンの園へ向かう
	//　　西街区民家の手前でストッパー
	TalkPopup("LEADER",0,0,0,0,0)
	{
		"#000e#000m今はお邪魔している時間はないかな。"
		"……先を急がないと。"
	}
	WaitPrompt()
	WaitCloseWindow()

//終了処理ここから----------------------------------------------------
	CrossFade(FADE_CROSS)
	SetStopFlag(STOPFLAG_NOCHARACLIP)

	//イベント後の再配置
	SetChrPos("LEADER",-574.48f,848.54f,4.31f)
	Turn("LEADER",-145.69f,360.0f)
	ResetPartyPos()
	ResetFollowPoint()
	//Wait(1) //処理待ち用

	RestoreCamera(0,0)
	ResetCameraObserver(0)
	ResetCameraZPlane()
	Wait(FADE_CROSS)

	ResetStopFlag(STOPFLAG_SIMPLEEVENT2)
//終了処理ここまで----------------------------------------------------
}

